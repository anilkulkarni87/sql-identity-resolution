[0m18:03:59.157727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106314590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106a7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106a7890>]}


============================== 18:03:59.161324 | 91e36703-3ebd-4e92-8c24-329bc7c9969c ==============================
[0m18:03:59.161324 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:03:59.161721 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'partial_parse': 'True', 'fail_fast': 'False', 'write_json': 'True', 'empty': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '.', 'invocation_command': 'dbt deps --profiles-dir .'}
[0m18:03:59.233897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91e36703-3ebd-4e92-8c24-329bc7c9969c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065bd810>]}
[0m18:03:59.245651 [debug] [MainThread]: Set downloads directory='/var/folders/pt/f4g5v3rd52xd_n4yxjprb57h0000gn/T/dbt-downloads-t6idzjoh'
[0m18:03:59.250390 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:03:59.797029 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:03:59.798609 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:03:59.836778 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:03:59.848485 [info ] [MainThread]: Updating lock file in file path: /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/package-lock.yml
[0m18:03:59.850383 [debug] [MainThread]: Set downloads directory='/var/folders/pt/f4g5v3rd52xd_n4yxjprb57h0000gn/T/dbt-downloads-ky1e2csl'
[0m18:03:59.852804 [info ] [MainThread]: Installing ../
[0m18:03:59.853659 [debug] [MainThread]: Creating symlink to local dependency.
[0m18:03:59.853920 [info ] [MainThread]: Installed from <local @ ../>
[0m18:03:59.854195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '91e36703-3ebd-4e92-8c24-329bc7c9969c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110546250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110546ad0>]}
[0m18:03:59.854474 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:04:00.137850 [info ] [MainThread]: Installed from version 1.3.3
[0m18:04:00.138134 [info ] [MainThread]: Up to date!
[0m18:04:00.138362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '91e36703-3ebd-4e92-8c24-329bc7c9969c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110863450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110527f20>]}
[0m18:04:00.277675 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.1836797, "process_in_blocks": "0", "process_kernel_time": 0.177434, "process_mem_max_rss": "117702656", "process_out_blocks": "0", "process_user_time": 0.967402}
[0m18:04:00.278170 [debug] [MainThread]: Command `dbt deps` succeeded at 18:04:00.278037 after 1.18 seconds
[0m18:04:00.278553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11051fe70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110867a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110738ae0>]}
[0m18:04:00.278825 [debug] [MainThread]: Flushing usage events
[0m18:04:00.764384 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:01.963483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108108590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aba7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aba7890>]}


============================== 18:04:01.966189 | 5aaf882f-c0f4-43dd-af9c-975bc5331706 ==============================
[0m18:04:01.966189 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:04:01.966561 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'indirect_selection': 'eager', 'quiet': 'False', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'version_check': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'profiles_dir': '.', 'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt seed --profiles-dir .', 'static_parser': 'True'}
[0m18:04:02.164379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b1810>]}
[0m18:04:02.201331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa47790>]}
[0m18:04:02.203011 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:04:02.397554 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:04:02.398142 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:04:02.398427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac6b650>]}
[0m18:04:03.521374 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'stg_identifiers'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_sources'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:04:03.521745 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'stg_identifiers'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_identifier_mappings'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:04:03.521964 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'stg_identifiers'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_rules'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:04:03.522181 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'stg_identifiers'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_exclusions'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:04:03.522403 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'golden_profiles'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_sources'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:04:03.522591 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'golden_profiles'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_attribute_mappings'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:04:03.522771 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'golden_profiles'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_survivorship_rules'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:04:03.523087 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idr.not_null_dry_run_results_run_id.afbecc5a64' (models/marts/_marts.yml) depends on a node named 'dry_run_results' which is disabled
[0m18:04:03.523261 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idr.not_null_dry_run_results_entity_key.209a057647' (models/marts/_marts.yml) depends on a node named 'dry_run_results' which is disabled
[0m18:04:03.523423 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idr.not_null_dry_run_results_change_type.149dcf5aad' (models/marts/_marts.yml) depends on a node named 'dry_run_results' which is disabled
[0m18:04:03.523586 [debug] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idr.not_null_dry_run_summary_run_id.871bd7c28c' (models/marts/_marts.yml) depends on a node named 'dry_run_summary' which is disabled
[0m18:04:03.593740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9daa80>]}
[0m18:04:03.667202 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:04:03.668524 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:04:03.681470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dca7930>]}
[0m18:04:03.681814 [info ] [MainThread]: Found 35 data tests, 15 seeds, 11 models, 6 sources, 591 macros
[0m18:04:03.682031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd79090>]}
[0m18:04:03.683872 [info ] [MainThread]: 
[0m18:04:03.684141 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:04:03.684325 [info ] [MainThread]: 
[0m18:04:03.684608 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:04:03.687929 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:04:03.695111 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:04:03.719419 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:04:03.719708 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:04:03.719934 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:04:03.720144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:03.720341 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:04:03.720593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:03.734504 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m18:04:03.734979 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m18:04:03.735776 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:04:03.736469 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:04:03.736959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_meta)
[0m18:04:03.737194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main)
[0m18:04:03.737446 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_meta"
"
[0m18:04:03.737688 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main"
"
[0m18:04:03.741640 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:04:03.742994 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:04:03.743215 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_meta"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:04:03.743433 [debug] [ThreadPool]: On create_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:04:03.743614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:03.743780 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:03.744555 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:03.744733 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:03.745465 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:04:03.745637 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: BEGIN
[0m18:04:03.746292 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:04:03.746524 [debug] [ThreadPool]: On create_test_idr_main: BEGIN
[0m18:04:03.746737 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:03.746910 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:04:03.747072 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:03.747242 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_meta"} */

    
    
        create schema if not exists "test_idr"."main_idr_meta"
    
[0m18:04:03.747412 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:04:03.747628 [debug] [ThreadPool]: On create_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main"} */

    
    
        create schema if not exists "test_idr"."main"
    
[0m18:04:03.747892 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:03.748411 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: COMMIT
[0m18:04:03.748593 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:04:03.748758 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:03.748918 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: COMMIT
[0m18:04:03.749382 [debug] [ThreadPool]: On create_test_idr_main: COMMIT
[0m18:04:03.749600 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:04:03.749775 [debug] [ThreadPool]: On create_test_idr_main: COMMIT
[0m18:04:03.749987 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:03.750162 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: Close
[0m18:04:03.750442 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:03.750617 [debug] [ThreadPool]: On create_test_idr_main: Close
[0m18:04:03.752080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_meta, now list_test_idr_main_idr_staging)
[0m18:04:03.755121 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:04:03.755313 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: BEGIN
[0m18:04:03.755529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main, now list_test_idr_main)
[0m18:04:03.755791 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_out'
[0m18:04:03.755959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:03.756218 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_work'
[0m18:04:03.757402 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:04:03.758372 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:04:03.759419 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:04:03.759594 [debug] [ThreadPool]: On list_test_idr_main: BEGIN
[0m18:04:03.759770 [debug] [ThreadPool]: On list_test_idr_main_idr_out: BEGIN
[0m18:04:03.759940 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:04:03.760097 [debug] [ThreadPool]: On list_test_idr_main_idr_work: BEGIN
[0m18:04:03.760267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:03.760427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:03.760592 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:04:03.760744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:03.761096 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:03.761296 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_staging"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_staging'
    and lower(table_catalog) = 'test_idr'
  
[0m18:04:03.761478 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:03.761677 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:04:03.761917 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:03.762101 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:04:03.762289 [debug] [ThreadPool]: On list_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'test_idr'
  
[0m18:04:03.762475 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:04:03.762664 [debug] [ThreadPool]: On list_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_out"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_out'
    and lower(table_catalog) = 'test_idr'
  
[0m18:04:03.762929 [debug] [ThreadPool]: On list_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_work"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_work'
    and lower(table_catalog) = 'test_idr'
  
[0m18:04:03.771906 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:04:03.772214 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:04:03.772454 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:04:03.772654 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:04:03.775340 [debug] [ThreadPool]: On list_test_idr_main_idr_out: ROLLBACK
[0m18:04:03.776008 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: ROLLBACK
[0m18:04:03.776712 [debug] [ThreadPool]: On list_test_idr_main: ROLLBACK
[0m18:04:03.777317 [debug] [ThreadPool]: On list_test_idr_main_idr_work: ROLLBACK
[0m18:04:03.778221 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_work'
[0m18:04:03.778418 [debug] [ThreadPool]: On list_test_idr_main_idr_work: Close
[0m18:04:03.778701 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_staging'
[0m18:04:03.778974 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main'
[0m18:04:03.779260 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_out'
[0m18:04:03.779542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_work, now list_test_idr_main_idr_meta)
[0m18:04:03.779724 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: Close
[0m18:04:03.779892 [debug] [ThreadPool]: On list_test_idr_main: Close
[0m18:04:03.780069 [debug] [ThreadPool]: On list_test_idr_main_idr_out: Close
[0m18:04:03.781109 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:04:03.781497 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: BEGIN
[0m18:04:03.781677 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:03.782007 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:03.782171 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:04:03.782342 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_meta"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_meta'
    and lower(table_catalog) = 'test_idr'
  
[0m18:04:03.784229 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:04:03.784902 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: ROLLBACK
[0m18:04:03.785194 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_meta'
[0m18:04:03.785358 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: Close
[0m18:04:03.785722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd45250>]}
[0m18:04:03.786002 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:03.786179 [debug] [MainThread]: On master: BEGIN
[0m18:04:03.786339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:03.786650 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:03.786824 [debug] [MainThread]: On master: COMMIT
[0m18:04:03.786991 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:03.787154 [debug] [MainThread]: On master: COMMIT
[0m18:04:03.787401 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:03.787567 [debug] [MainThread]: On master: Close
[0m18:04:03.789149 [debug] [Thread-1 (]: Began running node seed.dbt_idr.idr_attribute_mappings
[0m18:04:03.789385 [debug] [Thread-3 (]: Began running node seed.dbt_idr.idr_identifier_mappings
[0m18:04:03.789587 [debug] [Thread-4 (]: Began running node seed.dbt_idr.idr_rules
[0m18:04:03.789783 [debug] [Thread-2 (]: Began running node seed.dbt_idr.idr_exclusions
[0m18:04:03.790063 [info ] [Thread-1 (]: 1 of 15 START seed file main_idr_meta.idr_attribute_mappings ................... [RUN]
[0m18:04:03.790363 [info ] [Thread-3 (]: 3 of 15 START seed file main_idr_meta.idr_identifier_mappings .................. [RUN]
[0m18:04:03.790640 [info ] [Thread-4 (]: 4 of 15 START seed file main_idr_meta.idr_rules ................................ [RUN]
[0m18:04:03.790911 [info ] [Thread-2 (]: 2 of 15 START seed file main_idr_meta.idr_exclusions ........................... [RUN]
[0m18:04:03.791158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_staging, now seed.dbt_idr.idr_attribute_mappings)
[0m18:04:03.791389 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_out, now seed.dbt_idr.idr_identifier_mappings)
[0m18:04:03.791595 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_meta, now seed.dbt_idr.idr_rules)
[0m18:04:03.791804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_idr_main, now seed.dbt_idr.idr_exclusions)
[0m18:04:03.792012 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr.idr_attribute_mappings
[0m18:04:03.792214 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr.idr_identifier_mappings
[0m18:04:03.792399 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr.idr_rules
[0m18:04:03.792588 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr.idr_exclusions
[0m18:04:03.792786 [debug] [Thread-1 (]: Began executing node seed.dbt_idr.idr_attribute_mappings
[0m18:04:03.792981 [debug] [Thread-3 (]: Began executing node seed.dbt_idr.idr_identifier_mappings
[0m18:04:03.793170 [debug] [Thread-4 (]: Began executing node seed.dbt_idr.idr_rules
[0m18:04:03.793366 [debug] [Thread-2 (]: Began executing node seed.dbt_idr.idr_exclusions
[0m18:04:03.812634 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:04:03.813416 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:04:03.814253 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:04:03.815883 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: BEGIN
[0m18:04:03.816166 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: BEGIN
[0m18:04:03.816781 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:04:03.817001 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: BEGIN
[0m18:04:03.817210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:03.817431 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:03.817628 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: BEGIN
[0m18:04:03.817816 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:03.818230 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:03.818554 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.818768 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:03.819000 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.819239 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.819428 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:04:03.819617 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:04:03.819801 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:04:03.820006 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:04:03.820235 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_identifier_mappings"} */

    create table "test_idr"."main_idr_meta"."idr_identifier_mappings" ("source_id" text,"identifier_type" text,"column_name" text,"is_hashed" boolean,"description" text)
  
[0m18:04:03.820449 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_attribute_mappings"} */

    create table "test_idr"."main_idr_meta"."idr_attribute_mappings" ("source_id" text,"attribute_name" text,"column_expr" text,"description" text)
  
[0m18:04:03.820657 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_rules"} */

    create table "test_idr"."main_idr_meta"."idr_rules" ("rule_id" text,"identifier_type" text,"priority" integer,"is_active" boolean,"canonicalize" text,"max_group_size" integer,"description" text)
  
[0m18:04:03.820863 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_exclusions"} */

    create table "test_idr"."main_idr_meta"."idr_exclusions" ("identifier_type" text,"identifier_value_pattern" text,"match_type" text,"reason" text)
  
[0m18:04:03.821752 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:04:03.828609 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m18:04:03.835160 [debug] [Thread-3 (]: SQL status: OK in 0.014 seconds
[0m18:04:03.835942 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:04:03.836227 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:04:03.835018 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:04:03.836535 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m18:04:03.836737 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: 
          COPY "test_idr"."main_idr_meta"."idr_identifier_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_identifier_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.836940 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: 
          COPY "test_idr"."main_idr_meta"."idr_exclusions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_exclusions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.837157 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: 
          COPY "test_idr"."main_idr_meta"."idr_attribute_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_attribute_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.837827 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:04:03.838259 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: 
          COPY "test_idr"."main_idr_meta"."idr_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.845866 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m18:04:03.846145 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m18:04:03.846395 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:04:03.846627 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m18:04:03.850090 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr.idr_rules"
[0m18:04:03.850521 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr.idr_exclusions"
[0m18:04:03.850955 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr.idr_attribute_mappings"
[0m18:04:03.851352 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr.idr_identifier_mappings"
[0m18:04:03.860061 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: COMMIT
[0m18:04:03.860302 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:04:03.861347 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: COMMIT
[0m18:04:03.862262 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: COMMIT
[0m18:04:03.863147 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: COMMIT
[0m18:04:03.863377 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: COMMIT
[0m18:04:03.863635 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:04:03.863853 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:04:03.864060 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:04:03.864376 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: COMMIT
[0m18:04:03.864620 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: COMMIT
[0m18:04:03.864906 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: COMMIT
[0m18:04:03.865504 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.866595 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: Close
[0m18:04:03.866834 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:03.867731 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:04:03.868157 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: Close
[0m18:04:03.868369 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:04:03.868780 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: Close
[0m18:04:03.869296 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: Close
[0m18:04:03.869737 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd6a4c0>]}
[0m18:04:03.869938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e09cb90>]}
[0m18:04:03.870173 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e605640>]}
[0m18:04:03.870357 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108255650>]}
[0m18:04:03.870611 [info ] [Thread-4 (]: 4 of 15 OK loaded seed file main_idr_meta.idr_rules ............................ [[32mINSERT 4[0m in 0.08s]
[0m18:04:03.870911 [info ] [Thread-1 (]: 1 of 15 OK loaded seed file main_idr_meta.idr_attribute_mappings ............... [[32mINSERT 10[0m in 0.08s]
[0m18:04:03.871136 [info ] [Thread-2 (]: 2 of 15 OK loaded seed file main_idr_meta.idr_exclusions ....................... [[32mINSERT 5[0m in 0.08s]
[0m18:04:03.871744 [debug] [Thread-4 (]: Finished running node seed.dbt_idr.idr_rules
[0m18:04:03.871492 [info ] [Thread-3 (]: 3 of 15 OK loaded seed file main_idr_meta.idr_identifier_mappings .............. [[32mINSERT 5[0m in 0.08s]
[0m18:04:03.872088 [debug] [Thread-1 (]: Finished running node seed.dbt_idr.idr_attribute_mappings
[0m18:04:03.872361 [debug] [Thread-2 (]: Finished running node seed.dbt_idr.idr_exclusions
[0m18:04:03.872608 [debug] [Thread-4 (]: Began running node seed.dbt_idr.idr_sources
[0m18:04:03.872932 [debug] [Thread-3 (]: Finished running node seed.dbt_idr.idr_identifier_mappings
[0m18:04:03.873157 [debug] [Thread-1 (]: Began running node seed.dbt_idr.idr_survivorship_rules
[0m18:04:03.873392 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:04:03.873863 [debug] [Thread-3 (]: Began running node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:04:03.873686 [info ] [Thread-4 (]: 5 of 15 START seed file main_idr_meta.idr_sources .............................. [RUN]
[0m18:04:03.874184 [info ] [Thread-1 (]: 6 of 15 START seed file main_idr_meta.idr_survivorship_rules ................... [RUN]
[0m18:04:03.874466 [info ] [Thread-2 (]: 7 of 15 START seed file main.idr_attribute_mappings ............................ [RUN]
[0m18:04:03.874732 [info ] [Thread-3 (]: 8 of 15 START seed file main.idr_exclusions .................................... [RUN]
[0m18:04:03.874984 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_rules, now seed.dbt_idr.idr_sources)
[0m18:04:03.875205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_attribute_mappings, now seed.dbt_idr.idr_survivorship_rules)
[0m18:04:03.875410 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_exclusions, now seed.dbt_idr_integration_tests.idr_attribute_mappings)
[0m18:04:03.875613 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_identifier_mappings, now seed.dbt_idr_integration_tests.idr_exclusions)
[0m18:04:03.875815 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr.idr_sources
[0m18:04:03.876007 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr.idr_survivorship_rules
[0m18:04:03.876219 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:04:03.876467 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:04:03.876712 [debug] [Thread-4 (]: Began executing node seed.dbt_idr.idr_sources
[0m18:04:03.876934 [debug] [Thread-1 (]: Began executing node seed.dbt_idr.idr_survivorship_rules
[0m18:04:03.877165 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:04:03.877456 [debug] [Thread-3 (]: Began executing node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:04:03.884151 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:04:03.884420 [debug] [Thread-4 (]: On seed.dbt_idr.idr_sources: BEGIN
[0m18:04:03.884621 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:03.885240 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:04:03.885444 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: BEGIN
[0m18:04:03.885632 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:03.886345 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:04:03.886550 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: BEGIN
[0m18:04:03.886735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:03.887532 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:04:03.887737 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:04:03.887933 [debug] [Thread-4 (]: On seed.dbt_idr.idr_sources: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_sources"} */

    create table "test_idr"."main_idr_meta"."idr_sources" ("source_id" text,"source_name" text,"database" text,"schema" text,"table_name" text,"entity_key_column" text,"watermark_column" text,"is_active" boolean,"description" text)
  
[0m18:04:03.888228 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:04:03.888437 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:04:03.888633 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_attribute_mappings"} */

    create table "test_idr"."main"."idr_attribute_mappings" ("source_id" text,"attribute_name" text,"column_expr" text,"description" text)
  
[0m18:04:03.889965 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:04:03.890170 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_exclusions: BEGIN
[0m18:04:03.890356 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:03.890644 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:04:03.891366 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:04:03.891582 [debug] [Thread-4 (]: On seed.dbt_idr.idr_sources: 
          COPY "test_idr"."main_idr_meta"."idr_sources" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_sources.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.891886 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:04:03.892580 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:04:03.892787 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: 
          COPY "test_idr"."main"."idr_attribute_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_attribute_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.892991 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:04:03.893196 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:04:03.893471 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:04:03.893674 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:04:03.893881 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_exclusions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_exclusions"} */

    create table "test_idr"."main"."idr_exclusions" ("identifier_type" text,"identifier_value_pattern" text,"match_type" text,"reason" text)
  
[0m18:04:03.894106 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_survivorship_rules"} */

    create table "test_idr"."main_idr_meta"."idr_survivorship_rules" ("attribute_name" text,"strategy" text,"source_priority_list" text,"recency_field" text,"description" text)
  
[0m18:04:03.894396 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:04:03.894973 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr.idr_sources"
[0m18:04:03.895309 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:04:03.895688 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:04:03.895939 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:04:03.896713 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:04:03.896934 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_exclusions: 
          COPY "test_idr"."main"."idr_exclusions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_exclusions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.897270 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:04:03.898011 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:04:03.898274 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: 
          COPY "test_idr"."main_idr_meta"."idr_survivorship_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_survivorship_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.899449 [debug] [Thread-4 (]: On seed.dbt_idr.idr_sources: COMMIT
[0m18:04:03.899918 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:04:03.900127 [debug] [Thread-4 (]: On seed.dbt_idr.idr_sources: COMMIT
[0m18:04:03.900434 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:04:03.900835 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:04:03.901090 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:04:03.901513 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr.idr_survivorship_rules"
[0m18:04:03.901816 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.902811 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: COMMIT
[0m18:04:03.903243 [debug] [Thread-4 (]: On seed.dbt_idr.idr_sources: Close
[0m18:04:03.904227 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: COMMIT
[0m18:04:03.904441 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:04:03.904765 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1e8470>]}
[0m18:04:03.905013 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:04:03.905260 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: COMMIT
[0m18:04:03.906299 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_exclusions: COMMIT
[0m18:04:03.906545 [info ] [Thread-4 (]: 5 of 15 OK loaded seed file main_idr_meta.idr_sources .......................... [[32mINSERT 3[0m in 0.03s]
[0m18:04:03.906780 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: COMMIT
[0m18:04:03.907051 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:04:03.907358 [debug] [Thread-4 (]: Finished running node seed.dbt_idr.idr_sources
[0m18:04:03.907569 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.907807 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_exclusions: COMMIT
[0m18:04:03.908038 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:04:03.908246 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:03.908646 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: Close
[0m18:04:03.909326 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: Close
[0m18:04:03.908969 [info ] [Thread-4 (]: 9 of 15 START seed file main.idr_identifier_mappings ........................... [RUN]
[0m18:04:03.909628 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.909896 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd07e90>]}
[0m18:04:03.910145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1eb050>]}
[0m18:04:03.910365 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_sources, now seed.dbt_idr_integration_tests.idr_identifier_mappings)
[0m18:04:03.910721 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_exclusions: Close
[0m18:04:03.911000 [info ] [Thread-2 (]: 7 of 15 OK loaded seed file main.idr_attribute_mappings ........................ [[32mINSERT 10[0m in 0.03s]
[0m18:04:03.911449 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:04:03.911285 [info ] [Thread-1 (]: 6 of 15 OK loaded seed file main_idr_meta.idr_survivorship_rules ............... [[32mINSERT 5[0m in 0.03s]
[0m18:04:03.911877 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd045f0>]}
[0m18:04:03.912184 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:04:03.912410 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:04:03.912747 [debug] [Thread-1 (]: Finished running node seed.dbt_idr.idr_survivorship_rules
[0m18:04:03.913097 [info ] [Thread-3 (]: 8 of 15 OK loaded seed file main.idr_exclusions ................................ [[32mINSERT 2[0m in 0.04s]
[0m18:04:03.913382 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.idr_rules
[0m18:04:03.915213 [debug] [Thread-1 (]: Began running node seed.dbt_idr_integration_tests.idr_sources
[0m18:04:03.915578 [debug] [Thread-3 (]: Finished running node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:04:03.916600 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:04:03.916031 [info ] [Thread-2 (]: 10 of 15 START seed file main.idr_rules ........................................ [RUN]
[0m18:04:03.916881 [info ] [Thread-1 (]: 11 of 15 START seed file main.idr_sources ...................................... [RUN]
[0m18:04:03.917198 [debug] [Thread-3 (]: Began running node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:04:03.917452 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: BEGIN
[0m18:04:03.917751 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_attribute_mappings, now seed.dbt_idr_integration_tests.idr_rules)
[0m18:04:03.918069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_survivorship_rules, now seed.dbt_idr_integration_tests.idr_sources)
[0m18:04:03.918381 [info ] [Thread-3 (]: 12 of 15 START seed file main.idr_survivorship_rules ........................... [RUN]
[0m18:04:03.918673 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:03.918917 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.idr_rules
[0m18:04:03.919149 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr_integration_tests.idr_sources
[0m18:04:03.919397 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_exclusions, now seed.dbt_idr_integration_tests.idr_survivorship_rules)
[0m18:04:03.919737 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.idr_rules
[0m18:04:03.919945 [debug] [Thread-1 (]: Began executing node seed.dbt_idr_integration_tests.idr_sources
[0m18:04:03.920159 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.920345 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:04:03.923523 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:04:03.924333 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:04:03.925179 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:04:03.925424 [debug] [Thread-3 (]: Began executing node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:04:03.925647 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_identifier_mappings"} */

    create table "test_idr"."main"."idr_identifier_mappings" ("source_id" text,"identifier_type" text,"column_name" text,"is_hashed" boolean,"description" text)
  
[0m18:04:03.925853 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: BEGIN
[0m18:04:03.926041 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: BEGIN
[0m18:04:03.928304 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:04:03.928684 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:03.928953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:03.929208 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: BEGIN
[0m18:04:03.929533 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.929857 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:03.930103 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.930874 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:04:03.931065 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:03.931350 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:04:03.931599 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: 
          COPY "test_idr"."main"."idr_identifier_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_identifier_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.931818 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:04:03.931999 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:04:03.932196 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_rules"} */

    create table "test_idr"."main"."idr_rules" ("rule_id" text,"identifier_type" text,"priority" integer,"is_active" boolean,"canonicalize" text,"max_group_size" integer,"description" text)
  
[0m18:04:03.932509 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_sources"} */

    create table "test_idr"."main"."idr_sources" ("source_id" text,"source_name" text,"database" text,"schema" text,"table_name" text,"entity_key_column" text,"watermark_column" text,"is_active" boolean,"description" text)
  
[0m18:04:03.932728 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:04:03.933174 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_survivorship_rules"} */

    create table "test_idr"."main"."idr_survivorship_rules" ("attribute_name" text,"strategy" text,"source_priority_list" integer,"recency_field" text,"description" text)
  
[0m18:04:03.933511 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.934271 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:04:03.934481 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: 
          COPY "test_idr"."main"."idr_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.934788 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.935494 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:04:03.935724 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:04:03.936001 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:04:03.936296 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: 
          COPY "test_idr"."main"."idr_survivorship_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_survivorship_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.936554 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:04:03.936988 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:04:03.937715 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:04:03.938167 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_rules"
[0m18:04:03.938468 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: 
          COPY "test_idr"."main"."idr_sources" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_sources.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.939717 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: COMMIT
[0m18:04:03.939953 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:04:03.940162 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: COMMIT
[0m18:04:03.941161 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: COMMIT
[0m18:04:03.941378 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:04:03.941581 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: COMMIT
[0m18:04:03.941849 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:04:03.942207 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:04:03.942433 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:04:03.942631 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:04:03.942849 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.943210 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_sources"
[0m18:04:03.943648 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: Close
[0m18:04:03.944029 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: Close
[0m18:04:03.945031 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: COMMIT
[0m18:04:03.945363 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e630f50>]}
[0m18:04:03.945629 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:04:03.945883 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1e8d70>]}
[0m18:04:03.946856 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: COMMIT
[0m18:04:03.947089 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: COMMIT
[0m18:04:03.947329 [info ] [Thread-2 (]: 10 of 15 OK loaded seed file main.idr_rules .................................... [[32mINSERT 3[0m in 0.03s]
[0m18:04:03.947849 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:04:03.947676 [info ] [Thread-4 (]: 9 of 15 OK loaded seed file main.idr_identifier_mappings ....................... [[32mINSERT 6[0m in 0.04s]
[0m18:04:03.948269 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.idr_rules
[0m18:04:03.948484 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: COMMIT
[0m18:04:03.948686 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.948952 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:04:03.949176 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:04:03.949617 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: Close
[0m18:04:03.949840 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.sample_orders
[0m18:04:03.950045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.950547 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1ea090>]}
[0m18:04:03.950323 [info ] [Thread-2 (]: 13 of 15 START seed file main.sample_crm_customers ............................. [RUN]
[0m18:04:03.950857 [info ] [Thread-4 (]: 14 of 15 START seed file main.sample_orders .................................... [RUN]
[0m18:04:03.951238 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: Close
[0m18:04:03.951520 [info ] [Thread-3 (]: 12 of 15 OK loaded seed file main.idr_survivorship_rules ....................... [[32mINSERT 4[0m in 0.03s]
[0m18:04:03.951760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_rules, now seed.dbt_idr_integration_tests.sample_crm_customers)
[0m18:04:03.951982 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_identifier_mappings, now seed.dbt_idr_integration_tests.sample_orders)
[0m18:04:03.952230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e630bf0>]}
[0m18:04:03.952501 [debug] [Thread-3 (]: Finished running node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:04:03.952695 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:04:03.952918 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.sample_orders
[0m18:04:03.953263 [info ] [Thread-1 (]: 11 of 15 OK loaded seed file main.idr_sources .................................. [[32mINSERT 3[0m in 0.03s]
[0m18:04:03.953521 [debug] [Thread-3 (]: Began running node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:04:03.953750 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:04:03.953958 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.sample_orders
[0m18:04:03.954223 [debug] [Thread-1 (]: Finished running node seed.dbt_idr_integration_tests.idr_sources
[0m18:04:03.954466 [info ] [Thread-3 (]: 15 of 15 START seed file main.sample_pos_transactions .......................... [RUN]
[0m18:04:03.958823 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:04:03.959486 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:04:03.959775 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_survivorship_rules, now seed.dbt_idr_integration_tests.sample_pos_transactions)
[0m18:04:03.960018 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: BEGIN
[0m18:04:03.960222 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: BEGIN
[0m18:04:03.960446 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:04:03.960648 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:03.960842 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:03.961047 [debug] [Thread-3 (]: Began executing node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:04:03.963104 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:04:03.963341 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:04:03.963549 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_crm_customers"} */

    create table "test_idr"."main"."sample_crm_customers" ("customer_id" integer,"email" text,"phone" integer,"first_name" text,"last_name" text,"loyalty_id" integer,"updated_at" timestamp without time zone)
  
[0m18:04:03.964165 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:04:03.964780 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:04:03.965027 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:04:03.965230 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.965432 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: BEGIN
[0m18:04:03.965631 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_orders"} */

    create table "test_idr"."main"."sample_orders" ("order_id" integer,"customer_email" text,"contact_phone" integer,"order_date" date)
  
[0m18:04:03.966393 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:04:03.966588 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:03.966898 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: 
          COPY "test_idr"."main"."sample_crm_customers" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_crm_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.967308 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:03.967967 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:04:03.968184 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: 
          COPY "test_idr"."main"."sample_orders" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.968476 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:04:03.968675 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:04:03.968958 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_pos_transactions"} */

    create table "test_idr"."main"."sample_pos_transactions" ("transaction_id" integer,"loyalty_card_id" text,"contact_phone" integer,"transaction_date" date)
  
[0m18:04:03.969494 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m18:04:03.970249 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:04:03.970475 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: 
          COPY "test_idr"."main"."sample_pos_transactions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_pos_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:03.972322 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: 
          COPY "test_idr"."main"."sample_crm_customers" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_crm_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m18:04:03.972608 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m18:04:03.972922 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: ROLLBACK
[0m18:04:03.973286 [debug] [Thread-3 (]: DuckDB adapter: Error running SQL: 
          COPY "test_idr"."main"."sample_pos_transactions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_pos_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m18:04:03.973627 [debug] [Thread-4 (]: DuckDB adapter: Error running SQL: 
          COPY "test_idr"."main"."sample_orders" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        
[0m18:04:03.974550 [debug] [Thread-3 (]: DuckDB adapter: Rolling back transaction.
[0m18:04:03.974768 [debug] [Thread-4 (]: DuckDB adapter: Rolling back transaction.
[0m18:04:03.975055 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: ROLLBACK
[0m18:04:03.975337 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: ROLLBACK
[0m18:04:03.982513 [debug] [Thread-3 (]: Failed to rollback 'seed.dbt_idr_integration_tests.sample_pos_transactions'
[0m18:04:03.982740 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: Close
[0m18:04:03.984593 [debug] [Thread-4 (]: Failed to rollback 'seed.dbt_idr_integration_tests.sample_orders'
[0m18:04:03.984835 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: Close
[0m18:04:03.988179 [debug] [Thread-2 (]: Failed to rollback 'seed.dbt_idr_integration_tests.sample_crm_customers'
[0m18:04:03.988407 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: Close
[0m18:04:03.991334 [debug] [Thread-2 (]: Runtime Error in seed sample_crm_customers (seeds/sample_crm_customers.csv)
  Conversion Error: CSV Error on Line: 2
  Original Line: 1,alice@example.com,5551234567,Alice,Smith,,2024-01-01 10:00:00
  Error when converting column "phone". Could not convert string "5551234567" to 'INTEGER'
  
  Column phone is being converted as type INTEGER
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_crm_customers.csv
    delimiter = , (Set By User)
    quote = (empty) (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 0 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 2 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 5 Set type: INTEGER Sniffed type: "NULL"
  
  
[0m18:04:03.994351 [debug] [Thread-4 (]: Runtime Error in seed sample_orders (seeds/sample_orders.csv)
  Conversion Error: CSV Error on Line: 3
  Original Line: 102,bob@example.com,5559876543,2024-01-16
  Error when converting column "contact_phone". Could not convert string "5559876543" to 'INTEGER'
  
  Column contact_phone is being converted as type INTEGER
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_orders.csv
    delimiter = , (Set By User)
    quote = (empty) (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 0 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 2 Set type: INTEGER Sniffed type: BIGINT
  
  
[0m18:04:03.994660 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da361b0>]}
[0m18:04:03.995183 [debug] [Thread-3 (]: Runtime Error in seed sample_pos_transactions (seeds/sample_pos_transactions.csv)
  Conversion Error: CSV Error on Line: 2
  Original Line: 1001,LOYAL001,5551234567,2024-01-25
  Error when converting column "contact_phone". Could not convert string "5551234567" to 'INTEGER'
  
  Column contact_phone is being converted as type INTEGER
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_pos_transactions.csv
    delimiter = , (Set By User)
    quote = (empty) (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 0 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 2 Set type: INTEGER Sniffed type: BIGINT
  
  
[0m18:04:03.995432 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1eac30>]}
[0m18:04:03.995773 [error] [Thread-2 (]: 13 of 15 ERROR loading seed file main.sample_crm_customers ..................... [[31mERROR[0m in 0.04s]
[0m18:04:03.996018 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aaf882f-c0f4-43dd-af9c-975bc5331706', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7414f0>]}
[0m18:04:03.996309 [error] [Thread-4 (]: 14 of 15 ERROR loading seed file main.sample_orders ............................ [[31mERROR[0m in 0.04s]
[0m18:04:03.996645 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:04:03.996925 [error] [Thread-3 (]: 15 of 15 ERROR loading seed file main.sample_pos_transactions .................. [[31mERROR[0m in 0.04s]
[0m18:04:03.997234 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.sample_orders
[0m18:04:03.997588 [debug] [Thread-3 (]: Finished running node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:04:03.997872 [debug] [Thread-7 (]: Marking all children of 'seed.dbt_idr_integration_tests.sample_crm_customers' to be skipped because of status 'error'.  Reason: Runtime Error in seed sample_crm_customers (seeds/sample_crm_customers.csv)
  Conversion Error: CSV Error on Line: 2
  Original Line: 1,alice@example.com,5551234567,Alice,Smith,,2024-01-01 10:00:00
  Error when converting column "phone". Could not convert string "5551234567" to 'INTEGER'
  
  Column phone is being converted as type INTEGER
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_crm_customers.csv
    delimiter = , (Set By User)
    quote = (empty) (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 0 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 2 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 5 Set type: INTEGER Sniffed type: "NULL"
  
  .
[0m18:04:03.998588 [debug] [Thread-7 (]: Marking all children of 'seed.dbt_idr_integration_tests.sample_orders' to be skipped because of status 'error'.  Reason: Runtime Error in seed sample_orders (seeds/sample_orders.csv)
  Conversion Error: CSV Error on Line: 3
  Original Line: 102,bob@example.com,5559876543,2024-01-16
  Error when converting column "contact_phone". Could not convert string "5559876543" to 'INTEGER'
  
  Column contact_phone is being converted as type INTEGER
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_orders.csv
    delimiter = , (Set By User)
    quote = (empty) (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 0 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 2 Set type: INTEGER Sniffed type: BIGINT
  
  .
[0m18:04:03.998911 [debug] [Thread-7 (]: Marking all children of 'seed.dbt_idr_integration_tests.sample_pos_transactions' to be skipped because of status 'error'.  Reason: Runtime Error in seed sample_pos_transactions (seeds/sample_pos_transactions.csv)
  Conversion Error: CSV Error on Line: 2
  Original Line: 1001,LOYAL001,5551234567,2024-01-25
  Error when converting column "contact_phone". Could not convert string "5551234567" to 'INTEGER'
  
  Column contact_phone is being converted as type INTEGER
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_pos_transactions.csv
    delimiter = , (Set By User)
    quote = (empty) (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 0 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 2 Set type: INTEGER Sniffed type: BIGINT
  
  .
[0m18:04:03.999707 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:03.999890 [debug] [MainThread]: On master: BEGIN
[0m18:04:04.000044 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:04.000408 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:04.000586 [debug] [MainThread]: On master: COMMIT
[0m18:04:04.000749 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:04.000905 [debug] [MainThread]: On master: COMMIT
[0m18:04:04.001154 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:04.001312 [debug] [MainThread]: On master: Close
[0m18:04:04.001507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:04.001656 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.idr_sources' was properly closed.
[0m18:04:04.001801 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_crm_customers' was properly closed.
[0m18:04:04.001943 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_pos_transactions' was properly closed.
[0m18:04:04.002088 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_orders' was properly closed.
[0m18:04:04.002300 [info ] [MainThread]: 
[0m18:04:04.002539 [info ] [MainThread]: Finished running 15 seeds in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m18:04:04.004236 [debug] [MainThread]: Command end result
[0m18:04:04.031796 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:04:04.033143 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:04:04.036801 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/run_results.json
[0m18:04:04.037008 [info ] [MainThread]: 
[0m18:04:04.037240 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m18:04:04.037430 [info ] [MainThread]: 
[0m18:04:04.037653 [error] [MainThread]: [31mFailure in seed sample_crm_customers (seeds/sample_crm_customers.csv)[0m
[0m18:04:04.037901 [error] [MainThread]:   Runtime Error in seed sample_crm_customers (seeds/sample_crm_customers.csv)
  Conversion Error: CSV Error on Line: 2
  Original Line: 1,alice@example.com,5551234567,Alice,Smith,,2024-01-01 10:00:00
  Error when converting column "phone". Could not convert string "5551234567" to 'INTEGER'
  
  Column phone is being converted as type INTEGER
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_crm_customers.csv
    delimiter = , (Set By User)
    quote = (empty) (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 0 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 2 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 5 Set type: INTEGER Sniffed type: "NULL"
  
  
[0m18:04:04.038155 [info ] [MainThread]: 
[0m18:04:04.038384 [error] [MainThread]: [31mFailure in seed sample_orders (seeds/sample_orders.csv)[0m
[0m18:04:04.038629 [error] [MainThread]:   Runtime Error in seed sample_orders (seeds/sample_orders.csv)
  Conversion Error: CSV Error on Line: 3
  Original Line: 102,bob@example.com,5559876543,2024-01-16
  Error when converting column "contact_phone". Could not convert string "5559876543" to 'INTEGER'
  
  Column contact_phone is being converted as type INTEGER
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_orders.csv
    delimiter = , (Set By User)
    quote = (empty) (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 0 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 2 Set type: INTEGER Sniffed type: BIGINT
  
  
[0m18:04:04.038894 [info ] [MainThread]: 
[0m18:04:04.039123 [error] [MainThread]: [31mFailure in seed sample_pos_transactions (seeds/sample_pos_transactions.csv)[0m
[0m18:04:04.039368 [error] [MainThread]:   Runtime Error in seed sample_pos_transactions (seeds/sample_pos_transactions.csv)
  Conversion Error: CSV Error on Line: 2
  Original Line: 1001,LOYAL001,5551234567,2024-01-25
  Error when converting column "contact_phone". Could not convert string "5551234567" to 'INTEGER'
  
  Column contact_phone is being converted as type INTEGER
  This type was either manually set or derived from an existing table. Select a different type to correctly parse this column.
  * Check whether the null string value is set correctly (e.g., nullstr = 'N/A')
  
    file = /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_pos_transactions.csv
    delimiter = , (Set By User)
    quote = (empty) (Auto-Detected)
    escape = (empty) (Auto-Detected)
    new_line = \n (Auto-Detected)
    header = true (Set By User)
    skip_rows = 0 (Auto-Detected)
    comment = (empty) (Auto-Detected)
    strict_mode = true (Auto-Detected)
    date_format =  (Auto-Detected)
    timestamp_format =  (Auto-Detected)
    null_padding = 0
    sample_size = 20480
    ignore_errors = false
    all_varchar = 0
  The Column types set by the user do not match the ones found by the sniffer. 
  Column at position: 0 Set type: INTEGER Sniffed type: BIGINT
  Column at position: 2 Set type: INTEGER Sniffed type: BIGINT
  
  
[0m18:04:04.039601 [info ] [MainThread]: 
[0m18:04:04.039789 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=15
[0m18:04:04.041217 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 2.119327, "process_in_blocks": "0", "process_kernel_time": 0.222106, "process_mem_max_rss": "172572672", "process_out_blocks": "0", "process_user_time": 2.564331}
[0m18:04:04.041465 [debug] [MainThread]: Command `dbt seed` failed at 18:04:04.041422 after 2.12 seconds
[0m18:04:04.041694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aa7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1dbfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd07530>]}
[0m18:04:04.041925 [debug] [MainThread]: Flushing usage events
[0m18:04:04.444665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:56.056087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104310590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a7890>]}


============================== 18:04:56.059952 | 147634ef-6229-4300-bd8c-ac6b85cfb300 ==============================
[0m18:04:56.059952 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:04:56.060374 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'write_json': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'static_parser': 'True', 'invocation_command': 'dbt seed --profiles-dir .', 'target_path': 'None', 'printer_width': '80', 'introspect': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'version_check': 'True', 'quiet': 'False', 'fail_fast': 'False', 'log_format': 'default', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'use_colors': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True'}
[0m18:04:56.237118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c1810>]}
[0m18:04:56.273165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106747790>]}
[0m18:04:56.274912 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:04:56.344749 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:04:56.447891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:04:56.448631 [debug] [MainThread]: Partial parsing: updated file: dbt_idr_integration_tests://seeds/_seeds.yml
[0m18:04:56.657455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102bd250>]}
[0m18:04:56.733412 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:04:56.735181 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:04:56.751373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102d7b60>]}
[0m18:04:56.751693 [info ] [MainThread]: Found 35 data tests, 15 seeds, 11 models, 6 sources, 591 macros
[0m18:04:56.751926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ae6d0>]}
[0m18:04:56.753677 [info ] [MainThread]: 
[0m18:04:56.753890 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:04:56.754071 [info ] [MainThread]: 
[0m18:04:56.754355 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:04:56.757820 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:04:56.758175 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:04:56.793082 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:04:56.793393 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:04:56.793608 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:04:56.793815 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:04:56.794013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:56.794194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:56.806019 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m18:04:56.806352 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m18:04:56.807185 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:04:56.807856 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:04:56.808453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main)
[0m18:04:56.808773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_meta)
[0m18:04:56.809109 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main"
"
[0m18:04:56.809411 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_meta"
"
[0m18:04:56.813416 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:04:56.814724 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:04:56.814923 [debug] [ThreadPool]: On create_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:04:56.815123 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_meta"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:04:56.815312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:56.815478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:56.816374 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:56.816557 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:56.817340 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:04:56.817525 [debug] [ThreadPool]: On create_test_idr_main: BEGIN
[0m18:04:56.818182 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:04:56.818405 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: BEGIN
[0m18:04:56.818615 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:56.818785 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:04:56.818946 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:56.819107 [debug] [ThreadPool]: On create_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main"} */

    
    
        create schema if not exists "test_idr"."main"
    
[0m18:04:56.819269 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:04:56.819487 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_meta"} */

    
    
        create schema if not exists "test_idr"."main_idr_meta"
    
[0m18:04:56.819698 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:56.820200 [debug] [ThreadPool]: On create_test_idr_main: COMMIT
[0m18:04:56.820395 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:04:56.820555 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:56.820711 [debug] [ThreadPool]: On create_test_idr_main: COMMIT
[0m18:04:56.821177 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: COMMIT
[0m18:04:56.821400 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:04:56.821568 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: COMMIT
[0m18:04:56.821731 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:56.821928 [debug] [ThreadPool]: On create_test_idr_main: Close
[0m18:04:56.822271 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:56.822518 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: Close
[0m18:04:56.824024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_meta, now list_test_idr_main_idr_meta)
[0m18:04:56.827230 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:04:56.827436 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: BEGIN
[0m18:04:56.827649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main, now list_test_idr_main_idr_staging)
[0m18:04:56.827905 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_work'
[0m18:04:56.828065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:56.828319 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_out'
[0m18:04:56.829495 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:04:56.830494 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:04:56.831703 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:04:56.831895 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: BEGIN
[0m18:04:56.832074 [debug] [ThreadPool]: On list_test_idr_main_idr_work: BEGIN
[0m18:04:56.832253 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m18:04:56.832432 [debug] [ThreadPool]: On list_test_idr_main_idr_out: BEGIN
[0m18:04:56.832644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:56.832829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:56.833002 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:04:56.833169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:56.833461 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_meta"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_meta'
    and lower(table_catalog) = 'test_idr'
  
[0m18:04:56.833646 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:56.833860 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:56.834095 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:04:56.834278 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:04:56.834480 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:04:56.834666 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:04:56.834857 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_staging"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_staging'
    and lower(table_catalog) = 'test_idr'
  
[0m18:04:56.835058 [debug] [ThreadPool]: On list_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_work"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_work'
    and lower(table_catalog) = 'test_idr'
  
[0m18:04:56.835257 [debug] [ThreadPool]: On list_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_out"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_out'
    and lower(table_catalog) = 'test_idr'
  
[0m18:04:56.842469 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m18:04:56.842739 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m18:04:56.842941 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:04:56.843120 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:04:56.843909 [debug] [ThreadPool]: On list_test_idr_main_idr_work: ROLLBACK
[0m18:04:56.844520 [debug] [ThreadPool]: On list_test_idr_main_idr_out: ROLLBACK
[0m18:04:56.845148 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: ROLLBACK
[0m18:04:56.845865 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: ROLLBACK
[0m18:04:56.846775 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_meta'
[0m18:04:56.846963 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: Close
[0m18:04:56.847285 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_staging'
[0m18:04:56.847493 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: Close
[0m18:04:56.847779 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_work'
[0m18:04:56.848072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_meta, now list_test_idr_main)
[0m18:04:56.848321 [debug] [ThreadPool]: On list_test_idr_main_idr_work: Close
[0m18:04:56.848563 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_out'
[0m18:04:56.849591 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:04:56.849847 [debug] [ThreadPool]: On list_test_idr_main_idr_out: Close
[0m18:04:56.850027 [debug] [ThreadPool]: On list_test_idr_main: BEGIN
[0m18:04:56.850205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:56.850594 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:04:56.850768 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:04:56.850942 [debug] [ThreadPool]: On list_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'test_idr'
  
[0m18:04:56.852688 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:04:56.853367 [debug] [ThreadPool]: On list_test_idr_main: ROLLBACK
[0m18:04:56.853659 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main'
[0m18:04:56.853820 [debug] [ThreadPool]: On list_test_idr_main: Close
[0m18:04:56.854195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109f4e20>]}
[0m18:04:56.854502 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:56.854700 [debug] [MainThread]: On master: BEGIN
[0m18:04:56.854866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:56.855150 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:56.855313 [debug] [MainThread]: On master: COMMIT
[0m18:04:56.855475 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:56.855624 [debug] [MainThread]: On master: COMMIT
[0m18:04:56.855856 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:56.856019 [debug] [MainThread]: On master: Close
[0m18:04:56.857554 [debug] [Thread-1 (]: Began running node seed.dbt_idr.idr_attribute_mappings
[0m18:04:56.857786 [debug] [Thread-3 (]: Began running node seed.dbt_idr.idr_identifier_mappings
[0m18:04:56.857996 [debug] [Thread-4 (]: Began running node seed.dbt_idr.idr_rules
[0m18:04:56.858206 [debug] [Thread-2 (]: Began running node seed.dbt_idr.idr_exclusions
[0m18:04:56.858503 [info ] [Thread-1 (]: 1 of 15 START seed file main_idr_meta.idr_attribute_mappings ................... [RUN]
[0m18:04:56.858752 [info ] [Thread-3 (]: 3 of 15 START seed file main_idr_meta.idr_identifier_mappings .................. [RUN]
[0m18:04:56.859018 [info ] [Thread-4 (]: 4 of 15 START seed file main_idr_meta.idr_rules ................................ [RUN]
[0m18:04:56.859524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_idr_main, now seed.dbt_idr.idr_attribute_mappings)
[0m18:04:56.859280 [info ] [Thread-2 (]: 2 of 15 START seed file main_idr_meta.idr_exclusions ........................... [RUN]
[0m18:04:56.859803 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_work, now seed.dbt_idr.idr_identifier_mappings)
[0m18:04:56.860014 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_out, now seed.dbt_idr.idr_rules)
[0m18:04:56.860220 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr.idr_attribute_mappings
[0m18:04:56.860416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_staging, now seed.dbt_idr.idr_exclusions)
[0m18:04:56.860605 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr.idr_identifier_mappings
[0m18:04:56.860795 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr.idr_rules
[0m18:04:56.860988 [debug] [Thread-1 (]: Began executing node seed.dbt_idr.idr_attribute_mappings
[0m18:04:56.861179 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr.idr_exclusions
[0m18:04:56.861374 [debug] [Thread-3 (]: Began executing node seed.dbt_idr.idr_identifier_mappings
[0m18:04:56.861557 [debug] [Thread-4 (]: Began executing node seed.dbt_idr.idr_rules
[0m18:04:56.871878 [debug] [Thread-2 (]: Began executing node seed.dbt_idr.idr_exclusions
[0m18:04:56.878291 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:04:56.884197 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:04:56.886613 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:04:56.887209 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:04:56.887561 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: BEGIN
[0m18:04:56.887858 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: BEGIN
[0m18:04:56.888104 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: BEGIN
[0m18:04:56.888330 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: BEGIN
[0m18:04:56.888563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:56.888771 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:56.888969 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:56.889156 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:56.889766 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.890019 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.890284 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:04:56.890501 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.890716 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:04:56.890919 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:04:56.891140 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_attribute_mappings"} */

    create table "test_idr"."main_idr_meta"."idr_attribute_mappings" ("source_id" text,"attribute_name" text,"column_expr" text,"description" text)
  
[0m18:04:56.891354 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:04:56.891645 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_rules"} */

    create table "test_idr"."main_idr_meta"."idr_rules" ("rule_id" text,"identifier_type" text,"priority" integer,"is_active" boolean,"canonicalize" text,"max_group_size" integer,"description" text)
  
[0m18:04:56.891922 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:04:56.892197 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_exclusions"} */

    create table "test_idr"."main_idr_meta"."idr_exclusions" ("identifier_type" text,"identifier_value_pattern" text,"match_type" text,"reason" text)
  
[0m18:04:56.892626 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_identifier_mappings"} */

    create table "test_idr"."main_idr_meta"."idr_identifier_mappings" ("source_id" text,"identifier_type" text,"column_name" text,"is_hashed" boolean,"description" text)
  
[0m18:04:56.893015 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:04:56.900323 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m18:04:56.906783 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:04:56.907116 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: 
          COPY "test_idr"."main_idr_meta"."idr_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:56.907458 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:04:56.907710 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: 
          COPY "test_idr"."main_idr_meta"."idr_attribute_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_attribute_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:56.908001 [debug] [Thread-2 (]: SQL status: OK in 0.015 seconds
[0m18:04:56.908252 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m18:04:56.909110 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:04:56.909918 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:04:56.910170 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: 
          COPY "test_idr"."main_idr_meta"."idr_exclusions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_exclusions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:56.910429 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: 
          COPY "test_idr"."main_idr_meta"."idr_identifier_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_identifier_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:56.913115 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:04:56.913363 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m18:04:56.913571 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:04:56.913776 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:04:56.917238 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr.idr_attribute_mappings"
[0m18:04:56.917760 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr.idr_rules"
[0m18:04:56.918217 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr.idr_exclusions"
[0m18:04:56.918613 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr.idr_identifier_mappings"
[0m18:04:56.928180 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: COMMIT
[0m18:04:56.929252 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: COMMIT
[0m18:04:56.930174 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: COMMIT
[0m18:04:56.930422 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:04:56.931445 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: COMMIT
[0m18:04:56.932368 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:04:56.931886 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:04:56.932089 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: COMMIT
[0m18:04:56.931685 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:04:56.932644 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: COMMIT
[0m18:04:56.932869 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: COMMIT
[0m18:04:56.933321 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: COMMIT
[0m18:04:56.933898 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.934975 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: Close
[0m18:04:56.935232 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:56.935484 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:04:56.936536 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:04:56.937012 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: Close
[0m18:04:56.937467 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: Close
[0m18:04:56.937856 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: Close
[0m18:04:56.938235 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11064bdd0>]}
[0m18:04:56.938445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110abc310>]}
[0m18:04:56.938705 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110abc7e0>]}
[0m18:04:56.938951 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109d98b0>]}
[0m18:04:56.939279 [info ] [Thread-3 (]: 3 of 15 OK loaded seed file main_idr_meta.idr_identifier_mappings .............. [[32mINSERT 5[0m in 0.08s]
[0m18:04:56.939510 [info ] [Thread-1 (]: 1 of 15 OK loaded seed file main_idr_meta.idr_attribute_mappings ............... [[32mINSERT 10[0m in 0.08s]
[0m18:04:56.939870 [info ] [Thread-4 (]: 4 of 15 OK loaded seed file main_idr_meta.idr_rules ............................ [[32mINSERT 4[0m in 0.08s]
[0m18:04:56.940408 [debug] [Thread-3 (]: Finished running node seed.dbt_idr.idr_identifier_mappings
[0m18:04:56.940088 [info ] [Thread-2 (]: 2 of 15 OK loaded seed file main_idr_meta.idr_exclusions ....................... [[32mINSERT 5[0m in 0.08s]
[0m18:04:56.940793 [debug] [Thread-1 (]: Finished running node seed.dbt_idr.idr_attribute_mappings
[0m18:04:56.941135 [debug] [Thread-4 (]: Finished running node seed.dbt_idr.idr_rules
[0m18:04:56.941415 [debug] [Thread-3 (]: Began running node seed.dbt_idr.idr_sources
[0m18:04:56.941778 [debug] [Thread-2 (]: Finished running node seed.dbt_idr.idr_exclusions
[0m18:04:56.942048 [debug] [Thread-1 (]: Began running node seed.dbt_idr.idr_survivorship_rules
[0m18:04:56.942316 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:04:56.942909 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:04:56.942662 [info ] [Thread-3 (]: 5 of 15 START seed file main_idr_meta.idr_sources .............................. [RUN]
[0m18:04:56.943306 [info ] [Thread-1 (]: 6 of 15 START seed file main_idr_meta.idr_survivorship_rules ................... [RUN]
[0m18:04:56.943547 [info ] [Thread-4 (]: 7 of 15 START seed file main.idr_attribute_mappings ............................ [RUN]
[0m18:04:56.944127 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_identifier_mappings, now seed.dbt_idr.idr_sources)
[0m18:04:56.943844 [info ] [Thread-2 (]: 8 of 15 START seed file main.idr_exclusions .................................... [RUN]
[0m18:04:56.944491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_attribute_mappings, now seed.dbt_idr.idr_survivorship_rules)
[0m18:04:56.944733 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_rules, now seed.dbt_idr_integration_tests.idr_attribute_mappings)
[0m18:04:56.944955 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr.idr_sources
[0m18:04:56.945165 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_exclusions, now seed.dbt_idr_integration_tests.idr_exclusions)
[0m18:04:56.945385 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr.idr_survivorship_rules
[0m18:04:56.945610 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:04:56.945825 [debug] [Thread-3 (]: Began executing node seed.dbt_idr.idr_sources
[0m18:04:56.946027 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:04:56.946294 [debug] [Thread-1 (]: Began executing node seed.dbt_idr.idr_survivorship_rules
[0m18:04:56.946541 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:04:56.948843 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:04:56.953016 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:04:56.953685 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:04:56.955307 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: BEGIN
[0m18:04:56.956581 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:04:56.956814 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: BEGIN
[0m18:04:56.957491 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:04:56.957700 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:56.957906 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_exclusions: BEGIN
[0m18:04:56.958091 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:56.958283 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: BEGIN
[0m18:04:56.958652 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:56.959110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:56.959360 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.959556 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:04:56.959930 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:04:56.960145 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:04:56.960371 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:04:56.960545 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.960735 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_attribute_mappings"} */

    create table "test_idr"."main"."idr_attribute_mappings" ("source_id" text,"attribute_name" text,"column_expr" text,"description" text)
  
[0m18:04:56.960950 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_sources"} */

    create table "test_idr"."main_idr_meta"."idr_sources" ("source_id" text,"source_name" text,"database" text,"schema" text,"table_name" text,"entity_key_column" text,"watermark_column" text,"is_active" boolean,"description" text)
  
[0m18:04:56.961167 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:04:56.961490 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:04:56.961933 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_exclusions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_exclusions"} */

    create table "test_idr"."main"."idr_exclusions" ("identifier_type" text,"identifier_value_pattern" text,"match_type" text,"reason" text)
  
[0m18:04:56.962165 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_survivorship_rules"} */

    create table "test_idr"."main_idr_meta"."idr_survivorship_rules" ("attribute_name" text,"strategy" text,"source_priority_list" text,"recency_field" text,"description" text)
  
[0m18:04:56.962363 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.962601 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.963568 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:04:56.963828 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.964475 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:04:56.964675 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:56.964885 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: 
          COPY "test_idr"."main"."idr_attribute_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_attribute_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:56.965534 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:04:56.965742 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: 
          COPY "test_idr"."main_idr_meta"."idr_sources" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_sources.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:56.966370 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:04:56.966685 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_exclusions: 
          COPY "test_idr"."main"."idr_exclusions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_exclusions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:56.967053 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: 
          COPY "test_idr"."main_idr_meta"."idr_survivorship_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_survivorship_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:56.967612 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.968008 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:04:56.968521 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.968912 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:04:56.969131 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:04:56.970608 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: COMMIT
[0m18:04:56.970819 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:04:56.971178 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr.idr_sources"
[0m18:04:56.971444 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:04:56.971935 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr.idr_survivorship_rules"
[0m18:04:56.973095 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_exclusions: COMMIT
[0m18:04:56.973339 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: COMMIT
[0m18:04:56.973641 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:04:56.974610 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: COMMIT
[0m18:04:56.975708 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: COMMIT
[0m18:04:56.975909 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_exclusions: COMMIT
[0m18:04:56.976164 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:04:56.976408 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:04:56.976627 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:04:56.976911 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: COMMIT
[0m18:04:56.977387 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: Close
[0m18:04:56.977614 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.977808 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: COMMIT
[0m18:04:56.978347 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_exclusions: Close
[0m18:04:56.978680 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a816a0>]}
[0m18:04:56.978971 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.979225 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a91780>]}
[0m18:04:56.979489 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:56.980123 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: Close
[0m18:04:56.979759 [info ] [Thread-4 (]: 7 of 15 OK loaded seed file main.idr_attribute_mappings ........................ [[32mINSERT 10[0m in 0.03s]
[0m18:04:56.980486 [info ] [Thread-2 (]: 8 of 15 OK loaded seed file main.idr_exclusions ................................ [[32mINSERT 2[0m in 0.03s]
[0m18:04:56.980897 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: Close
[0m18:04:56.981183 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11093d250>]}
[0m18:04:56.981527 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:04:56.981841 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:04:56.982120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a99d90>]}
[0m18:04:56.982602 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:04:56.982406 [info ] [Thread-3 (]: 5 of 15 OK loaded seed file main_idr_meta.idr_sources .......................... [[32mINSERT 3[0m in 0.04s]
[0m18:04:56.982977 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.idr_rules
[0m18:04:56.983329 [info ] [Thread-1 (]: 6 of 15 OK loaded seed file main_idr_meta.idr_survivorship_rules ............... [[32mINSERT 5[0m in 0.04s]
[0m18:04:56.983922 [debug] [Thread-3 (]: Finished running node seed.dbt_idr.idr_sources
[0m18:04:56.983593 [info ] [Thread-4 (]: 9 of 15 START seed file main.idr_identifier_mappings ........................... [RUN]
[0m18:04:56.984238 [info ] [Thread-2 (]: 10 of 15 START seed file main.idr_rules ........................................ [RUN]
[0m18:04:56.984580 [debug] [Thread-1 (]: Finished running node seed.dbt_idr.idr_survivorship_rules
[0m18:04:56.984810 [debug] [Thread-3 (]: Began running node seed.dbt_idr_integration_tests.idr_sources
[0m18:04:56.985078 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_attribute_mappings, now seed.dbt_idr_integration_tests.idr_identifier_mappings)
[0m18:04:56.985313 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_exclusions, now seed.dbt_idr_integration_tests.idr_rules)
[0m18:04:56.985541 [debug] [Thread-1 (]: Began running node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:04:56.986004 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:04:56.985797 [info ] [Thread-3 (]: 11 of 15 START seed file main.idr_sources ...................................... [RUN]
[0m18:04:56.986303 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.idr_rules
[0m18:04:56.986574 [info ] [Thread-1 (]: 12 of 15 START seed file main.idr_survivorship_rules ........................... [RUN]
[0m18:04:56.986816 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:04:56.987045 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_sources, now seed.dbt_idr_integration_tests.idr_sources)
[0m18:04:56.987245 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.idr_rules
[0m18:04:56.987446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_survivorship_rules, now seed.dbt_idr_integration_tests.idr_survivorship_rules)
[0m18:04:56.988689 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr_integration_tests.idr_sources
[0m18:04:56.991048 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:04:56.992101 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:04:56.992635 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:04:56.992938 [debug] [Thread-3 (]: Began executing node seed.dbt_idr_integration_tests.idr_sources
[0m18:04:56.993181 [debug] [Thread-1 (]: Began executing node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:04:56.993440 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: BEGIN
[0m18:04:56.993683 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: BEGIN
[0m18:04:56.997527 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:04:56.998137 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:04:56.998334 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:56.998540 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:56.998732 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: BEGIN
[0m18:04:56.998920 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: BEGIN
[0m18:04:56.999429 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:56.999621 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:56.999879 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.000250 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:04:57.000633 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:04:57.000919 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:04:57.001162 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:04:57.001355 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:57.001547 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_rules"} */

    create table "test_idr"."main"."idr_rules" ("rule_id" text,"identifier_type" text,"priority" integer,"is_active" boolean,"canonicalize" text,"max_group_size" integer,"description" text)
  
[0m18:04:57.001756 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_identifier_mappings"} */

    create table "test_idr"."main"."idr_identifier_mappings" ("source_id" text,"identifier_type" text,"column_name" text,"is_hashed" boolean,"description" text)
  
[0m18:04:57.001955 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:04:57.002139 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:04:57.002534 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_sources"} */

    create table "test_idr"."main"."idr_sources" ("source_id" text,"source_name" text,"database" text,"schema" text,"table_name" text,"entity_key_column" text,"watermark_column" text,"is_active" boolean,"description" text)
  
[0m18:04:57.002769 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:04:57.003052 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_survivorship_rules"} */

    create table "test_idr"."main"."idr_survivorship_rules" ("attribute_name" text,"strategy" text,"source_priority_list" integer,"recency_field" text,"description" text)
  
[0m18:04:57.003342 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.004197 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:04:57.004448 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.005365 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:04:57.005611 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: 
          COPY "test_idr"."main"."idr_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:57.005824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.006571 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:04:57.006783 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: 
          COPY "test_idr"."main"."idr_identifier_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_identifier_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:57.007629 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:04:57.008094 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: 
          COPY "test_idr"."main"."idr_sources" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_sources.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:57.008475 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.008727 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: 
          COPY "test_idr"."main"."idr_survivorship_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_survivorship_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:57.009244 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_rules"
[0m18:04:57.009748 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.010839 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: COMMIT
[0m18:04:57.011252 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:04:57.011505 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:04:57.011754 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:04:57.011985 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:04:57.012242 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: COMMIT
[0m18:04:57.012609 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_sources"
[0m18:04:57.012983 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:04:57.014063 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: COMMIT
[0m18:04:57.014361 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:04:57.014628 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.014857 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: COMMIT
[0m18:04:57.015301 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: Close
[0m18:04:57.016317 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: COMMIT
[0m18:04:57.017411 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: COMMIT
[0m18:04:57.017820 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a863f0>]}
[0m18:04:57.018060 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:04:57.018282 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:04:57.018491 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:04:57.018982 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: COMMIT
[0m18:04:57.018800 [info ] [Thread-2 (]: 10 of 15 OK loaded seed file main.idr_rules .................................... [[32mINSERT 3[0m in 0.03s]
[0m18:04:57.019442 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: Close
[0m18:04:57.019646 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: COMMIT
[0m18:04:57.020014 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.idr_rules
[0m18:04:57.020332 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a994f0>]}
[0m18:04:57.020556 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.020828 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:04:57.021100 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:04:57.021674 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: Close
[0m18:04:57.021333 [info ] [Thread-4 (]: 9 of 15 OK loaded seed file main.idr_identifier_mappings ....................... [[32mINSERT 6[0m in 0.04s]
[0m18:04:57.022382 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: Close
[0m18:04:57.022026 [info ] [Thread-2 (]: 13 of 15 START seed file main.sample_crm_customers ............................. [RUN]
[0m18:04:57.022711 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a86870>]}
[0m18:04:57.023026 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:04:57.023311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a86c90>]}
[0m18:04:57.023601 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_rules, now seed.dbt_idr_integration_tests.sample_crm_customers)
[0m18:04:57.024103 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.sample_orders
[0m18:04:57.023913 [info ] [Thread-3 (]: 11 of 15 OK loaded seed file main.idr_sources .................................. [[32mINSERT 3[0m in 0.04s]
[0m18:04:57.024726 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:04:57.024473 [info ] [Thread-1 (]: 12 of 15 OK loaded seed file main.idr_survivorship_rules ....................... [[32mINSERT 4[0m in 0.04s]
[0m18:04:57.025389 [debug] [Thread-3 (]: Finished running node seed.dbt_idr_integration_tests.idr_sources
[0m18:04:57.025114 [info ] [Thread-4 (]: 14 of 15 START seed file main.sample_orders .................................... [RUN]
[0m18:04:57.025666 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:04:57.025952 [debug] [Thread-1 (]: Finished running node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:04:57.026171 [debug] [Thread-3 (]: Began running node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:04:57.026434 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_identifier_mappings, now seed.dbt_idr_integration_tests.sample_orders)
[0m18:04:57.028576 [info ] [Thread-3 (]: 15 of 15 START seed file main.sample_pos_transactions .......................... [RUN]
[0m18:04:57.028855 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.sample_orders
[0m18:04:57.029518 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:04:57.029746 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_sources, now seed.dbt_idr_integration_tests.sample_pos_transactions)
[0m18:04:57.029960 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.sample_orders
[0m18:04:57.030169 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: BEGIN
[0m18:04:57.030430 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:04:57.032043 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:57.032315 [debug] [Thread-3 (]: Began executing node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:04:57.032924 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:04:57.034998 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:04:57.035614 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:04:57.035820 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: BEGIN
[0m18:04:57.036016 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:04:57.036204 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: BEGIN
[0m18:04:57.036396 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:04:57.036613 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_crm_customers"} */

    create table "test_idr"."main"."sample_crm_customers" ("customer_id" varchar,"email" varchar,"phone" varchar,"first_name" varchar,"last_name" varchar,"loyalty_id" varchar,"updated_at" varchar)
  
[0m18:04:57.036827 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:04:57.037349 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.037566 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:04:57.037772 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_orders"} */

    create table "test_idr"."main"."sample_orders" ("order_id" varchar,"customer_email" varchar,"contact_phone" varchar,"order_date" varchar)
  
[0m18:04:57.038160 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.038399 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.038629 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:04:57.038847 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.039693 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:04:57.039933 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_pos_transactions"} */

    create table "test_idr"."main"."sample_pos_transactions" ("transaction_id" varchar,"loyalty_card_id" varchar,"contact_phone" varchar,"transaction_date" varchar)
  
[0m18:04:57.040600 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:04:57.040805 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: 
          COPY "test_idr"."main"."sample_crm_customers" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_crm_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:57.041158 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: 
          COPY "test_idr"."main"."sample_orders" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:57.041563 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.042483 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:04:57.042700 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: 
          COPY "test_idr"."main"."sample_pos_transactions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_pos_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:04:57.043109 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.043517 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_orders"
[0m18:04:57.043887 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:04:57.044320 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:04:57.044681 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:04:57.045048 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:04:57.046108 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: COMMIT
[0m18:04:57.046352 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:04:57.047335 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: COMMIT
[0m18:04:57.047559 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: COMMIT
[0m18:04:57.047822 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:04:57.048078 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: COMMIT
[0m18:04:57.049063 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: COMMIT
[0m18:04:57.049439 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:04:57.049648 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: COMMIT
[0m18:04:57.049883 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.050192 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:04:57.050626 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: Close
[0m18:04:57.050865 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:04:57.051240 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: Close
[0m18:04:57.051560 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e51490>]}
[0m18:04:57.051936 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: Close
[0m18:04:57.052250 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a879b0>]}
[0m18:04:57.052510 [info ] [Thread-2 (]: 13 of 15 OK loaded seed file main.sample_crm_customers ......................... [[32mINSERT 10[0m in 0.03s]
[0m18:04:57.052817 [info ] [Thread-4 (]: 14 of 15 OK loaded seed file main.sample_orders ................................ [[32mINSERT 10[0m in 0.03s]
[0m18:04:57.053106 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '147634ef-6229-4300-bd8c-ac6b85cfb300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e507d0>]}
[0m18:04:57.053453 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:04:57.053763 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.sample_orders
[0m18:04:57.054068 [info ] [Thread-3 (]: 15 of 15 OK loaded seed file main.sample_pos_transactions ...................... [[32mINSERT 10[0m in 0.02s]
[0m18:04:57.054482 [debug] [Thread-3 (]: Finished running node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:04:57.055197 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:57.055383 [debug] [MainThread]: On master: BEGIN
[0m18:04:57.055557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:57.055909 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:57.056105 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.056266 [debug] [MainThread]: Using duckdb connection "master"
[0m18:04:57.056418 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.056714 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:04:57.056942 [debug] [MainThread]: On master: Close
[0m18:04:57.057173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:57.057337 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.idr_survivorship_rules' was properly closed.
[0m18:04:57.057489 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_crm_customers' was properly closed.
[0m18:04:57.057634 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_pos_transactions' was properly closed.
[0m18:04:57.057778 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_orders' was properly closed.
[0m18:04:57.057965 [info ] [MainThread]: 
[0m18:04:57.058300 [info ] [MainThread]: Finished running 15 seeds in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m18:04:57.059608 [debug] [MainThread]: Command end result
[0m18:04:57.086173 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:04:57.087551 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:04:57.091188 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/run_results.json
[0m18:04:57.091387 [info ] [MainThread]: 
[0m18:04:57.091689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:57.091887 [info ] [MainThread]: 
[0m18:04:57.092074 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m18:04:57.094288 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.0852183, "process_in_blocks": "0", "process_kernel_time": 0.242914, "process_mem_max_rss": "162856960", "process_out_blocks": "0", "process_user_time": 1.728609}
[0m18:04:57.094635 [debug] [MainThread]: Command `dbt seed` succeeded at 18:04:57.094582 after 1.09 seconds
[0m18:04:57.094872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032a82f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107412990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e50e30>]}
[0m18:04:57.095177 [debug] [MainThread]: Flushing usage events
[0m18:04:57.512019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:14.732864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111914590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133a7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133a7890>]}


============================== 18:05:14.736221 | f640acbe-cfd5-47b5-bbc8-041ae820777e ==============================
[0m18:05:14.736221 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:05:14.736614 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'static_parser': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'debug': 'False', 'write_json': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '.', 'cache_selected_only': 'False', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'introspect': 'True', 'empty': 'None', 'log_format': 'default', 'target_path': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'invocation_command': 'dbt deps --profiles-dir .'}
[0m18:05:14.804591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f640acbe-cfd5-47b5-bbc8-041ae820777e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcd810>]}
[0m18:05:14.837412 [debug] [MainThread]: Set downloads directory='/var/folders/pt/f4g5v3rd52xd_n4yxjprb57h0000gn/T/dbt-downloads-_as4jx6k'
[0m18:05:14.837702 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:05:14.885987 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:05:14.887188 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:05:14.925751 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:05:14.929318 [info ] [MainThread]: Installing ../
[0m18:05:14.931838 [debug] [MainThread]: Creating symlink to local dependency.
[0m18:05:14.932173 [info ] [MainThread]: Installed from <local @ ../>
[0m18:05:14.932412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f640acbe-cfd5-47b5-bbc8-041ae820777e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113246e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113246ad0>]}
[0m18:05:14.932644 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:05:15.184335 [info ] [MainThread]: Installed from version 1.3.3
[0m18:05:15.184656 [info ] [MainThread]: Up to date!
[0m18:05:15.184892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f640acbe-cfd5-47b5-bbc8-041ae820777e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113563450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11355fd40>]}
[0m18:05:15.187246 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.49798164, "process_in_blocks": "0", "process_kernel_time": 0.179261, "process_mem_max_rss": "116506624", "process_out_blocks": "0", "process_user_time": 0.911025}
[0m18:05:15.187592 [debug] [MainThread]: Command `dbt deps` succeeded at 18:05:15.187525 after 0.50 seconds
[0m18:05:15.187835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11321fe70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134f1b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135aedd0>]}
[0m18:05:15.188061 [debug] [MainThread]: Flushing usage events
[0m18:05:15.504545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:16.657744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105710590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a7890>]}


============================== 18:05:16.661193 | 88b127f0-c5e1-4bff-bb9c-3780e0e1619c ==============================
[0m18:05:16.661193 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:05:16.661678 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'partial_parse': 'True', 'debug': 'False', 'log_format': 'default', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'invocation_command': 'dbt seed --profiles-dir .', 'no_print': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'static_parser': 'True', 'fail_fast': 'False', 'profiles_dir': '.', 'version_check': 'True', 'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'empty': 'None'}
[0m18:05:16.840898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bd810>]}
[0m18:05:16.877863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106747790>]}
[0m18:05:16.879548 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:05:16.951337 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:05:17.055557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:05:17.055870 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:05:17.056044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:05:17.094882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070dc050>]}
[0m18:05:17.213531 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:05:17.215181 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:05:17.228222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d6a80>]}
[0m18:05:17.228521 [info ] [MainThread]: Found 35 data tests, 15 seeds, 11 models, 6 sources, 591 macros
[0m18:05:17.228732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101693150>]}
[0m18:05:17.230436 [info ] [MainThread]: 
[0m18:05:17.230640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:05:17.230805 [info ] [MainThread]: 
[0m18:05:17.231079 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:05:17.234275 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:05:17.241844 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:05:17.266529 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:05:17.266828 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:05:17.267061 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:05:17.267297 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:05:17.267492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:17.267690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:17.284066 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m18:05:17.284384 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m18:05:17.285428 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:05:17.286260 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:05:17.286867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main)
[0m18:05:17.287147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_meta)
[0m18:05:17.287512 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main"
"
[0m18:05:17.287833 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_meta"
"
[0m18:05:17.291982 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:05:17.293488 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:05:17.293755 [debug] [ThreadPool]: On create_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:05:17.293984 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_meta"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:05:17.294196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:17.294377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:17.295329 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:17.295539 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:17.296356 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:05:17.297081 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:05:17.297274 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: BEGIN
[0m18:05:17.297453 [debug] [ThreadPool]: On create_test_idr_main: BEGIN
[0m18:05:17.297794 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:17.297981 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:17.298145 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:05:17.298328 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:05:17.298507 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_meta"} */

    
    
        create schema if not exists "test_idr"."main_idr_meta"
    
[0m18:05:17.298683 [debug] [ThreadPool]: On create_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main"} */

    
    
        create schema if not exists "test_idr"."main"
    
[0m18:05:17.299321 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:17.299513 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:17.300064 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: COMMIT
[0m18:05:17.300591 [debug] [ThreadPool]: On create_test_idr_main: COMMIT
[0m18:05:17.300791 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:05:17.300982 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:05:17.301165 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: COMMIT
[0m18:05:17.301342 [debug] [ThreadPool]: On create_test_idr_main: COMMIT
[0m18:05:17.301762 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:17.301994 [debug] [ThreadPool]: On create_test_idr_main: Close
[0m18:05:17.302186 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:17.302410 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: Close
[0m18:05:17.304145 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_meta, now list_test_idr_main_idr_meta)
[0m18:05:17.304430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main, now list_test_idr_main_idr_work)
[0m18:05:17.307723 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:05:17.308010 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_staging'
[0m18:05:17.309442 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:05:17.309707 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_out'
[0m18:05:17.309934 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: BEGIN
[0m18:05:17.310999 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:05:17.311219 [debug] [ThreadPool]: On list_test_idr_main_idr_work: BEGIN
[0m18:05:17.312536 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:05:17.312737 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:17.312925 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: BEGIN
[0m18:05:17.313108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:17.313291 [debug] [ThreadPool]: On list_test_idr_main_idr_out: BEGIN
[0m18:05:17.313558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:17.313800 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:17.313973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:17.314155 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:17.314367 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:05:17.314693 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:17.314930 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:05:17.315148 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_meta"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_meta'
    and lower(table_catalog) = 'test_idr'
  
[0m18:05:17.315359 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:17.315562 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:05:17.315790 [debug] [ThreadPool]: On list_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_work"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_work'
    and lower(table_catalog) = 'test_idr'
  
[0m18:05:17.316082 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:05:17.316274 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_staging"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_staging'
    and lower(table_catalog) = 'test_idr'
  
[0m18:05:17.316593 [debug] [ThreadPool]: On list_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_out"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_out'
    and lower(table_catalog) = 'test_idr'
  
[0m18:05:17.326330 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:05:17.326666 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:05:17.326886 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:05:17.327134 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:05:17.327978 [debug] [ThreadPool]: On list_test_idr_main_idr_out: ROLLBACK
[0m18:05:17.328712 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: ROLLBACK
[0m18:05:17.329444 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: ROLLBACK
[0m18:05:17.330129 [debug] [ThreadPool]: On list_test_idr_main_idr_work: ROLLBACK
[0m18:05:17.331083 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_work'
[0m18:05:17.331414 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_out'
[0m18:05:17.331593 [debug] [ThreadPool]: On list_test_idr_main_idr_work: Close
[0m18:05:17.331856 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_staging'
[0m18:05:17.332050 [debug] [ThreadPool]: On list_test_idr_main_idr_out: Close
[0m18:05:17.332372 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_meta'
[0m18:05:17.332740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_work, now list_test_idr_main)
[0m18:05:17.332959 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: Close
[0m18:05:17.333241 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: Close
[0m18:05:17.334405 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:05:17.334804 [debug] [ThreadPool]: On list_test_idr_main: BEGIN
[0m18:05:17.334981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:17.335374 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:17.335546 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:05:17.335777 [debug] [ThreadPool]: On list_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'test_idr'
  
[0m18:05:17.337622 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:05:17.338370 [debug] [ThreadPool]: On list_test_idr_main: ROLLBACK
[0m18:05:17.338705 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main'
[0m18:05:17.338874 [debug] [ThreadPool]: On list_test_idr_main: Close
[0m18:05:17.339276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076560d0>]}
[0m18:05:17.339574 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:17.339752 [debug] [MainThread]: On master: BEGIN
[0m18:05:17.339928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:17.340311 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:17.340544 [debug] [MainThread]: On master: COMMIT
[0m18:05:17.340720 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:17.340884 [debug] [MainThread]: On master: COMMIT
[0m18:05:17.341147 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:17.341316 [debug] [MainThread]: On master: Close
[0m18:05:17.343141 [debug] [Thread-2 (]: Began running node seed.dbt_idr.idr_exclusions
[0m18:05:17.343417 [debug] [Thread-4 (]: Began running node seed.dbt_idr.idr_rules
[0m18:05:17.343643 [debug] [Thread-1 (]: Began running node seed.dbt_idr.idr_attribute_mappings
[0m18:05:17.343846 [debug] [Thread-3 (]: Began running node seed.dbt_idr.idr_identifier_mappings
[0m18:05:17.344160 [info ] [Thread-2 (]: 2 of 15 START seed file main_idr_meta.idr_exclusions ........................... [RUN]
[0m18:05:17.344524 [info ] [Thread-4 (]: 4 of 15 START seed file main_idr_meta.idr_rules ................................ [RUN]
[0m18:05:17.344851 [info ] [Thread-1 (]: 1 of 15 START seed file main_idr_meta.idr_attribute_mappings ................... [RUN]
[0m18:05:17.345387 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_idr_main, now seed.dbt_idr.idr_exclusions)
[0m18:05:17.345094 [info ] [Thread-3 (]: 3 of 15 START seed file main_idr_meta.idr_identifier_mappings .................. [RUN]
[0m18:05:17.345709 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_out, now seed.dbt_idr.idr_rules)
[0m18:05:17.345955 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_meta, now seed.dbt_idr.idr_attribute_mappings)
[0m18:05:17.346194 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr.idr_exclusions
[0m18:05:17.346405 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_staging, now seed.dbt_idr.idr_identifier_mappings)
[0m18:05:17.346604 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr.idr_rules
[0m18:05:17.346805 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr.idr_attribute_mappings
[0m18:05:17.347006 [debug] [Thread-2 (]: Began executing node seed.dbt_idr.idr_exclusions
[0m18:05:17.347203 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr.idr_identifier_mappings
[0m18:05:17.347408 [debug] [Thread-4 (]: Began executing node seed.dbt_idr.idr_rules
[0m18:05:17.347598 [debug] [Thread-1 (]: Began executing node seed.dbt_idr.idr_attribute_mappings
[0m18:05:17.359669 [debug] [Thread-3 (]: Began executing node seed.dbt_idr.idr_identifier_mappings
[0m18:05:17.370282 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:05:17.372499 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:05:17.373155 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:05:17.373992 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:05:17.374274 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: BEGIN
[0m18:05:17.374491 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: BEGIN
[0m18:05:17.374700 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: BEGIN
[0m18:05:17.374907 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: BEGIN
[0m18:05:17.375205 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:05:17.375444 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:05:17.375695 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:05:17.375977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:17.376668 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.376883 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.377204 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:05:17.377447 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.377722 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:05:17.377972 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_exclusions"} */

    create table "test_idr"."main_idr_meta"."idr_exclusions" ("identifier_type" text,"identifier_value_pattern" text,"match_type" text,"reason" text)
  
[0m18:05:17.378193 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.378404 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:05:17.378637 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_rules"} */

    create table "test_idr"."main_idr_meta"."idr_rules" ("rule_id" text,"identifier_type" text,"priority" integer,"is_active" boolean,"canonicalize" text,"max_group_size" integer,"description" text)
  
[0m18:05:17.378947 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:05:17.379161 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_identifier_mappings"} */

    create table "test_idr"."main_idr_meta"."idr_identifier_mappings" ("source_id" text,"identifier_type" text,"column_name" text,"is_hashed" boolean,"description" text)
  
[0m18:05:17.379511 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.379745 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_attribute_mappings"} */

    create table "test_idr"."main_idr_meta"."idr_attribute_mappings" ("source_id" text,"attribute_name" text,"column_expr" text,"description" text)
  
[0m18:05:17.379974 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.387219 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:05:17.387546 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m18:05:17.388438 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:05:17.388703 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: 
          COPY "test_idr"."main_idr_meta"."idr_exclusions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_exclusions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.388940 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.389597 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:05:17.389808 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: 
          COPY "test_idr"."main_idr_meta"."idr_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.390647 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:05:17.390879 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: 
          COPY "test_idr"."main_idr_meta"."idr_identifier_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_identifier_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.391192 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: 
          COPY "test_idr"."main_idr_meta"."idr_attribute_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_attribute_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.399366 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m18:05:17.399696 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m18:05:17.399964 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m18:05:17.403352 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr.idr_rules"
[0m18:05:17.403618 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m18:05:17.404132 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr.idr_identifier_mappings"
[0m18:05:17.404577 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr.idr_exclusions"
[0m18:05:17.405022 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr.idr_attribute_mappings"
[0m18:05:17.415114 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: COMMIT
[0m18:05:17.415399 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:05:17.415898 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: COMMIT
[0m18:05:17.416226 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: COMMIT
[0m18:05:17.417204 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: COMMIT
[0m18:05:17.417457 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:05:17.418536 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: COMMIT
[0m18:05:17.418886 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:05:17.419139 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: COMMIT
[0m18:05:17.419391 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:05:17.419609 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: COMMIT
[0m18:05:17.419827 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.420085 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: COMMIT
[0m18:05:17.420353 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:05:17.421461 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: Close
[0m18:05:17.421716 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.422131 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: Close
[0m18:05:17.422559 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: Close
[0m18:05:17.422769 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.424141 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: Close
[0m18:05:17.424744 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740ef90>]}
[0m18:05:17.424972 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ff490>]}
[0m18:05:17.425258 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107956df0>]}
[0m18:05:17.425468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10585f250>]}
[0m18:05:17.425741 [info ] [Thread-3 (]: 3 of 15 OK loaded seed file main_idr_meta.idr_identifier_mappings .............. [[32mINSERT 5[0m in 0.08s]
[0m18:05:17.425986 [info ] [Thread-2 (]: 2 of 15 OK loaded seed file main_idr_meta.idr_exclusions ....................... [[32mINSERT 5[0m in 0.08s]
[0m18:05:17.426859 [debug] [Thread-3 (]: Finished running node seed.dbt_idr.idr_identifier_mappings
[0m18:05:17.426286 [info ] [Thread-4 (]: 4 of 15 OK loaded seed file main_idr_meta.idr_rules ............................ [[32mINSERT 4[0m in 0.08s]
[0m18:05:17.427235 [debug] [Thread-2 (]: Finished running node seed.dbt_idr.idr_exclusions
[0m18:05:17.426524 [info ] [Thread-1 (]: 1 of 15 OK loaded seed file main_idr_meta.idr_attribute_mappings ............... [[32mINSERT 10[0m in 0.08s]
[0m18:05:17.427535 [debug] [Thread-3 (]: Began running node seed.dbt_idr.idr_sources
[0m18:05:17.427808 [debug] [Thread-4 (]: Finished running node seed.dbt_idr.idr_rules
[0m18:05:17.428098 [debug] [Thread-2 (]: Began running node seed.dbt_idr.idr_survivorship_rules
[0m18:05:17.428431 [debug] [Thread-1 (]: Finished running node seed.dbt_idr.idr_attribute_mappings
[0m18:05:17.428920 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:05:17.428721 [info ] [Thread-3 (]: 5 of 15 START seed file main_idr_meta.idr_sources .............................. [RUN]
[0m18:05:17.429431 [debug] [Thread-1 (]: Began running node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:05:17.429248 [info ] [Thread-2 (]: 6 of 15 START seed file main_idr_meta.idr_survivorship_rules ................... [RUN]
[0m18:05:17.430047 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_identifier_mappings, now seed.dbt_idr.idr_sources)
[0m18:05:17.429802 [info ] [Thread-4 (]: 7 of 15 START seed file main.idr_attribute_mappings ............................ [RUN]
[0m18:05:17.430398 [info ] [Thread-1 (]: 8 of 15 START seed file main.idr_exclusions .................................... [RUN]
[0m18:05:17.430666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_exclusions, now seed.dbt_idr.idr_survivorship_rules)
[0m18:05:17.430881 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr.idr_sources
[0m18:05:17.431099 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_rules, now seed.dbt_idr_integration_tests.idr_attribute_mappings)
[0m18:05:17.431306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_attribute_mappings, now seed.dbt_idr_integration_tests.idr_exclusions)
[0m18:05:17.431513 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr.idr_survivorship_rules
[0m18:05:17.431719 [debug] [Thread-3 (]: Began executing node seed.dbt_idr.idr_sources
[0m18:05:17.431982 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:05:17.432243 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:05:17.432472 [debug] [Thread-2 (]: Began executing node seed.dbt_idr.idr_survivorship_rules
[0m18:05:17.434613 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:05:17.434902 [debug] [Thread-1 (]: Began executing node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:05:17.438756 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:05:17.440366 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: BEGIN
[0m18:05:17.440587 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:05:17.441434 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:05:17.442154 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:05:17.442399 [debug] [Thread-2 (]: On seed.dbt_idr.idr_survivorship_rules: BEGIN
[0m18:05:17.442605 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.443831 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:05:17.444064 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: BEGIN
[0m18:05:17.444338 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:05:17.444602 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:05:17.444895 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: BEGIN
[0m18:05:17.445224 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:05:17.445665 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_sources"} */

    create table "test_idr"."main_idr_meta"."idr_sources" ("source_id" text,"source_name" text,"database" text,"schema" text,"table_name" text,"entity_key_column" text,"watermark_column" text,"is_active" boolean,"description" text)
  
[0m18:05:17.445976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:17.446188 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.446726 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.446994 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:05:17.447227 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.447432 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.447632 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:05:17.447860 [debug] [Thread-2 (]: On seed.dbt_idr.idr_survivorship_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_survivorship_rules"} */

    create table "test_idr"."main_idr_meta"."idr_survivorship_rules" ("attribute_name" text,"strategy" text,"source_priority_list" text,"recency_field" text,"description" text)
  
[0m18:05:17.448068 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:05:17.448838 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:05:17.449091 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_attribute_mappings"} */

    create table "test_idr"."main"."idr_attribute_mappings" ("source_id" text,"attribute_name" text,"column_expr" text,"description" text)
  
[0m18:05:17.449407 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_exclusions"} */

    create table "test_idr"."main"."idr_exclusions" ("identifier_type" text,"identifier_value_pattern" text,"match_type" text,"reason" text)
  
[0m18:05:17.449657 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: 
          COPY "test_idr"."main_idr_meta"."idr_sources" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_sources.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.449878 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.450312 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:05:17.451043 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:05:17.451257 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.451909 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:05:17.452153 [debug] [Thread-2 (]: On seed.dbt_idr.idr_survivorship_rules: 
          COPY "test_idr"."main_idr_meta"."idr_survivorship_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_survivorship_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.452853 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:05:17.453049 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:05:17.453304 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: 
          COPY "test_idr"."main"."idr_attribute_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_attribute_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.453597 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: 
          COPY "test_idr"."main"."idr_exclusions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_exclusions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.453984 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr.idr_sources"
[0m18:05:17.455628 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: COMMIT
[0m18:05:17.455856 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:05:17.456083 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:05:17.456317 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: COMMIT
[0m18:05:17.456529 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.456750 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:05:17.457147 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr.idr_survivorship_rules"
[0m18:05:17.457602 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:05:17.458054 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:05:17.458315 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.458816 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: Close
[0m18:05:17.459194 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10796fa10>]}
[0m18:05:17.459559 [info ] [Thread-3 (]: 5 of 15 OK loaded seed file main_idr_meta.idr_sources .......................... [[32mINSERT 3[0m in 0.03s]
[0m18:05:17.460689 [debug] [Thread-2 (]: On seed.dbt_idr.idr_survivorship_rules: COMMIT
[0m18:05:17.461676 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: COMMIT
[0m18:05:17.462652 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: COMMIT
[0m18:05:17.463000 [debug] [Thread-3 (]: Finished running node seed.dbt_idr.idr_sources
[0m18:05:17.463277 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:05:17.463538 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:05:17.463790 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:05:17.464085 [debug] [Thread-3 (]: Began running node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:05:17.464342 [debug] [Thread-2 (]: On seed.dbt_idr.idr_survivorship_rules: COMMIT
[0m18:05:17.464595 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: COMMIT
[0m18:05:17.464811 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: COMMIT
[0m18:05:17.465115 [info ] [Thread-3 (]: 9 of 15 START seed file main.idr_identifier_mappings ........................... [RUN]
[0m18:05:17.465831 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_sources, now seed.dbt_idr_integration_tests.idr_identifier_mappings)
[0m18:05:17.466096 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:05:17.466345 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.466575 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.466800 [debug] [Thread-3 (]: Began executing node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:05:17.467005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.467468 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: Close
[0m18:05:17.467924 [debug] [Thread-2 (]: On seed.dbt_idr.idr_survivorship_rules: Close
[0m18:05:17.469831 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: Close
[0m18:05:17.470257 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107189130>]}
[0m18:05:17.470515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718b0b0>]}
[0m18:05:17.470762 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d11010>]}
[0m18:05:17.471577 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:05:17.471890 [info ] [Thread-2 (]: 6 of 15 OK loaded seed file main_idr_meta.idr_survivorship_rules ............... [[32mINSERT 5[0m in 0.04s]
[0m18:05:17.472644 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: BEGIN
[0m18:05:17.472124 [info ] [Thread-1 (]: 8 of 15 OK loaded seed file main.idr_exclusions ................................ [[32mINSERT 2[0m in 0.04s]
[0m18:05:17.473030 [debug] [Thread-2 (]: Finished running node seed.dbt_idr.idr_survivorship_rules
[0m18:05:17.472386 [info ] [Thread-4 (]: 7 of 15 OK loaded seed file main.idr_attribute_mappings ........................ [[32mINSERT 10[0m in 0.04s]
[0m18:05:17.473309 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:05:17.473636 [debug] [Thread-1 (]: Finished running node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:05:17.473900 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.idr_rules
[0m18:05:17.474244 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:05:17.474596 [debug] [Thread-1 (]: Began running node seed.dbt_idr_integration_tests.idr_sources
[0m18:05:17.474905 [info ] [Thread-2 (]: 10 of 15 START seed file main.idr_rules ........................................ [RUN]
[0m18:05:17.475263 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.475532 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:05:17.476102 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_survivorship_rules, now seed.dbt_idr_integration_tests.idr_rules)
[0m18:05:17.475872 [info ] [Thread-1 (]: 11 of 15 START seed file main.idr_sources ...................................... [RUN]
[0m18:05:17.476385 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:05:17.476650 [info ] [Thread-4 (]: 12 of 15 START seed file main.idr_survivorship_rules ........................... [RUN]
[0m18:05:17.476887 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.idr_rules
[0m18:05:17.477108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_exclusions, now seed.dbt_idr_integration_tests.idr_sources)
[0m18:05:17.477330 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_identifier_mappings"} */

    create table "test_idr"."main"."idr_identifier_mappings" ("source_id" text,"identifier_type" text,"column_name" text,"is_hashed" boolean,"description" text)
  
[0m18:05:17.477551 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_attribute_mappings, now seed.dbt_idr_integration_tests.idr_survivorship_rules)
[0m18:05:17.477750 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.idr_rules
[0m18:05:17.477944 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr_integration_tests.idr_sources
[0m18:05:17.478274 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:05:17.480356 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.480601 [debug] [Thread-1 (]: Began executing node seed.dbt_idr_integration_tests.idr_sources
[0m18:05:17.481502 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:05:17.481718 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:05:17.482549 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:05:17.483791 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: BEGIN
[0m18:05:17.486278 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: 
          COPY "test_idr"."main"."idr_identifier_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_identifier_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.487183 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:05:17.487990 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:05:17.488254 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:05:17.488629 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: BEGIN
[0m18:05:17.488864 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: BEGIN
[0m18:05:17.489188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:17.489438 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:05:17.489721 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.490005 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.490321 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.490607 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:05:17.490849 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.491265 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:05:17.491490 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:05:17.491703 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_rules"} */

    create table "test_idr"."main"."idr_rules" ("rule_id" text,"identifier_type" text,"priority" integer,"is_active" boolean,"canonicalize" text,"max_group_size" integer,"description" text)
  
[0m18:05:17.491914 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:05:17.492274 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_sources"} */

    create table "test_idr"."main"."idr_sources" ("source_id" text,"source_name" text,"database" text,"schema" text,"table_name" text,"entity_key_column" text,"watermark_column" text,"is_active" boolean,"description" text)
  
[0m18:05:17.492771 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_survivorship_rules"} */

    create table "test_idr"."main"."idr_survivorship_rules" ("attribute_name" text,"strategy" text,"source_priority_list" integer,"recency_field" text,"description" text)
  
[0m18:05:17.494083 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: COMMIT
[0m18:05:17.494314 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:05:17.494515 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: COMMIT
[0m18:05:17.494799 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.495044 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.495285 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.496116 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:05:17.496343 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.497069 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:05:17.497783 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:05:17.498011 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: 
          COPY "test_idr"."main"."idr_survivorship_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_survivorship_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.498455 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: Close
[0m18:05:17.498667 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: 
          COPY "test_idr"."main"."idr_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.498913 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: 
          COPY "test_idr"."main"."idr_sources" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_sources.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.499371 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079653d0>]}
[0m18:05:17.499864 [info ] [Thread-3 (]: 9 of 15 OK loaded seed file main.idr_identifier_mappings ....................... [[32mINSERT 6[0m in 0.03s]
[0m18:05:17.500261 [debug] [Thread-3 (]: Finished running node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:05:17.500513 [debug] [Thread-3 (]: Began running node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:05:17.500838 [info ] [Thread-3 (]: 13 of 15 START seed file main.sample_crm_customers ............................. [RUN]
[0m18:05:17.501113 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_identifier_mappings, now seed.dbt_idr_integration_tests.sample_crm_customers)
[0m18:05:17.501358 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.501620 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:05:17.501893 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.502125 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.502579 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:05:17.502837 [debug] [Thread-3 (]: Began executing node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:05:17.503248 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_rules"
[0m18:05:17.503625 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_sources"
[0m18:05:17.506379 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:05:17.507442 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: COMMIT
[0m18:05:17.508391 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: COMMIT
[0m18:05:17.508621 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: BEGIN
[0m18:05:17.508909 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:05:17.509143 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:05:17.510137 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: COMMIT
[0m18:05:17.510365 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:05:17.510616 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: COMMIT
[0m18:05:17.510859 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: COMMIT
[0m18:05:17.511085 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:05:17.511614 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: COMMIT
[0m18:05:17.511935 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.512170 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.512405 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.512858 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_rules: Close
[0m18:05:17.513077 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.513318 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:05:17.513748 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: Close
[0m18:05:17.514149 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: Close
[0m18:05:17.514453 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107965eb0>]}
[0m18:05:17.514702 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_crm_customers"} */

    create table "test_idr"."main"."sample_crm_customers" ("customer_id" varchar,"email" varchar,"phone" varchar,"first_name" varchar,"last_name" varchar,"loyalty_id" varchar,"updated_at" varchar)
  
[0m18:05:17.515021 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d10fb0>]}
[0m18:05:17.515323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107965e50>]}
[0m18:05:17.515741 [info ] [Thread-2 (]: 10 of 15 OK loaded seed file main.idr_rules .................................... [[32mINSERT 3[0m in 0.04s]
[0m18:05:17.516086 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.516354 [info ] [Thread-4 (]: 12 of 15 OK loaded seed file main.idr_survivorship_rules ....................... [[32mINSERT 4[0m in 0.04s]
[0m18:05:17.516721 [info ] [Thread-1 (]: 11 of 15 OK loaded seed file main.idr_sources .................................. [[32mINSERT 3[0m in 0.04s]
[0m18:05:17.517132 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.idr_rules
[0m18:05:17.517947 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:05:17.518289 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:05:17.518618 [debug] [Thread-1 (]: Finished running node seed.dbt_idr_integration_tests.idr_sources
[0m18:05:17.518855 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.sample_orders
[0m18:05:17.519109 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: 
          COPY "test_idr"."main"."sample_crm_customers" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_crm_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.519339 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:05:17.519668 [info ] [Thread-2 (]: 14 of 15 START seed file main.sample_orders .................................... [RUN]
[0m18:05:17.520044 [info ] [Thread-4 (]: 15 of 15 START seed file main.sample_pos_transactions .......................... [RUN]
[0m18:05:17.520333 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_rules, now seed.dbt_idr_integration_tests.sample_orders)
[0m18:05:17.520627 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_survivorship_rules, now seed.dbt_idr_integration_tests.sample_pos_transactions)
[0m18:05:17.520886 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.sample_orders
[0m18:05:17.521114 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:05:17.521337 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.sample_orders
[0m18:05:17.521630 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:05:17.523544 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m18:05:17.526349 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:05:17.526749 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:05:17.527260 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:05:17.527518 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: BEGIN
[0m18:05:17.527882 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: BEGIN
[0m18:05:17.528121 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:05:17.528369 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:05:17.529657 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: COMMIT
[0m18:05:17.529883 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:05:17.530084 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: COMMIT
[0m18:05:17.530347 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.530564 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:05:17.530772 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:05:17.531016 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_orders"} */

    create table "test_idr"."main"."sample_orders" ("order_id" varchar,"customer_email" varchar,"contact_phone" varchar,"order_date" varchar)
  
[0m18:05:17.531256 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:05:17.531486 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.531765 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_pos_transactions"} */

    create table "test_idr"."main"."sample_pos_transactions" ("transaction_id" varchar,"loyalty_card_id" varchar,"contact_phone" varchar,"transaction_date" varchar)
  
[0m18:05:17.532205 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: Close
[0m18:05:17.532502 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.532844 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079653d0>]}
[0m18:05:17.533115 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.533917 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:05:17.535069 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:05:17.534272 [info ] [Thread-3 (]: 13 of 15 OK loaded seed file main.sample_crm_customers ......................... [[32mINSERT 10[0m in 0.03s]
[0m18:05:17.535409 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: 
          COPY "test_idr"."main"."sample_orders" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.535628 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: 
          COPY "test_idr"."main"."sample_pos_transactions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_pos_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:05:17.535944 [debug] [Thread-3 (]: Finished running node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:05:17.537722 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.538129 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_orders"
[0m18:05:17.538367 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:05:17.538748 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:05:17.539894 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: COMMIT
[0m18:05:17.540932 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: COMMIT
[0m18:05:17.541180 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:05:17.542543 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:05:17.542851 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: COMMIT
[0m18:05:17.543111 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: COMMIT
[0m18:05:17.543726 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:05:17.544195 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: Close
[0m18:05:17.544429 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:05:17.544802 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107967cb0>]}
[0m18:05:17.545224 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: Close
[0m18:05:17.545909 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88b127f0-c5e1-4bff-bb9c-3780e0e1619c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a28890>]}
[0m18:05:17.545650 [info ] [Thread-2 (]: 14 of 15 OK loaded seed file main.sample_orders ................................ [[32mINSERT 10[0m in 0.02s]
[0m18:05:17.546300 [info ] [Thread-4 (]: 15 of 15 OK loaded seed file main.sample_pos_transactions ...................... [[32mINSERT 10[0m in 0.03s]
[0m18:05:17.546656 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.sample_orders
[0m18:05:17.546948 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:05:17.547747 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:17.547934 [debug] [MainThread]: On master: BEGIN
[0m18:05:17.548096 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:17.548417 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:17.548584 [debug] [MainThread]: On master: COMMIT
[0m18:05:17.548776 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:17.548959 [debug] [MainThread]: On master: COMMIT
[0m18:05:17.549257 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:17.549462 [debug] [MainThread]: On master: Close
[0m18:05:17.549719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:17.549877 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.idr_sources' was properly closed.
[0m18:05:17.550028 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_orders' was properly closed.
[0m18:05:17.550245 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_crm_customers' was properly closed.
[0m18:05:17.550462 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_pos_transactions' was properly closed.
[0m18:05:17.550656 [info ] [MainThread]: 
[0m18:05:17.550913 [info ] [MainThread]: Finished running 15 seeds in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m18:05:17.552301 [debug] [MainThread]: Command end result
[0m18:05:17.581512 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:05:17.583722 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:05:17.587984 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/run_results.json
[0m18:05:17.588213 [info ] [MainThread]: 
[0m18:05:17.588431 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:05:17.588612 [info ] [MainThread]: 
[0m18:05:17.588800 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m18:05:17.590371 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.976153, "process_in_blocks": "0", "process_kernel_time": 0.216524, "process_mem_max_rss": "159186944", "process_out_blocks": "0", "process_user_time": 1.593372}
[0m18:05:17.590627 [debug] [MainThread]: Command `dbt seed` succeeded at 18:05:17.590584 after 0.98 seconds
[0m18:05:17.590836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10032ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745fad0>]}
[0m18:05:17.591038 [debug] [MainThread]: Flushing usage events
[0m18:05:18.094784 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:19.346375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104244590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d7890>]}


============================== 18:05:19.349397 | 76e1f573-0b5f-453e-97b8-782cc8ff1614 ==============================
[0m18:05:19.349397 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:05:19.349773 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'profiles_dir': '.', 'warn_error': 'None', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'fail_fast': 'False', 'printer_width': '80', 'use_colors': 'True', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m18:05:19.474505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76e1f573-0b5f-453e-97b8-782cc8ff1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043f1810>]}
[0m18:05:19.510204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76e1f573-0b5f-453e-97b8-782cc8ff1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f77790>]}
[0m18:05:19.511283 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:05:19.578523 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:05:19.670959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:05:19.671254 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:05:19.671430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:05:19.709796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76e1f573-0b5f-453e-97b8-782cc8ff1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550c050>]}
[0m18:05:19.823632 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:05:19.825150 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:05:19.836128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76e1f573-0b5f-453e-97b8-782cc8ff1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051d6e40>]}
[0m18:05:19.836426 [info ] [MainThread]: Found 35 data tests, 15 seeds, 11 models, 6 sources, 591 macros
[0m18:05:19.836641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76e1f573-0b5f-453e-97b8-782cc8ff1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d9c50>]}
[0m18:05:19.838191 [info ] [MainThread]: 
[0m18:05:19.838393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:05:19.838558 [info ] [MainThread]: 
[0m18:05:19.838834 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:05:19.841795 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:05:19.842206 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:05:19.843567 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:05:19.873045 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:05:19.873413 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:05:19.873638 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:05:19.873918 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:05:19.874185 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:05:19.874447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:19.874667 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:05:19.874888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:19.875318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:19.883958 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:05:19.884245 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:05:19.885013 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:05:19.885279 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:05:19.886412 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:05:19.887128 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:05:19.887656 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_staging)
[0m18:05:19.887915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_out)
[0m18:05:19.888160 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_work)
[0m18:05:19.888408 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_staging"
"
[0m18:05:19.888647 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_out"
"
[0m18:05:19.888870 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_work"
"
[0m18:05:19.893033 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m18:05:19.894398 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m18:05:19.895440 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m18:05:19.895736 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:05:19.896069 [debug] [ThreadPool]: On create_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_out"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:05:19.896320 [debug] [ThreadPool]: On create_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_work"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:05:19.896548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:19.896712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:19.896889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:19.897928 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:19.898133 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:19.899140 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m18:05:19.899345 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: BEGIN
[0m18:05:19.899538 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:05:19.900232 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m18:05:19.900547 [debug] [ThreadPool]: On create_test_idr_main_idr_out: BEGIN
[0m18:05:19.901288 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m18:05:19.901608 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:19.901827 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:19.902037 [debug] [ThreadPool]: On create_test_idr_main_idr_work: BEGIN
[0m18:05:19.902552 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m18:05:19.902774 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m18:05:19.903206 [debug] [ThreadPool]: On create_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_out"} */

    
    
        create schema if not exists "test_idr"."main_idr_out"
    
[0m18:05:19.903505 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_staging"} */

    
    
        create schema if not exists "test_idr"."main_idr_staging"
    
[0m18:05:19.903693 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:19.904057 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m18:05:19.904263 [debug] [ThreadPool]: On create_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_work"} */

    
    
        create schema if not exists "test_idr"."main_idr_work"
    
[0m18:05:19.904523 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:19.905096 [debug] [ThreadPool]: On create_test_idr_main_idr_out: COMMIT
[0m18:05:19.905283 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m18:05:19.905449 [debug] [ThreadPool]: On create_test_idr_main_idr_out: COMMIT
[0m18:05:19.905721 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:05:19.906249 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: COMMIT
[0m18:05:19.906447 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m18:05:19.906634 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:05:19.906826 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: COMMIT
[0m18:05:19.906987 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:19.907554 [debug] [ThreadPool]: On create_test_idr_main_idr_work: COMMIT
[0m18:05:19.907919 [debug] [ThreadPool]: On create_test_idr_main_idr_out: Close
[0m18:05:19.908178 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m18:05:19.908412 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:19.908613 [debug] [ThreadPool]: On create_test_idr_main_idr_work: COMMIT
[0m18:05:19.908981 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: Close
[0m18:05:19.909367 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:19.909565 [debug] [ThreadPool]: On create_test_idr_main_idr_work: Close
[0m18:05:19.911141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_staging, now list_test_idr_main_idr_meta)
[0m18:05:19.914597 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:05:19.914889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_work, now list_test_idr_main_idr_out)
[0m18:05:19.915153 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: BEGIN
[0m18:05:19.915401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_out, now list_test_idr_main)
[0m18:05:19.916568 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:05:19.916869 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_staging'
[0m18:05:19.917104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:19.918370 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:05:19.918631 [debug] [ThreadPool]: On list_test_idr_main_idr_out: BEGIN
[0m18:05:19.919721 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:05:19.920088 [debug] [ThreadPool]: On list_test_idr_main: BEGIN
[0m18:05:19.920319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:19.920539 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:05:19.920748 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: BEGIN
[0m18:05:19.920966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:19.921203 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:05:19.921382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:19.921578 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:19.921820 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_meta"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_meta'
    and lower(table_catalog) = 'test_idr'
  
[0m18:05:19.922083 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:19.922280 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:05:19.922557 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:05:19.922776 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:05:19.923001 [debug] [ThreadPool]: On list_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_out"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_out'
    and lower(table_catalog) = 'test_idr'
  
[0m18:05:19.923223 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:05:19.923435 [debug] [ThreadPool]: On list_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'test_idr'
  
[0m18:05:19.923868 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_staging"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_staging'
    and lower(table_catalog) = 'test_idr'
  
[0m18:05:19.930482 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m18:05:19.930877 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m18:05:19.931178 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m18:05:19.932019 [debug] [ThreadPool]: On list_test_idr_main_idr_out: ROLLBACK
[0m18:05:19.932249 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:05:19.933192 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: ROLLBACK
[0m18:05:19.933956 [debug] [ThreadPool]: On list_test_idr_main: ROLLBACK
[0m18:05:19.934857 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: ROLLBACK
[0m18:05:19.935633 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_staging'
[0m18:05:19.936065 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main'
[0m18:05:19.936407 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_out'
[0m18:05:19.936574 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: Close
[0m18:05:19.936815 [debug] [ThreadPool]: On list_test_idr_main: Close
[0m18:05:19.937130 [debug] [ThreadPool]: On list_test_idr_main_idr_out: Close
[0m18:05:19.937469 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_meta'
[0m18:05:19.937850 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_staging, now list_test_idr_main_idr_work)
[0m18:05:19.938869 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: Close
[0m18:05:19.940042 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:05:19.943065 [debug] [ThreadPool]: On list_test_idr_main_idr_work: BEGIN
[0m18:05:19.943246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:05:19.943616 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:05:19.943786 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:05:19.944024 [debug] [ThreadPool]: On list_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_work"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_work'
    and lower(table_catalog) = 'test_idr'
  
[0m18:05:19.946040 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:05:19.946815 [debug] [ThreadPool]: On list_test_idr_main_idr_work: ROLLBACK
[0m18:05:19.947141 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_work'
[0m18:05:19.947310 [debug] [ThreadPool]: On list_test_idr_main_idr_work: Close
[0m18:05:19.947929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76e1f573-0b5f-453e-97b8-782cc8ff1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590b040>]}
[0m18:05:19.948262 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:19.948445 [debug] [MainThread]: On master: BEGIN
[0m18:05:19.948610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:05:19.948951 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:19.949205 [debug] [MainThread]: On master: COMMIT
[0m18:05:19.949408 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:19.949594 [debug] [MainThread]: On master: COMMIT
[0m18:05:19.949877 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:19.950058 [debug] [MainThread]: On master: Close
[0m18:05:19.951363 [debug] [Thread-1 (]: Began running node model.dbt_idr.stg_identifiers
[0m18:05:19.951684 [info ] [Thread-1 (]: 1 of 11 START sql table model main_idr_staging.stg_identifiers ................. [RUN]
[0m18:05:19.952004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_meta, now model.dbt_idr.stg_identifiers)
[0m18:05:19.952225 [debug] [Thread-1 (]: Began compiling node model.dbt_idr.stg_identifiers
[0m18:05:19.964827 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:05:19.965126 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

    
    select * from "test_idr"."main"."idr_sources" where is_active = true

  
[0m18:05:19.965337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:05:19.966476 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:05:19.967492 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:05:19.967754 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

    
    select 
        m.*,
        r.canonicalize,
        r.priority,
        coalesce(r.max_group_size, 1000) as max_group_size
    from "test_idr"."main"."idr_identifier_mappings" m
    inner join "test_idr"."main"."idr_rules" r on m.identifier_type = r.identifier_type
    where r.is_active = true

  
[0m18:05:19.971814 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:05:19.976719 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idr.stg_identifiers"
[0m18:05:19.977497 [debug] [Thread-1 (]: Began executing node model.dbt_idr.stg_identifiers
[0m18:05:19.997219 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idr.stg_identifiers"
[0m18:05:19.997876 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:05:19.998088 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: BEGIN
[0m18:05:19.998467 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:05:19.998656 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:05:19.998983 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

  
    
    

    create  table
      "test_idr"."main_idr_staging"."stg_identifiers__dbt_tmp"
  
    as (
      









    
    
    
    
    






    
    
    
    
    
    
    
    
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
    
        
    
        
    
        
    

    
    
    
    
    
    
    
    
    
        
    
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
    
        
    

    
    
    
    
    
    
    
    
    
        
    
        
    
        
    
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    



with raw_identifiers as (
    
        
select
    'crm' as source_id,
    concat('crm', ':', cast(customer_id as TEXT)) as entity_key,
    'EMAIL' as identifier_type,
    cast(email as TEXT) as identifier_value_raw,
    cast(lower(email) as TEXT) as identifier_value_norm,
    False as is_hashed,
    1 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.main.sample_crm_customers
where email is not null
            
union all

select
    'crm' as source_id,
    concat('crm', ':', cast(customer_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(phone as TEXT) as identifier_value_raw,
    cast(phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.main.sample_crm_customers
where phone is not null
            
union all

select
    'orders' as source_id,
    concat('orders', ':', cast(order_id as TEXT)) as entity_key,
    'EMAIL' as identifier_type,
    cast(customer_email as TEXT) as identifier_value_raw,
    cast(lower(customer_email) as TEXT) as identifier_value_norm,
    False as is_hashed,
    1 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.main.sample_orders
where customer_email is not null
            
union all

select
    'orders' as source_id,
    concat('orders', ':', cast(order_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(contact_phone as TEXT) as identifier_value_raw,
    cast(contact_phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.main.sample_orders
where contact_phone is not null
            
union all

select
    'pos' as source_id,
    concat('pos', ':', cast(transaction_id as TEXT)) as entity_key,
    'LOYALTY' as identifier_type,
    cast(loyalty_card_id as TEXT) as identifier_value_raw,
    cast(loyalty_card_id as TEXT) as identifier_value_norm,
    False as is_hashed,
    3 as priority,
    10 as max_group_size,
    current_timestamp as extracted_at
from main.main.sample_pos_transactions
where loyalty_card_id is not null
            
union all

select
    'pos' as source_id,
    concat('pos', ':', cast(transaction_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(contact_phone as TEXT) as identifier_value_raw,
    cast(contact_phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.main.sample_pos_transactions
where contact_phone is not null
            
    
),

exclusions as (
    select identifier_type, identifier_value_pattern, match_type
    from "test_idr"."main"."idr_exclusions"
),


filtered_identifiers as (
    select r.*
    from raw_identifiers r
    where not exists (
        select 1 from exclusions e
        where e.identifier_type = r.identifier_type
          and (
            (e.match_type = 'EXACT' and r.identifier_value_norm = e.identifier_value_pattern)
            or (e.match_type = 'LIKE' and r.identifier_value_norm like e.identifier_value_pattern)
          )
    )
)

select * from filtered_identifiers
    );
  
  
[0m18:05:20.003102 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

  
    
    

    create  table
      "test_idr"."main_idr_staging"."stg_identifiers__dbt_tmp"
  
    as (
      









    
    
    
    
    






    
    
    
    
    
    
    
    
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
    
        
    
        
    
        
    

    
    
    
    
    
    
    
    
    
        
    
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
    
        
    

    
    
    
    
    
    
    
    
    
        
    
        
    
        
    
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    



with raw_identifiers as (
    
        
select
    'crm' as source_id,
    concat('crm', ':', cast(customer_id as TEXT)) as entity_key,
    'EMAIL' as identifier_type,
    cast(email as TEXT) as identifier_value_raw,
    cast(lower(email) as TEXT) as identifier_value_norm,
    False as is_hashed,
    1 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.main.sample_crm_customers
where email is not null
            
union all

select
    'crm' as source_id,
    concat('crm', ':', cast(customer_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(phone as TEXT) as identifier_value_raw,
    cast(phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.main.sample_crm_customers
where phone is not null
            
union all

select
    'orders' as source_id,
    concat('orders', ':', cast(order_id as TEXT)) as entity_key,
    'EMAIL' as identifier_type,
    cast(customer_email as TEXT) as identifier_value_raw,
    cast(lower(customer_email) as TEXT) as identifier_value_norm,
    False as is_hashed,
    1 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.main.sample_orders
where customer_email is not null
            
union all

select
    'orders' as source_id,
    concat('orders', ':', cast(order_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(contact_phone as TEXT) as identifier_value_raw,
    cast(contact_phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.main.sample_orders
where contact_phone is not null
            
union all

select
    'pos' as source_id,
    concat('pos', ':', cast(transaction_id as TEXT)) as entity_key,
    'LOYALTY' as identifier_type,
    cast(loyalty_card_id as TEXT) as identifier_value_raw,
    cast(loyalty_card_id as TEXT) as identifier_value_norm,
    False as is_hashed,
    3 as priority,
    10 as max_group_size,
    current_timestamp as extracted_at
from main.main.sample_pos_transactions
where loyalty_card_id is not null
            
union all

select
    'pos' as source_id,
    concat('pos', ':', cast(transaction_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(contact_phone as TEXT) as identifier_value_raw,
    cast(contact_phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.main.sample_pos_transactions
where contact_phone is not null
            
    
),

exclusions as (
    select identifier_type, identifier_value_pattern, match_type
    from "test_idr"."main"."idr_exclusions"
),


filtered_identifiers as (
    select r.*
    from raw_identifiers r
    where not exists (
        select 1 from exclusions e
        where e.identifier_type = r.identifier_type
          and (
            (e.match_type = 'EXACT' and r.identifier_value_norm = e.identifier_value_pattern)
            or (e.match_type = 'LIKE' and r.identifier_value_norm like e.identifier_value_pattern)
          )
    )
)

select * from filtered_identifiers
    );
  
  
[0m18:05:20.003577 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m18:05:20.003889 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: ROLLBACK
[0m18:05:20.009768 [debug] [Thread-1 (]: Failed to rollback 'model.dbt_idr.stg_identifiers'
[0m18:05:20.010048 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: Close
[0m18:05:20.012414 [debug] [Thread-1 (]: Runtime Error in model stg_identifiers (models/staging/stg_identifiers.sql)
  Binder Error: Catalog "main" does not exist!
[0m18:05:20.013367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76e1f573-0b5f-453e-97b8-782cc8ff1614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105832510>]}
[0m18:05:20.013729 [error] [Thread-1 (]: 1 of 11 ERROR creating sql table model main_idr_staging.stg_identifiers ........ [[31mERROR[0m in 0.06s]
[0m18:05:20.014050 [debug] [Thread-1 (]: Finished running node model.dbt_idr.stg_identifiers
[0m18:05:20.014320 [debug] [Thread-7 (]: Marking all children of 'model.dbt_idr.stg_identifiers' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_identifiers (models/staging/stg_identifiers.sql)
  Binder Error: Catalog "main" does not exist!.
[0m18:05:20.015087 [debug] [Thread-2 (]: Began running node model.dbt_idr.int_edges
[0m18:05:20.015691 [debug] [Thread-3 (]: Began running node model.dbt_idr.skipped_identifier_groups
[0m18:05:20.015443 [info ] [Thread-2 (]: 2 of 11 SKIP relation main_idr_work.int_edges .................................. [[33mSKIP[0m]
[0m18:05:20.016343 [debug] [Thread-2 (]: Finished running node model.dbt_idr.int_edges
[0m18:05:20.016079 [info ] [Thread-3 (]: 3 of 11 SKIP relation main_idr_out.skipped_identifier_groups ................... [[33mSKIP[0m]
[0m18:05:20.016802 [debug] [Thread-3 (]: Finished running node model.dbt_idr.skipped_identifier_groups
[0m18:05:20.017084 [debug] [Thread-4 (]: Began running node model.dbt_idr.identity_edges
[0m18:05:20.017321 [debug] [Thread-2 (]: Began running node model.dbt_idr.rule_match_audit
[0m18:05:20.017544 [debug] [Thread-1 (]: Began running node model.dbt_idr.int_labels
[0m18:05:20.017793 [info ] [Thread-4 (]: 4 of 11 SKIP relation main_idr_out.identity_edges .............................. [[33mSKIP[0m]
[0m18:05:20.018080 [info ] [Thread-2 (]: 6 of 11 SKIP relation main_idr_out.rule_match_audit ............................ [[33mSKIP[0m]
[0m18:05:20.018588 [debug] [Thread-4 (]: Finished running node model.dbt_idr.identity_edges
[0m18:05:20.018300 [info ] [Thread-1 (]: 5 of 11 SKIP relation main_idr_work.int_labels ................................. [[33mSKIP[0m]
[0m18:05:20.018918 [debug] [Thread-2 (]: Finished running node model.dbt_idr.rule_match_audit
[0m18:05:20.019185 [debug] [Thread-1 (]: Finished running node model.dbt_idr.int_labels
[0m18:05:20.019630 [debug] [Thread-3 (]: Began running node model.dbt_idr.identity_membership
[0m18:05:20.019936 [info ] [Thread-3 (]: 7 of 11 SKIP relation main_idr_out.identity_membership ......................... [[33mSKIP[0m]
[0m18:05:20.020274 [debug] [Thread-3 (]: Finished running node model.dbt_idr.identity_membership
[0m18:05:20.020599 [debug] [Thread-2 (]: Began running node model.dbt_idr.identity_clusters
[0m18:05:20.020837 [debug] [Thread-4 (]: Began running node model.dbt_idr.golden_profiles
[0m18:05:20.021060 [info ] [Thread-2 (]: 9 of 11 SKIP relation main_idr_out.identity_clusters ........................... [[33mSKIP[0m]
[0m18:05:20.021530 [debug] [Thread-2 (]: Finished running node model.dbt_idr.identity_clusters
[0m18:05:20.021277 [info ] [Thread-4 (]: 8 of 11 SKIP relation main_idr_out.golden_profiles ............................. [[33mSKIP[0m]
[0m18:05:20.021853 [debug] [Thread-4 (]: Finished running node model.dbt_idr.golden_profiles
[0m18:05:20.022093 [debug] [Thread-1 (]: Began running node model.dbt_idr.run_history
[0m18:05:20.022300 [info ] [Thread-1 (]: 10 of 11 SKIP relation main_idr_out.run_history ................................ [[33mSKIP[0m]
[0m18:05:20.022524 [debug] [Thread-1 (]: Finished running node model.dbt_idr.run_history
[0m18:05:20.022767 [debug] [Thread-3 (]: Began running node model.dbt_idr.stage_metrics
[0m18:05:20.022973 [info ] [Thread-3 (]: 11 of 11 SKIP relation main_idr_out.stage_metrics .............................. [[33mSKIP[0m]
[0m18:05:20.023194 [debug] [Thread-3 (]: Finished running node model.dbt_idr.stage_metrics
[0m18:05:20.023912 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:20.024114 [debug] [MainThread]: On master: BEGIN
[0m18:05:20.024276 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:05:20.024648 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:20.024827 [debug] [MainThread]: On master: COMMIT
[0m18:05:20.024989 [debug] [MainThread]: Using duckdb connection "master"
[0m18:05:20.025147 [debug] [MainThread]: On master: COMMIT
[0m18:05:20.025431 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:05:20.025616 [debug] [MainThread]: On master: Close
[0m18:05:20.025911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:20.026304 [debug] [MainThread]: Connection 'model.dbt_idr.stg_identifiers' was properly closed.
[0m18:05:20.026527 [debug] [MainThread]: Connection 'list_test_idr_main_idr_out' was properly closed.
[0m18:05:20.026736 [debug] [MainThread]: Connection 'list_test_idr_main' was properly closed.
[0m18:05:20.026900 [debug] [MainThread]: Connection 'list_test_idr_main_idr_work' was properly closed.
[0m18:05:20.027117 [info ] [MainThread]: 
[0m18:05:20.027294 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m18:05:20.027773 [debug] [MainThread]: Command end result
[0m18:05:20.052974 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:05:20.054332 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:05:20.058157 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/run_results.json
[0m18:05:20.058394 [info ] [MainThread]: 
[0m18:05:20.058626 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:05:20.058907 [info ] [MainThread]: 
[0m18:05:20.059142 [error] [MainThread]: [31mFailure in model stg_identifiers (models/staging/stg_identifiers.sql)[0m
[0m18:05:20.059359 [error] [MainThread]:   Runtime Error in model stg_identifiers (models/staging/stg_identifiers.sql)
  Binder Error: Catalog "main" does not exist!
[0m18:05:20.059525 [info ] [MainThread]: 
[0m18:05:20.059722 [info ] [MainThread]:   compiled code at target/compiled/dbt_idr/models/staging/stg_identifiers.sql
[0m18:05:20.059891 [info ] [MainThread]: 
[0m18:05:20.060082 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=10 NO-OP=0 TOTAL=11
[0m18:05:20.061715 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7592383, "process_in_blocks": "0", "process_kernel_time": 0.171356, "process_mem_max_rss": "154468352", "process_out_blocks": "0", "process_user_time": 1.451918}
[0m18:05:20.062093 [debug] [MainThread]: Command `dbt run` failed at 18:05:20.062036 after 0.76 seconds
[0m18:05:20.062342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584be30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba6170>]}
[0m18:05:20.062584 [debug] [MainThread]: Flushing usage events
[0m18:05:20.390458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:50.355153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089c8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5a7890>]}


============================== 18:06:50.358864 | a4e46299-9b2e-4f6c-9a4f-b6f6dcb8eebc ==============================
[0m18:06:50.358864 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:06:50.359256 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'printer_width': '80', 'cache_selected_only': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '.', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'use_colors': 'True', 'quiet': 'False', 'invocation_command': 'dbt deps --profiles-dir .', 'debug': 'False', 'log_format': 'default', 'write_json': 'True', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'version_check': 'True', 'fail_fast': 'False', 'log_cache_events': 'False'}
[0m18:06:50.436306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4e46299-9b2e-4f6c-9a4f-b6f6dcb8eebc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc1810>]}
[0m18:06:50.471577 [debug] [MainThread]: Set downloads directory='/var/folders/pt/f4g5v3rd52xd_n4yxjprb57h0000gn/T/dbt-downloads-o2q747zg'
[0m18:06:50.471938 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:06:50.658240 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:06:50.659811 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:06:50.712642 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:06:50.717943 [info ] [MainThread]: Installing ../
[0m18:06:50.721292 [debug] [MainThread]: Creating symlink to local dependency.
[0m18:06:50.721787 [info ] [MainThread]: Installed from <local @ ../>
[0m18:06:50.722158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a4e46299-9b2e-4f6c-9a4f-b6f6dcb8eebc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a446e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a446ad0>]}
[0m18:06:50.722527 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:06:50.895353 [info ] [MainThread]: Installed from version 1.3.3
[0m18:06:50.895662 [info ] [MainThread]: Up to date!
[0m18:06:50.895903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a4e46299-9b2e-4f6c-9a4f-b6f6dcb8eebc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a763450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a75fd40>]}
[0m18:06:50.898338 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.59015906, "process_in_blocks": "0", "process_kernel_time": 0.191497, "process_mem_max_rss": "116604928", "process_out_blocks": "0", "process_user_time": 0.93789}
[0m18:06:50.898852 [debug] [MainThread]: Command `dbt deps` succeeded at 18:06:50.898743 after 0.59 seconds
[0m18:06:50.899106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41fe70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f9b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7aadd0>]}
[0m18:06:50.899337 [debug] [MainThread]: Flushing usage events
[0m18:06:51.333250 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:52.494569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a610590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baa7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baa7890>]}


============================== 18:06:52.497271 | 61b28f55-e8e7-4a7e-9ee6-792dc17385fa ==============================
[0m18:06:52.497271 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:06:52.497628 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_format': 'default', 'printer_width': '80', 'log_cache_events': 'False', 'invocation_command': 'dbt seed --profiles-dir .', 'empty': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'no_print': 'None', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'partial_parse': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'debug': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager'}
[0m18:06:52.693868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7cd810>]}
[0m18:06:52.728069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b947790>]}
[0m18:06:52.729663 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:06:52.798199 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:06:52.898219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m18:06:52.898885 [debug] [MainThread]: Partial parsing: updated file: dbt_idr://models/staging/stg_identifiers.sql
[0m18:06:52.899155 [debug] [MainThread]: Partial parsing: updated file: dbt_idr_integration_tests://seeds/idr_sources.csv
[0m18:06:52.899413 [debug] [MainThread]: Partial parsing: updated file: dbt_idr://models/marts/golden_profiles.sql
[0m18:06:53.256227 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'stg_identifiers'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_sources'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:06:53.256601 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'stg_identifiers'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_identifier_mappings'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:06:53.256831 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'stg_identifiers'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_rules'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:06:53.257035 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'stg_identifiers'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_exclusions'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:06:53.257234 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'golden_profiles'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_sources'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:06:53.257434 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'golden_profiles'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_attribute_mappings'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:06:53.257620 [warn ] [MainThread]: [[33mWARNING[0m]: The node 'golden_profiles'in package 'dbt_idr' depends on the root project node 'seed.dbt_idr_integration_tests.idr_survivorship_rules'.This may lead to unexpected cycles downstream. Please set the 'require_ref_prefers_node_package_to_root' behavior change flag to True to avoid this issue.For more information, see the documentation at https://docs.getdbt.com/reference/global-configs/behavior-changes#require_ref_prefers_node_package_to_root
[0m18:06:53.308498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1dfa50>]}
[0m18:06:53.386926 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:06:53.388869 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:06:53.402193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d6210>]}
[0m18:06:53.402524 [info ] [MainThread]: Found 35 data tests, 15 seeds, 11 models, 6 sources, 591 macros
[0m18:06:53.402870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d05cc90>]}
[0m18:06:53.404709 [info ] [MainThread]: 
[0m18:06:53.404930 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:06:53.405112 [info ] [MainThread]: 
[0m18:06:53.405393 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:06:53.408485 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:06:53.415039 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:06:53.441866 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:06:53.442151 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:06:53.442366 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:06:53.442588 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:06:53.442796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:53.442982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:53.459374 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m18:06:53.459635 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m18:06:53.460785 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:06:53.461512 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:06:53.462040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_meta)
[0m18:06:53.462272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main)
[0m18:06:53.462544 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_meta"
"
[0m18:06:53.462793 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main"
"
[0m18:06:53.466949 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:06:53.468329 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:06:53.468534 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_meta"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:06:53.468738 [debug] [ThreadPool]: On create_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:06:53.468925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:53.469103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:53.469968 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:53.470150 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:53.470969 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:06:53.471667 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:06:53.471850 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: BEGIN
[0m18:06:53.472040 [debug] [ThreadPool]: On create_test_idr_main: BEGIN
[0m18:06:53.472352 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:53.472537 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:06:53.472706 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:53.472889 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_meta"} */

    
    
        create schema if not exists "test_idr"."main_idr_meta"
    
[0m18:06:53.473079 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:06:53.473303 [debug] [ThreadPool]: On create_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main"} */

    
    
        create schema if not exists "test_idr"."main"
    
[0m18:06:53.473557 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:53.474055 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: COMMIT
[0m18:06:53.474223 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:06:53.474395 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:53.474559 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: COMMIT
[0m18:06:53.475034 [debug] [ThreadPool]: On create_test_idr_main: COMMIT
[0m18:06:53.475359 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:06:53.475541 [debug] [ThreadPool]: On create_test_idr_main: COMMIT
[0m18:06:53.475906 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:53.476088 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:53.476262 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: Close
[0m18:06:53.476476 [debug] [ThreadPool]: On create_test_idr_main: Close
[0m18:06:53.478260 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_meta, now list_test_idr_main_idr_out)
[0m18:06:53.481476 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:06:53.481739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main, now list_test_idr_main_idr_work)
[0m18:06:53.482034 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_meta'
[0m18:06:53.482223 [debug] [ThreadPool]: On list_test_idr_main_idr_out: BEGIN
[0m18:06:53.482482 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main'
[0m18:06:53.483680 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:06:53.484708 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:06:53.484893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:53.485888 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:06:53.486078 [debug] [ThreadPool]: On list_test_idr_main_idr_work: BEGIN
[0m18:06:53.486258 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: BEGIN
[0m18:06:53.486526 [debug] [ThreadPool]: On list_test_idr_main: BEGIN
[0m18:06:53.486699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:53.486888 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:06:53.487045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:53.487217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:53.487458 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:06:53.487677 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:53.487970 [debug] [ThreadPool]: On list_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_out"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_out'
    and lower(table_catalog) = 'test_idr'
  
[0m18:06:53.488154 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:53.488325 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:06:53.488512 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:53.488907 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:06:53.489117 [debug] [ThreadPool]: On list_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_work"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_work'
    and lower(table_catalog) = 'test_idr'
  
[0m18:06:53.489301 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:06:53.489492 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_meta"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_meta'
    and lower(table_catalog) = 'test_idr'
  
[0m18:06:53.489774 [debug] [ThreadPool]: On list_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'test_idr'
  
[0m18:06:53.499666 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:06:53.499952 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:06:53.500169 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:06:53.500364 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:06:53.501493 [debug] [ThreadPool]: On list_test_idr_main_idr_out: ROLLBACK
[0m18:06:53.502234 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: ROLLBACK
[0m18:06:53.502912 [debug] [ThreadPool]: On list_test_idr_main_idr_work: ROLLBACK
[0m18:06:53.503536 [debug] [ThreadPool]: On list_test_idr_main: ROLLBACK
[0m18:06:53.504361 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_out'
[0m18:06:53.504558 [debug] [ThreadPool]: On list_test_idr_main_idr_out: Close
[0m18:06:53.504840 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_meta'
[0m18:06:53.505109 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_work'
[0m18:06:53.505385 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main'
[0m18:06:53.505660 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_out, now list_test_idr_main_idr_staging)
[0m18:06:53.505848 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: Close
[0m18:06:53.506025 [debug] [ThreadPool]: On list_test_idr_main_idr_work: Close
[0m18:06:53.506196 [debug] [ThreadPool]: On list_test_idr_main: Close
[0m18:06:53.507288 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:06:53.507783 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: BEGIN
[0m18:06:53.507973 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:53.508382 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:53.508611 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:06:53.508801 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_staging"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_staging'
    and lower(table_catalog) = 'test_idr'
  
[0m18:06:53.510566 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:06:53.511321 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: ROLLBACK
[0m18:06:53.511697 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_staging'
[0m18:06:53.511912 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: Close
[0m18:06:53.512361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d401090>]}
[0m18:06:53.512696 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:53.512893 [debug] [MainThread]: On master: BEGIN
[0m18:06:53.513058 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:53.513381 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:53.513561 [debug] [MainThread]: On master: COMMIT
[0m18:06:53.513736 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:53.513908 [debug] [MainThread]: On master: COMMIT
[0m18:06:53.514185 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:53.514380 [debug] [MainThread]: On master: Close
[0m18:06:53.515892 [debug] [Thread-1 (]: Began running node seed.dbt_idr.idr_attribute_mappings
[0m18:06:53.516132 [debug] [Thread-3 (]: Began running node seed.dbt_idr.idr_identifier_mappings
[0m18:06:53.516346 [debug] [Thread-4 (]: Began running node seed.dbt_idr.idr_rules
[0m18:06:53.516549 [debug] [Thread-2 (]: Began running node seed.dbt_idr.idr_exclusions
[0m18:06:53.516837 [info ] [Thread-1 (]: 1 of 15 START seed file main_idr_meta.idr_attribute_mappings ................... [RUN]
[0m18:06:53.517203 [info ] [Thread-3 (]: 3 of 15 START seed file main_idr_meta.idr_identifier_mappings .................. [RUN]
[0m18:06:53.517587 [info ] [Thread-4 (]: 4 of 15 START seed file main_idr_meta.idr_rules ................................ [RUN]
[0m18:06:53.517879 [info ] [Thread-2 (]: 2 of 15 START seed file main_idr_meta.idr_exclusions ........................... [RUN]
[0m18:06:53.518147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_staging, now seed.dbt_idr.idr_attribute_mappings)
[0m18:06:53.518389 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_meta, now seed.dbt_idr.idr_identifier_mappings)
[0m18:06:53.518607 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_test_idr_main, now seed.dbt_idr.idr_rules)
[0m18:06:53.518829 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_work, now seed.dbt_idr.idr_exclusions)
[0m18:06:53.519046 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr.idr_attribute_mappings
[0m18:06:53.519269 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr.idr_identifier_mappings
[0m18:06:53.519463 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr.idr_rules
[0m18:06:53.519669 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr.idr_exclusions
[0m18:06:53.519890 [debug] [Thread-1 (]: Began executing node seed.dbt_idr.idr_attribute_mappings
[0m18:06:53.520105 [debug] [Thread-3 (]: Began executing node seed.dbt_idr.idr_identifier_mappings
[0m18:06:53.520301 [debug] [Thread-4 (]: Began executing node seed.dbt_idr.idr_rules
[0m18:06:53.520546 [debug] [Thread-2 (]: Began executing node seed.dbt_idr.idr_exclusions
[0m18:06:53.536786 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:06:53.543570 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: BEGIN
[0m18:06:53.543811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:53.545365 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:06:53.545600 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: BEGIN
[0m18:06:53.545806 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:06:53.546530 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:06:53.547329 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:06:53.547602 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: BEGIN
[0m18:06:53.547824 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.548026 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:06:53.548236 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: BEGIN
[0m18:06:53.548430 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:06:53.548638 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:06:53.548864 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:06:53.549091 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:06:53.549418 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_rules"} */

    create table "test_idr"."main_idr_meta"."idr_rules" ("rule_id" text,"identifier_type" text,"priority" integer,"is_active" boolean,"canonicalize" text,"max_group_size" integer,"description" text)
  
[0m18:06:53.549643 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.549837 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_attribute_mappings"} */

    create table "test_idr"."main_idr_meta"."idr_attribute_mappings" ("source_id" text,"attribute_name" text,"column_expr" text,"description" text)
  
[0m18:06:53.550252 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:06:53.550524 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.550896 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_exclusions"} */

    create table "test_idr"."main_idr_meta"."idr_exclusions" ("identifier_type" text,"identifier_value_pattern" text,"match_type" text,"reason" text)
  
[0m18:06:53.551181 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:06:53.551396 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.551600 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.551892 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_identifier_mappings"} */

    create table "test_idr"."main_idr_meta"."idr_identifier_mappings" ("source_id" text,"identifier_type" text,"column_name" text,"is_hashed" boolean,"description" text)
  
[0m18:06:53.558976 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:06:53.559226 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m18:06:53.560023 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:06:53.560436 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: 
          COPY "test_idr"."main_idr_meta"."idr_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.561143 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:06:53.561369 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.561578 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: 
          COPY "test_idr"."main_idr_meta"."idr_attribute_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_attribute_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.561916 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: 
          COPY "test_idr"."main_idr_meta"."idr_exclusions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_exclusions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.562725 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:06:53.563157 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: 
          COPY "test_idr"."main_idr_meta"."idr_identifier_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_identifier_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.572480 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m18:06:53.576258 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr.idr_exclusions"
[0m18:06:53.576577 [debug] [Thread-1 (]: SQL status: OK in 0.014 seconds
[0m18:06:53.576851 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m18:06:53.577090 [debug] [Thread-4 (]: SQL status: OK in 0.015 seconds
[0m18:06:53.577513 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr.idr_attribute_mappings"
[0m18:06:53.577938 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr.idr_identifier_mappings"
[0m18:06:53.578343 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr.idr_rules"
[0m18:06:53.586558 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: COMMIT
[0m18:06:53.586967 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:06:53.587983 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: COMMIT
[0m18:06:53.588222 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: COMMIT
[0m18:06:53.589161 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: COMMIT
[0m18:06:53.590069 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: COMMIT
[0m18:06:53.590269 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:06:53.590560 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:06:53.590785 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:06:53.591023 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: COMMIT
[0m18:06:53.591225 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: COMMIT
[0m18:06:53.591424 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.591609 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: COMMIT
[0m18:06:53.592737 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: Close
[0m18:06:53.593021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.593226 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.593456 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:06:53.594267 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: Close
[0m18:06:53.594916 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: Close
[0m18:06:53.595344 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: Close
[0m18:06:53.595887 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3d87d0>]}
[0m18:06:53.596084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d011ff0>]}
[0m18:06:53.596272 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d010730>]}
[0m18:06:53.596500 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a75f250>]}
[0m18:06:53.596757 [info ] [Thread-2 (]: 2 of 15 OK loaded seed file main_idr_meta.idr_exclusions ....................... [[32mINSERT 5[0m in 0.07s]
[0m18:06:53.596978 [info ] [Thread-1 (]: 1 of 15 OK loaded seed file main_idr_meta.idr_attribute_mappings ............... [[32mINSERT 10[0m in 0.08s]
[0m18:06:53.597825 [debug] [Thread-2 (]: Finished running node seed.dbt_idr.idr_exclusions
[0m18:06:53.597283 [info ] [Thread-3 (]: 3 of 15 OK loaded seed file main_idr_meta.idr_identifier_mappings .............. [[32mINSERT 5[0m in 0.08s]
[0m18:06:53.598171 [debug] [Thread-1 (]: Finished running node seed.dbt_idr.idr_attribute_mappings
[0m18:06:53.597557 [info ] [Thread-4 (]: 4 of 15 OK loaded seed file main_idr_meta.idr_rules ............................ [[32mINSERT 4[0m in 0.08s]
[0m18:06:53.598479 [debug] [Thread-2 (]: Began running node seed.dbt_idr.idr_sources
[0m18:06:53.598804 [debug] [Thread-3 (]: Finished running node seed.dbt_idr.idr_identifier_mappings
[0m18:06:53.599023 [debug] [Thread-1 (]: Began running node seed.dbt_idr.idr_survivorship_rules
[0m18:06:53.599321 [debug] [Thread-4 (]: Finished running node seed.dbt_idr.idr_rules
[0m18:06:53.599599 [info ] [Thread-2 (]: 5 of 15 START seed file main_idr_meta.idr_sources .............................. [RUN]
[0m18:06:53.599842 [debug] [Thread-3 (]: Began running node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:06:53.600287 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:06:53.600100 [info ] [Thread-1 (]: 6 of 15 START seed file main_idr_meta.idr_survivorship_rules ................... [RUN]
[0m18:06:53.600587 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_exclusions, now seed.dbt_idr.idr_sources)
[0m18:06:53.600841 [info ] [Thread-3 (]: 7 of 15 START seed file main.idr_attribute_mappings ............................ [RUN]
[0m18:06:53.601212 [info ] [Thread-4 (]: 8 of 15 START seed file main.idr_exclusions .................................... [RUN]
[0m18:06:53.601507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_attribute_mappings, now seed.dbt_idr.idr_survivorship_rules)
[0m18:06:53.601778 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr.idr_sources
[0m18:06:53.602051 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_identifier_mappings, now seed.dbt_idr_integration_tests.idr_attribute_mappings)
[0m18:06:53.602304 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_rules, now seed.dbt_idr_integration_tests.idr_exclusions)
[0m18:06:53.602531 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr.idr_survivorship_rules
[0m18:06:53.602753 [debug] [Thread-2 (]: Began executing node seed.dbt_idr.idr_sources
[0m18:06:53.602953 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:06:53.603152 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:06:53.603355 [debug] [Thread-1 (]: Began executing node seed.dbt_idr.idr_survivorship_rules
[0m18:06:53.605335 [debug] [Thread-3 (]: Began executing node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:06:53.605586 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:06:53.607488 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:06:53.611779 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:06:53.613242 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:06:53.613543 [debug] [Thread-2 (]: On seed.dbt_idr.idr_sources: BEGIN
[0m18:06:53.614303 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:06:53.614544 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: BEGIN
[0m18:06:53.614769 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_exclusions: BEGIN
[0m18:06:53.614982 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:06:53.615190 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: BEGIN
[0m18:06:53.615409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:53.615636 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:06:53.616005 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:06:53.616393 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.616732 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.616950 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:06:53.617145 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.617377 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:06:53.617578 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.617941 [debug] [Thread-2 (]: On seed.dbt_idr.idr_sources: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_sources"} */

    create table "test_idr"."main_idr_meta"."idr_sources" ("source_id" text,"source_name" text,"database" text,"schema" text,"table_name" text,"entity_key_column" text,"watermark_column" text,"is_active" boolean,"description" text)
  
[0m18:06:53.618202 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:06:53.618423 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_survivorship_rules"} */

    create table "test_idr"."main_idr_meta"."idr_survivorship_rules" ("attribute_name" text,"strategy" text,"source_priority_list" text,"recency_field" text,"description" text)
  
[0m18:06:53.618675 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:06:53.619076 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_exclusions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_exclusions"} */

    create table "test_idr"."main"."idr_exclusions" ("identifier_type" text,"identifier_value_pattern" text,"match_type" text,"reason" text)
  
[0m18:06:53.619427 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:06:53.619678 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_attribute_mappings"} */

    create table "test_idr"."main"."idr_attribute_mappings" ("source_id" text,"attribute_name" text,"column_expr" text,"description" text)
  
[0m18:06:53.619956 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.620758 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:06:53.621461 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:06:53.621734 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.621959 [debug] [Thread-2 (]: On seed.dbt_idr.idr_sources: 
          COPY "test_idr"."main_idr_meta"."idr_sources" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_sources.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.622178 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.622405 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: 
          COPY "test_idr"."main_idr_meta"."idr_survivorship_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_survivorship_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.623129 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:06:53.623941 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:06:53.624237 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_exclusions: 
          COPY "test_idr"."main"."idr_exclusions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_exclusions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.624452 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: 
          COPY "test_idr"."main"."idr_attribute_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_attribute_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.624992 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.625421 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr.idr_sources"
[0m18:06:53.625863 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.626980 [debug] [Thread-2 (]: On seed.dbt_idr.idr_sources: COMMIT
[0m18:06:53.627402 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr.idr_survivorship_rules"
[0m18:06:53.627629 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:06:53.627831 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:06:53.628047 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:06:53.628466 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:06:53.628853 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:06:53.629099 [debug] [Thread-2 (]: On seed.dbt_idr.idr_sources: COMMIT
[0m18:06:53.630310 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: COMMIT
[0m18:06:53.631432 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: COMMIT
[0m18:06:53.631646 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:06:53.632526 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_exclusions: COMMIT
[0m18:06:53.632733 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:06:53.632933 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.633144 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: COMMIT
[0m18:06:53.633346 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:06:53.633544 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: COMMIT
[0m18:06:53.633923 [debug] [Thread-2 (]: On seed.dbt_idr.idr_sources: Close
[0m18:06:53.634175 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_exclusions: COMMIT
[0m18:06:53.634427 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:53.634719 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4d9fd0>]}
[0m18:06:53.634938 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.635328 [debug] [Thread-1 (]: On seed.dbt_idr.idr_survivorship_rules: Close
[0m18:06:53.635591 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.636168 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: Close
[0m18:06:53.635839 [info ] [Thread-2 (]: 5 of 15 OK loaded seed file main_idr_meta.idr_sources .......................... [[32mINSERT 3[0m in 0.03s]
[0m18:06:53.636595 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_exclusions: Close
[0m18:06:53.636851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4bcfb0>]}
[0m18:06:53.637150 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4bd3d0>]}
[0m18:06:53.637449 [debug] [Thread-2 (]: Finished running node seed.dbt_idr.idr_sources
[0m18:06:53.637693 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4bc9b0>]}
[0m18:06:53.637964 [info ] [Thread-1 (]: 6 of 15 OK loaded seed file main_idr_meta.idr_survivorship_rules ............... [[32mINSERT 5[0m in 0.04s]
[0m18:06:53.638438 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:06:53.638187 [info ] [Thread-3 (]: 7 of 15 OK loaded seed file main.idr_attribute_mappings ........................ [[32mINSERT 10[0m in 0.04s]
[0m18:06:53.639019 [debug] [Thread-1 (]: Finished running node seed.dbt_idr.idr_survivorship_rules
[0m18:06:53.638780 [info ] [Thread-4 (]: 8 of 15 OK loaded seed file main.idr_exclusions ................................ [[32mINSERT 2[0m in 0.04s]
[0m18:06:53.639361 [info ] [Thread-2 (]: 9 of 15 START seed file main.idr_identifier_mappings ........................... [RUN]
[0m18:06:53.639678 [debug] [Thread-3 (]: Finished running node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:06:53.639898 [debug] [Thread-1 (]: Began running node seed.dbt_idr_integration_tests.idr_rules
[0m18:06:53.640180 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:06:53.640398 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_sources, now seed.dbt_idr_integration_tests.idr_identifier_mappings)
[0m18:06:53.640622 [debug] [Thread-3 (]: Began running node seed.dbt_idr_integration_tests.idr_sources
[0m18:06:53.640942 [info ] [Thread-1 (]: 10 of 15 START seed file main.idr_rules ........................................ [RUN]
[0m18:06:53.641262 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:06:53.641548 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:06:53.642088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_survivorship_rules, now seed.dbt_idr_integration_tests.idr_rules)
[0m18:06:53.641870 [info ] [Thread-3 (]: 11 of 15 START seed file main.idr_sources ...................................... [RUN]
[0m18:06:53.642410 [info ] [Thread-4 (]: 12 of 15 START seed file main.idr_survivorship_rules ........................... [RUN]
[0m18:06:53.642665 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:06:53.642914 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr_integration_tests.idr_rules
[0m18:06:53.643236 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_attribute_mappings, now seed.dbt_idr_integration_tests.idr_sources)
[0m18:06:53.643488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_exclusions, now seed.dbt_idr_integration_tests.idr_survivorship_rules)
[0m18:06:53.644741 [debug] [Thread-1 (]: Began executing node seed.dbt_idr_integration_tests.idr_rules
[0m18:06:53.645420 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr_integration_tests.idr_sources
[0m18:06:53.645698 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:06:53.646427 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:06:53.648354 [debug] [Thread-3 (]: Began executing node seed.dbt_idr_integration_tests.idr_sources
[0m18:06:53.648629 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:06:53.649411 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:06:53.649652 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: BEGIN
[0m18:06:53.652741 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_rules: BEGIN
[0m18:06:53.653045 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:06:53.653888 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:06:53.654509 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:06:53.654726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:53.655099 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: BEGIN
[0m18:06:53.655335 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: BEGIN
[0m18:06:53.655605 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:06:53.655908 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:06:53.656153 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.656345 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:06:53.656552 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:06:53.656873 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:06:53.657107 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.657393 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_identifier_mappings"} */

    create table "test_idr"."main"."idr_identifier_mappings" ("source_id" text,"identifier_type" text,"column_name" text,"is_hashed" boolean,"description" text)
  
[0m18:06:53.657642 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_rules"} */

    create table "test_idr"."main"."idr_rules" ("rule_id" text,"identifier_type" text,"priority" integer,"is_active" boolean,"canonicalize" text,"max_group_size" integer,"description" text)
  
[0m18:06:53.657876 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:06:53.658454 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.658689 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_sources"} */

    create table "test_idr"."main"."idr_sources" ("source_id" text,"source_name" text,"database" integer,"schema" text,"table_name" text,"entity_key_column" text,"watermark_column" text,"is_active" boolean,"description" text)
  
[0m18:06:53.658951 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.659203 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:06:53.659477 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.660450 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:06:53.660683 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.660900 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_survivorship_rules"} */

    create table "test_idr"."main"."idr_survivorship_rules" ("attribute_name" text,"strategy" text,"source_priority_list" integer,"recency_field" text,"description" text)
  
[0m18:06:53.661567 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:06:53.661820 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_rules: 
          COPY "test_idr"."main"."idr_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.662652 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:06:53.663008 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: 
          COPY "test_idr"."main"."idr_identifier_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_identifier_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.663343 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: 
          COPY "test_idr"."main"."idr_sources" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_sources.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.663569 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.664430 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:06:53.664651 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: 
          COPY "test_idr"."main"."idr_survivorship_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_survivorship_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.665043 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.665449 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_rules"
[0m18:06:53.665704 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.666067 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:06:53.666350 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.666798 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_sources"
[0m18:06:53.667211 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.668260 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_rules: COMMIT
[0m18:06:53.669199 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: COMMIT
[0m18:06:53.669568 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:06:53.669836 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:06:53.670810 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: COMMIT
[0m18:06:53.671054 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:06:53.671325 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_rules: COMMIT
[0m18:06:53.671566 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:06:53.671781 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: COMMIT
[0m18:06:53.672716 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: COMMIT
[0m18:06:53.673014 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: COMMIT
[0m18:06:53.673301 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:53.673532 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:06:53.673744 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:06:53.674247 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_rules: Close
[0m18:06:53.674487 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: COMMIT
[0m18:06:53.674703 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.675091 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: Close
[0m18:06:53.675441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d392030>]}
[0m18:06:53.675813 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: Close
[0m18:06:53.676122 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3915b0>]}
[0m18:06:53.676398 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.676641 [info ] [Thread-1 (]: 10 of 15 OK loaded seed file main.idr_rules .................................... [[32mINSERT 3[0m in 0.03s]
[0m18:06:53.676942 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d391bb0>]}
[0m18:06:53.677555 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: Close
[0m18:06:53.677220 [info ] [Thread-2 (]: 9 of 15 OK loaded seed file main.idr_identifier_mappings ....................... [[32mINSERT 6[0m in 0.04s]
[0m18:06:53.677897 [debug] [Thread-1 (]: Finished running node seed.dbt_idr_integration_tests.idr_rules
[0m18:06:53.678375 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d392930>]}
[0m18:06:53.678160 [info ] [Thread-3 (]: 11 of 15 OK loaded seed file main.idr_sources .................................. [[32mINSERT 3[0m in 0.03s]
[0m18:06:53.678728 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:06:53.678985 [debug] [Thread-1 (]: Began running node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:06:53.679525 [debug] [Thread-3 (]: Finished running node seed.dbt_idr_integration_tests.idr_sources
[0m18:06:53.679291 [info ] [Thread-4 (]: 12 of 15 OK loaded seed file main.idr_survivorship_rules ....................... [[32mINSERT 4[0m in 0.03s]
[0m18:06:53.679801 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.sample_orders
[0m18:06:53.680262 [debug] [Thread-3 (]: Began running node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:06:53.680081 [info ] [Thread-1 (]: 13 of 15 START seed file main.sample_crm_customers ............................. [RUN]
[0m18:06:53.680613 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:06:53.680850 [info ] [Thread-2 (]: 14 of 15 START seed file main.sample_orders .................................... [RUN]
[0m18:06:53.681121 [info ] [Thread-3 (]: 15 of 15 START seed file main.sample_pos_transactions .......................... [RUN]
[0m18:06:53.681367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_rules, now seed.dbt_idr_integration_tests.sample_crm_customers)
[0m18:06:53.681621 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_identifier_mappings, now seed.dbt_idr_integration_tests.sample_orders)
[0m18:06:53.681836 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_sources, now seed.dbt_idr_integration_tests.sample_pos_transactions)
[0m18:06:53.682045 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:06:53.682245 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.sample_orders
[0m18:06:53.682460 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:06:53.682732 [debug] [Thread-1 (]: Began executing node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:06:53.682943 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.sample_orders
[0m18:06:53.683165 [debug] [Thread-3 (]: Began executing node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:06:53.688748 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:06:53.689113 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: BEGIN
[0m18:06:53.689774 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:06:53.690297 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:06:53.690547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:53.690796 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: BEGIN
[0m18:06:53.691000 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: BEGIN
[0m18:06:53.691339 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:06:53.691545 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:06:53.691929 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.692130 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:06:53.692331 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_crm_customers"} */

    create table "test_idr"."main"."sample_crm_customers" ("customer_id" varchar,"email" varchar,"phone" varchar,"first_name" varchar,"last_name" varchar,"loyalty_id" varchar,"updated_at" varchar)
  
[0m18:06:53.692652 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.692850 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:06:53.693046 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_orders"} */

    create table "test_idr"."main"."sample_orders" ("order_id" varchar,"customer_email" varchar,"contact_phone" varchar,"order_date" varchar)
  
[0m18:06:53.693253 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.693536 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:06:53.693737 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_pos_transactions"} */

    create table "test_idr"."main"."sample_pos_transactions" ("transaction_id" varchar,"loyalty_card_id" varchar,"contact_phone" varchar,"transaction_date" varchar)
  
[0m18:06:53.694016 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.694838 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:06:53.695052 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: 
          COPY "test_idr"."main"."sample_crm_customers" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_crm_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.695351 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.696036 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:06:53.696253 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: 
          COPY "test_idr"."main"."sample_orders" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.696461 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:06:53.697183 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:06:53.697404 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: 
          COPY "test_idr"."main"."sample_pos_transactions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_pos_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:06:53.697679 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.698075 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:06:53.698293 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:06:53.698705 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_orders"
[0m18:06:53.698969 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.699383 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:06:53.700459 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: COMMIT
[0m18:06:53.702611 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: COMMIT
[0m18:06:53.703399 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:06:53.703687 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:06:53.703926 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: COMMIT
[0m18:06:53.705035 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: COMMIT
[0m18:06:53.705302 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: COMMIT
[0m18:06:53.705737 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:06:53.706096 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:53.706405 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: COMMIT
[0m18:06:53.706633 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.707114 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: Close
[0m18:06:53.707609 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: Close
[0m18:06:53.707980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5c29f0>]}
[0m18:06:53.708224 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:53.708600 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da4ccb0>]}
[0m18:06:53.708981 [info ] [Thread-1 (]: 13 of 15 OK loaded seed file main.sample_crm_customers ......................... [[32mINSERT 10[0m in 0.03s]
[0m18:06:53.709488 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: Close
[0m18:06:53.709820 [info ] [Thread-2 (]: 14 of 15 OK loaded seed file main.sample_orders ................................ [[32mINSERT 10[0m in 0.03s]
[0m18:06:53.710297 [debug] [Thread-1 (]: Finished running node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:06:53.710700 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.sample_orders
[0m18:06:53.711017 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61b28f55-e8e7-4a7e-9ee6-792dc17385fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da4d790>]}
[0m18:06:53.711445 [info ] [Thread-3 (]: 15 of 15 OK loaded seed file main.sample_pos_transactions ...................... [[32mINSERT 10[0m in 0.03s]
[0m18:06:53.711850 [debug] [Thread-3 (]: Finished running node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:06:53.712827 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:53.713055 [debug] [MainThread]: On master: BEGIN
[0m18:06:53.713223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:53.713672 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:53.713876 [debug] [MainThread]: On master: COMMIT
[0m18:06:53.714061 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:53.714228 [debug] [MainThread]: On master: COMMIT
[0m18:06:53.714661 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:53.714871 [debug] [MainThread]: On master: Close
[0m18:06:53.715111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:53.715272 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_crm_customers' was properly closed.
[0m18:06:53.715415 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_orders' was properly closed.
[0m18:06:53.715553 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_pos_transactions' was properly closed.
[0m18:06:53.715694 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.idr_survivorship_rules' was properly closed.
[0m18:06:53.715874 [info ] [MainThread]: 
[0m18:06:53.716044 [info ] [MainThread]: Finished running 15 seeds in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m18:06:53.717437 [debug] [MainThread]: Command end result
[0m18:06:53.742717 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:06:53.744069 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:06:53.748318 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/run_results.json
[0m18:06:53.748535 [info ] [MainThread]: 
[0m18:06:53.748779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:53.748966 [info ] [MainThread]: 
[0m18:06:53.749169 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m18:06:53.750511 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.3014429, "process_in_blocks": "0", "process_kernel_time": 0.228552, "process_mem_max_rss": "167559168", "process_out_blocks": "0", "process_user_time": 1.896154}
[0m18:06:53.750766 [debug] [MainThread]: Command `dbt seed` succeeded at 18:06:53.750724 after 1.30 seconds
[0m18:06:53.750981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da4d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da4c950>]}
[0m18:06:53.751192 [debug] [MainThread]: Flushing usage events
[0m18:06:54.156727 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:55.324746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105314590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a7890>]}


============================== 18:06:55.327423 | 25d58696-a79a-4919-b274-f75aa787f750 ==============================
[0m18:06:55.327423 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:06:55.327904 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'quiet': 'False', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir .', 'partial_parse': 'True', 'empty': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'log_format': 'default', 'no_print': 'None', 'profiles_dir': '.', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'write_json': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False'}
[0m18:06:55.453789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25d58696-a79a-4919-b274-f75aa787f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bd810>]}
[0m18:06:55.488591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25d58696-a79a-4919-b274-f75aa787f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106447790>]}
[0m18:06:55.489698 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:06:55.559907 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:06:55.646219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:55.646508 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:06:55.646679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:55.683712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25d58696-a79a-4919-b274-f75aa787f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce0050>]}
[0m18:06:55.795497 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:06:55.796700 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:06:55.806605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25d58696-a79a-4919-b274-f75aa787f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a6e40>]}
[0m18:06:55.806902 [info ] [MainThread]: Found 35 data tests, 15 seeds, 11 models, 6 sources, 591 macros
[0m18:06:55.807122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25d58696-a79a-4919-b274-f75aa787f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a9c50>]}
[0m18:06:55.808716 [info ] [MainThread]: 
[0m18:06:55.808921 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:06:55.809094 [info ] [MainThread]: 
[0m18:06:55.809386 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:06:55.812284 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:06:55.820356 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:06:55.822127 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:06:55.839699 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:06:55.839979 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:06:55.840234 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:06:55.840440 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:06:55.840640 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:06:55.840840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:55.841013 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:06:55.841180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:55.841515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:55.849827 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:06:55.850077 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:06:55.850883 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:06:55.851558 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:06:55.851973 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:06:55.852691 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:06:55.853047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_staging)
[0m18:06:55.853331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_out)
[0m18:06:55.853558 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_work)
[0m18:06:55.853801 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_staging"
"
[0m18:06:55.854035 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_out"
"
[0m18:06:55.854255 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_work"
"
[0m18:06:55.858099 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m18:06:55.859361 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m18:06:55.860316 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m18:06:55.860505 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:06:55.860686 [debug] [ThreadPool]: On create_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_out"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:06:55.860858 [debug] [ThreadPool]: On create_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_work"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:06:55.861070 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:55.861256 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:55.861427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:55.862009 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:55.862259 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:55.862496 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:55.863248 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m18:06:55.863438 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: BEGIN
[0m18:06:55.864114 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m18:06:55.864303 [debug] [ThreadPool]: On create_test_idr_main_idr_out: BEGIN
[0m18:06:55.864537 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:55.864718 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m18:06:55.864910 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_staging"} */

    
    
        create schema if not exists "test_idr"."main_idr_staging"
    
[0m18:06:55.865791 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m18:06:55.866046 [debug] [ThreadPool]: On create_test_idr_main_idr_work: BEGIN
[0m18:06:55.866285 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:06:55.866491 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m18:06:55.866662 [debug] [ThreadPool]: On create_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_out"} */

    
    
        create schema if not exists "test_idr"."main_idr_out"
    
[0m18:06:55.866903 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:06:55.867444 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: COMMIT
[0m18:06:55.867631 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m18:06:55.867795 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: COMMIT
[0m18:06:55.868053 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:06:55.868221 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m18:06:55.868385 [debug] [ThreadPool]: On create_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_work"} */

    
    
        create schema if not exists "test_idr"."main_idr_work"
    
[0m18:06:55.868585 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:06:55.869105 [debug] [ThreadPool]: On create_test_idr_main_idr_out: COMMIT
[0m18:06:55.869316 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m18:06:55.869529 [debug] [ThreadPool]: On create_test_idr_main_idr_out: COMMIT
[0m18:06:55.869745 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:06:55.869937 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:55.870113 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: Close
[0m18:06:55.870303 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:55.870802 [debug] [ThreadPool]: On create_test_idr_main_idr_work: COMMIT
[0m18:06:55.871125 [debug] [ThreadPool]: On create_test_idr_main_idr_out: Close
[0m18:06:55.871313 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m18:06:55.871580 [debug] [ThreadPool]: On create_test_idr_main_idr_work: COMMIT
[0m18:06:55.871929 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:55.872093 [debug] [ThreadPool]: On create_test_idr_main_idr_work: Close
[0m18:06:55.873616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_work, now list_test_idr_main_idr_work)
[0m18:06:55.877197 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:06:55.877542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_staging, now list_test_idr_main_idr_staging)
[0m18:06:55.877743 [debug] [ThreadPool]: On list_test_idr_main_idr_work: BEGIN
[0m18:06:55.878124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_out, now list_test_idr_main_idr_meta)
[0m18:06:55.878459 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main'
[0m18:06:55.879608 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:06:55.879806 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:55.881001 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:06:55.882020 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:06:55.882217 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: BEGIN
[0m18:06:55.882513 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: BEGIN
[0m18:06:55.882687 [debug] [ThreadPool]: On list_test_idr_main: BEGIN
[0m18:06:55.882865 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:06:55.883025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:55.883192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:55.883348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:55.883511 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:06:55.883866 [debug] [ThreadPool]: On list_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_work"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_work'
    and lower(table_catalog) = 'test_idr'
  
[0m18:06:55.884052 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:55.884295 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:55.884454 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:06:55.884625 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:06:55.884792 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:06:55.884964 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:06:55.885144 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_staging"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_staging'
    and lower(table_catalog) = 'test_idr'
  
[0m18:06:55.885341 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_meta"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_meta'
    and lower(table_catalog) = 'test_idr'
  
[0m18:06:55.885533 [debug] [ThreadPool]: On list_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'test_idr'
  
[0m18:06:55.891872 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m18:06:55.892188 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m18:06:55.893045 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: ROLLBACK
[0m18:06:55.893828 [debug] [ThreadPool]: On list_test_idr_main: ROLLBACK
[0m18:06:55.894029 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:06:55.894254 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:06:55.894991 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_staging'
[0m18:06:55.895179 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: Close
[0m18:06:55.895811 [debug] [ThreadPool]: On list_test_idr_main_idr_work: ROLLBACK
[0m18:06:55.896498 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: ROLLBACK
[0m18:06:55.896872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_staging, now list_test_idr_main_idr_out)
[0m18:06:55.897177 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_work'
[0m18:06:55.897427 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main'
[0m18:06:55.897662 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_meta'
[0m18:06:55.898713 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:06:55.898889 [debug] [ThreadPool]: On list_test_idr_main_idr_work: Close
[0m18:06:55.899052 [debug] [ThreadPool]: On list_test_idr_main: Close
[0m18:06:55.899213 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: Close
[0m18:06:55.899375 [debug] [ThreadPool]: On list_test_idr_main_idr_out: BEGIN
[0m18:06:55.903087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:06:55.903454 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:06:55.903628 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:06:55.903806 [debug] [ThreadPool]: On list_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_out"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_out'
    and lower(table_catalog) = 'test_idr'
  
[0m18:06:55.905697 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:06:55.906446 [debug] [ThreadPool]: On list_test_idr_main_idr_out: ROLLBACK
[0m18:06:55.906769 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_out'
[0m18:06:55.906937 [debug] [ThreadPool]: On list_test_idr_main_idr_out: Close
[0m18:06:55.907318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25d58696-a79a-4919-b274-f75aa787f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a67520>]}
[0m18:06:55.907623 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:55.907799 [debug] [MainThread]: On master: BEGIN
[0m18:06:55.907962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:55.908309 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:55.908477 [debug] [MainThread]: On master: COMMIT
[0m18:06:55.908635 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:55.908784 [debug] [MainThread]: On master: COMMIT
[0m18:06:55.909015 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:55.909176 [debug] [MainThread]: On master: Close
[0m18:06:55.910366 [debug] [Thread-1 (]: Began running node model.dbt_idr.stg_identifiers
[0m18:06:55.910674 [info ] [Thread-1 (]: 1 of 11 START sql table model main_idr_staging.stg_identifiers ................. [RUN]
[0m18:06:55.910924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_work, now model.dbt_idr.stg_identifiers)
[0m18:06:55.911233 [debug] [Thread-1 (]: Began compiling node model.dbt_idr.stg_identifiers
[0m18:06:55.924469 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:06:55.924787 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

    
    select * from "test_idr"."main"."idr_sources" where is_active = true

  
[0m18:06:55.924996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:06:55.926441 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:55.927483 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:06:55.927762 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

    
    select 
        m.*,
        r.canonicalize,
        r.priority,
        coalesce(r.max_group_size, 1000) as max_group_size
    from "test_idr"."main"."idr_identifier_mappings" m
    inner join "test_idr"."main"."idr_rules" r on m.identifier_type = r.identifier_type
    where r.is_active = true

  
[0m18:06:55.932350 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:06:55.936990 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idr.stg_identifiers"
[0m18:06:55.937563 [debug] [Thread-1 (]: Began executing node model.dbt_idr.stg_identifiers
[0m18:06:55.957168 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idr.stg_identifiers"
[0m18:06:55.958084 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:06:55.958343 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: BEGIN
[0m18:06:55.958698 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:55.958896 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:06:55.959220 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

  
    
    

    create  table
      "test_idr"."main_idr_staging"."stg_identifiers__dbt_tmp"
  
    as (
      









    
    
    
    
    






    
    
    
    
    
    
    
        
    
    
    
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
    
        
    
        
    
        
    

    
    
    
    
    
    
    
        
    
    
    
    
        
    
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
    
        
    

    
    
    
    
    
    
    
        
    
    
    
    
        
    
        
    
        
    
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    



with raw_identifiers as (
    
        
select
    'crm' as source_id,
    concat('crm', ':', cast(customer_id as TEXT)) as entity_key,
    'EMAIL' as identifier_type,
    cast(email as TEXT) as identifier_value_raw,
    cast(lower(email) as TEXT) as identifier_value_norm,
    False as is_hashed,
    1 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_crm_customers
where email is not null
            
union all

select
    'crm' as source_id,
    concat('crm', ':', cast(customer_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(phone as TEXT) as identifier_value_raw,
    cast(phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_crm_customers
where phone is not null
            
union all

select
    'orders' as source_id,
    concat('orders', ':', cast(order_id as TEXT)) as entity_key,
    'EMAIL' as identifier_type,
    cast(customer_email as TEXT) as identifier_value_raw,
    cast(lower(customer_email) as TEXT) as identifier_value_norm,
    False as is_hashed,
    1 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_orders
where customer_email is not null
            
union all

select
    'orders' as source_id,
    concat('orders', ':', cast(order_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(contact_phone as TEXT) as identifier_value_raw,
    cast(contact_phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_orders
where contact_phone is not null
            
union all

select
    'pos' as source_id,
    concat('pos', ':', cast(transaction_id as TEXT)) as entity_key,
    'LOYALTY' as identifier_type,
    cast(loyalty_card_id as TEXT) as identifier_value_raw,
    cast(loyalty_card_id as TEXT) as identifier_value_norm,
    False as is_hashed,
    3 as priority,
    10 as max_group_size,
    current_timestamp as extracted_at
from main.sample_pos_transactions
where loyalty_card_id is not null
            
union all

select
    'pos' as source_id,
    concat('pos', ':', cast(transaction_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(contact_phone as TEXT) as identifier_value_raw,
    cast(contact_phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_pos_transactions
where contact_phone is not null
            
    
),

exclusions as (
    select identifier_type, identifier_value_pattern, match_type
    from "test_idr"."main"."idr_exclusions"
),


filtered_identifiers as (
    select r.*
    from raw_identifiers r
    where not exists (
        select 1 from exclusions e
        where e.identifier_type = r.identifier_type
          and (
            (e.match_type = 'EXACT' and r.identifier_value_norm = e.identifier_value_pattern)
            or (e.match_type = 'LIKE' and r.identifier_value_norm like e.identifier_value_pattern)
          )
    )
)

select * from filtered_identifiers
    );
  
  
[0m18:06:55.965368 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:06:55.968987 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:06:55.969212 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */
alter table "test_idr"."main_idr_staging"."stg_identifiers__dbt_tmp" rename to "stg_identifiers"
[0m18:06:55.970186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:06:55.978698 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: COMMIT
[0m18:06:55.978951 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:06:55.979146 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: COMMIT
[0m18:06:55.979675 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:55.983292 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:06:55.983555 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

      drop table if exists "test_idr"."main_idr_staging"."stg_identifiers__dbt_backup" cascade
    
[0m18:06:55.983942 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:06:55.985339 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: Close
[0m18:06:55.986355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25d58696-a79a-4919-b274-f75aa787f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107816090>]}
[0m18:06:55.986759 [info ] [Thread-1 (]: 1 of 11 OK created sql table model main_idr_staging.stg_identifiers ............ [[32mOK[0m in 0.07s]
[0m18:06:55.987105 [debug] [Thread-1 (]: Finished running node model.dbt_idr.stg_identifiers
[0m18:06:55.987578 [debug] [Thread-3 (]: Began running node model.dbt_idr.skipped_identifier_groups
[0m18:06:55.987806 [debug] [Thread-2 (]: Began running node model.dbt_idr.int_edges
[0m18:06:55.988072 [info ] [Thread-3 (]: 3 of 11 START sql table model main_idr_out.skipped_identifier_groups ........... [RUN]
[0m18:06:55.988364 [info ] [Thread-2 (]: 2 of 11 START sql table model main_idr_work.int_edges .......................... [RUN]
[0m18:06:55.988619 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_meta, now model.dbt_idr.skipped_identifier_groups)
[0m18:06:55.988851 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_out, now model.dbt_idr.int_edges)
[0m18:06:55.989059 [debug] [Thread-3 (]: Began compiling node model.dbt_idr.skipped_identifier_groups
[0m18:06:55.989258 [debug] [Thread-2 (]: Began compiling node model.dbt_idr.int_edges
[0m18:06:55.991117 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_idr.skipped_identifier_groups"
[0m18:06:55.993300 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_idr.int_edges"
[0m18:06:55.993961 [debug] [Thread-2 (]: Began executing node model.dbt_idr.int_edges
[0m18:06:55.995790 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_idr.int_edges"
[0m18:06:55.996085 [debug] [Thread-3 (]: Began executing node model.dbt_idr.skipped_identifier_groups
[0m18:06:55.997982 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_idr.skipped_identifier_groups"
[0m18:06:55.998378 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m18:06:55.998648 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: BEGIN
[0m18:06:55.998870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:06:55.999131 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m18:06:55.999481 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: BEGIN
[0m18:06:55.999697 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:06:55.999907 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:06:56.000168 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m18:06:56.000408 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_edges"} */

  
    
    

    create  table
      "test_idr"."main_idr_work"."int_edges__dbt_tmp"
  
    as (
      



with identifier_groups as (
    -- Count entities per identifier value
    select
        identifier_type,
        identifier_value_norm,
        max_group_size,
        count(*) as group_size,
        min(entity_key) as anchor_entity_key
    from "test_idr"."main_idr_staging"."stg_identifiers"
    where identifier_value_norm is not null
    group by identifier_type, identifier_value_norm, max_group_size
),

valid_groups as (
    -- Filter out oversized groups
    select
        identifier_type,
        identifier_value_norm,
        anchor_entity_key
    from identifier_groups
    where group_size <= max_group_size
),

edges as (
    -- Create edges from each entity to the anchor
    select distinct
        vg.anchor_entity_key as left_entity_key,
        i.entity_key as right_entity_key,
        vg.identifier_type,
        vg.identifier_value_norm,
        current_timestamp as created_at
    from valid_groups vg
    inner join "test_idr"."main_idr_staging"."stg_identifiers" i
        on i.identifier_type = vg.identifier_type
        and i.identifier_value_norm = vg.identifier_value_norm
    where i.entity_key != vg.anchor_entity_key
)

select * from edges
    );
  
  
[0m18:06:56.000699 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:56.001152 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m18:06:56.001410 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.skipped_identifier_groups"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."skipped_identifier_groups__dbt_tmp"
  
    as (
      



with identifier_groups as (
    select
        identifier_type,
        identifier_value_norm,
        max_group_size,
        count(*) as group_size,
        min(entity_key) as sample_entity_key
    from "test_idr"."main_idr_staging"."stg_identifiers"
    where identifier_value_norm is not null
    group by identifier_type, identifier_value_norm, max_group_size
),

skipped_groups as (
    select
        '25d58696-a79a-4919-b274-f75aa787f750' as run_id,
        identifier_type,
        identifier_value_norm,
        group_size,
        max_group_size as max_allowed,
        sample_entity_key,
        'EXCEEDED_MAX_GROUP_SIZE' as reason,
        current_timestamp as skipped_at
    from identifier_groups
    where group_size > max_group_size
)

select * from skipped_groups
    );
  
  
[0m18:06:56.004046 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:06:56.005987 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m18:06:56.006240 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.skipped_identifier_groups"} */
alter table "test_idr"."main_idr_out"."skipped_identifier_groups__dbt_tmp" rename to "skipped_identifier_groups"
[0m18:06:56.006642 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m18:06:56.008490 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m18:06:56.008749 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:06:56.009005 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_edges"} */
alter table "test_idr"."main_idr_work"."int_edges__dbt_tmp" rename to "int_edges"
[0m18:06:56.010077 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: COMMIT
[0m18:06:56.010398 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m18:06:56.010613 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: COMMIT
[0m18:06:56.010817 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:06:56.011760 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: COMMIT
[0m18:06:56.011977 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m18:06:56.012182 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:56.012380 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: COMMIT
[0m18:06:56.013669 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m18:06:56.013948 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.skipped_identifier_groups"} */

      drop table if exists "test_idr"."main_idr_out"."skipped_identifier_groups__dbt_backup" cascade
    
[0m18:06:56.014203 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:06:56.015618 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m18:06:56.015837 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_edges"} */

      drop table if exists "test_idr"."main_idr_work"."int_edges__dbt_backup" cascade
    
[0m18:06:56.016047 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:06:56.016811 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: Close
[0m18:06:56.017141 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25d58696-a79a-4919-b274-f75aa787f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107807e30>]}
[0m18:06:56.017404 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:06:56.017716 [info ] [Thread-3 (]: 3 of 11 OK created sql table model main_idr_out.skipped_identifier_groups ...... [[32mOK[0m in 0.03s]
[0m18:06:56.018465 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: Close
[0m18:06:56.018773 [debug] [Thread-3 (]: Finished running node model.dbt_idr.skipped_identifier_groups
[0m18:06:56.019061 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25d58696-a79a-4919-b274-f75aa787f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6e850>]}
[0m18:06:56.019448 [info ] [Thread-2 (]: 2 of 11 OK created sql table model main_idr_work.int_edges ..................... [[32mOK[0m in 0.03s]
[0m18:06:56.019759 [debug] [Thread-2 (]: Finished running node model.dbt_idr.int_edges
[0m18:06:56.020154 [debug] [Thread-3 (]: Began running node model.dbt_idr.rule_match_audit
[0m18:06:56.020369 [debug] [Thread-1 (]: Began running node model.dbt_idr.int_labels
[0m18:06:56.020592 [debug] [Thread-4 (]: Began running node model.dbt_idr.identity_edges
[0m18:06:56.020831 [info ] [Thread-3 (]: 6 of 11 START sql table model main_idr_out.rule_match_audit .................... [RUN]
[0m18:06:56.021054 [info ] [Thread-1 (]: 5 of 11 START sql table model main_idr_work.int_labels ......................... [RUN]
[0m18:06:56.021386 [info ] [Thread-4 (]: 4 of 11 START sql table model main_idr_out.identity_edges ...................... [RUN]
[0m18:06:56.021642 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_idr.skipped_identifier_groups, now model.dbt_idr.rule_match_audit)
[0m18:06:56.021878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idr.stg_identifiers, now model.dbt_idr.int_labels)
[0m18:06:56.022098 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_test_idr_main, now model.dbt_idr.identity_edges)
[0m18:06:56.022320 [debug] [Thread-3 (]: Began compiling node model.dbt_idr.rule_match_audit
[0m18:06:56.022520 [debug] [Thread-1 (]: Began compiling node model.dbt_idr.int_labels
[0m18:06:56.022722 [debug] [Thread-4 (]: Began compiling node model.dbt_idr.identity_edges
[0m18:06:56.024729 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_idr.rule_match_audit"
[0m18:06:56.027303 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idr.int_labels"
[0m18:06:56.029292 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_idr.identity_edges"
[0m18:06:56.029924 [debug] [Thread-3 (]: Began executing node model.dbt_idr.rule_match_audit
[0m18:06:56.031754 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_idr.rule_match_audit"
[0m18:06:56.032013 [debug] [Thread-1 (]: Began executing node model.dbt_idr.int_labels
[0m18:06:56.034335 [debug] [Thread-4 (]: Began executing node model.dbt_idr.identity_edges
[0m18:06:56.036367 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_idr.identity_edges"
[0m18:06:56.036811 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m18:06:56.037907 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: BEGIN
[0m18:06:56.038224 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m18:06:56.038435 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:06:56.038691 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: BEGIN
[0m18:06:56.039048 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:06:56.039334 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:56.039630 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m18:06:56.039862 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:06:56.040081 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.rule_match_audit"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."rule_match_audit__dbt_tmp"
  
    as (
      



select
    '25d58696-a79a-4919-b274-f75aa787f750' as run_id,
    'rule_' || identifier_type as rule_id,
    count(*) as edges_created,
    min(created_at) as started_at,
    max(created_at) as ended_at
from "test_idr"."main_idr_work"."int_edges"
group by identifier_type
    );
  
  
[0m18:06:56.040359 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m18:06:56.040702 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_edges"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."identity_edges__dbt_tmp"
  
    as (
      



select
    'rule_' || identifier_type as rule_id,
    left_entity_key,
    right_entity_key,
    identifier_type,
    identifier_value_norm,
    created_at as first_seen_ts,
    created_at as last_seen_ts
from "test_idr"."main_idr_work"."int_edges"
    );
  
  
[0m18:06:56.041616 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:06:56.043477 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m18:06:56.043734 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_edges"} */
alter table "test_idr"."main_idr_out"."identity_edges__dbt_tmp" rename to "identity_edges"
[0m18:06:56.044057 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:06:56.045628 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m18:06:56.046045 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:06:56.046264 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.rule_match_audit"} */
alter table "test_idr"."main_idr_out"."rule_match_audit__dbt_tmp" rename to "rule_match_audit"
[0m18:06:56.047238 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: COMMIT
[0m18:06:56.047579 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m18:06:56.047784 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: COMMIT
[0m18:06:56.048001 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:56.049062 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: COMMIT
[0m18:06:56.049299 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m18:06:56.049619 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: COMMIT
[0m18:06:56.049883 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:06:56.051261 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m18:06:56.051486 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_edges"} */

      drop table if exists "test_idr"."main_idr_out"."identity_edges__dbt_backup" cascade
    
[0m18:06:56.051705 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:06:56.055694 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m18:06:56.055956 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.rule_match_audit"} */

      drop table if exists "test_idr"."main_idr_out"."rule_match_audit__dbt_backup" cascade
    
[0m18:06:56.056237 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:06:56.057053 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: Close
[0m18:06:56.057277 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:06:56.057634 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25d58696-a79a-4919-b274-f75aa787f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109a7c50>]}
[0m18:06:56.058346 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: Close
[0m18:06:56.058844 [info ] [Thread-4 (]: 4 of 11 OK created sql table model main_idr_out.identity_edges ................. [[32mOK[0m in 0.04s]
[0m18:06:56.059221 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25d58696-a79a-4919-b274-f75aa787f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11097eeb0>]}
[0m18:06:56.059529 [debug] [Thread-4 (]: Finished running node model.dbt_idr.identity_edges
[0m18:06:56.059899 [info ] [Thread-3 (]: 6 of 11 OK created sql table model main_idr_out.rule_match_audit ............... [[32mOK[0m in 0.04s]
[0m18:06:56.060326 [debug] [Thread-3 (]: Finished running node model.dbt_idr.rule_match_audit
[0m18:06:56.062849 [debug] [Thread-1 (]: Compilation Error in model int_labels (models/intermediate/int_labels.sql)
  'run_label_propagation_inline' is undefined
  
  > in macro run_hooks (macros/materializations/hooks.sql)
  > called by macro materialization_table_duckdb (macros/materializations/table.sql)
  > called by model int_labels (models/intermediate/int_labels.sql). This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:06:56.063138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25d58696-a79a-4919-b274-f75aa787f750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110904050>]}
[0m18:06:56.063484 [error] [Thread-1 (]: 5 of 11 ERROR creating sql table model main_idr_work.int_labels ................ [[31mERROR[0m in 0.04s]
[0m18:06:56.063879 [debug] [Thread-1 (]: Finished running node model.dbt_idr.int_labels
[0m18:06:56.064192 [debug] [Thread-7 (]: Marking all children of 'model.dbt_idr.int_labels' to be skipped because of status 'error'.  Reason: Compilation Error in model int_labels (models/intermediate/int_labels.sql)
  'run_label_propagation_inline' is undefined
  
  > in macro run_hooks (macros/materializations/hooks.sql)
  > called by macro materialization_table_duckdb (macros/materializations/table.sql)
  > called by model int_labels (models/intermediate/int_labels.sql). This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m18:06:56.064948 [debug] [Thread-2 (]: Began running node model.dbt_idr.identity_membership
[0m18:06:56.065275 [info ] [Thread-2 (]: 7 of 11 SKIP relation main_idr_out.identity_membership ......................... [[33mSKIP[0m]
[0m18:06:56.065551 [debug] [Thread-2 (]: Finished running node model.dbt_idr.identity_membership
[0m18:06:56.065920 [debug] [Thread-3 (]: Began running node model.dbt_idr.identity_clusters
[0m18:06:56.066188 [debug] [Thread-4 (]: Began running node model.dbt_idr.golden_profiles
[0m18:06:56.066427 [info ] [Thread-3 (]: 9 of 11 SKIP relation main_idr_out.identity_clusters ........................... [[33mSKIP[0m]
[0m18:06:56.066896 [debug] [Thread-3 (]: Finished running node model.dbt_idr.identity_clusters
[0m18:06:56.066699 [info ] [Thread-4 (]: 8 of 11 SKIP relation main_idr_out.golden_profiles ............................. [[33mSKIP[0m]
[0m18:06:56.067216 [debug] [Thread-4 (]: Finished running node model.dbt_idr.golden_profiles
[0m18:06:56.067502 [debug] [Thread-1 (]: Began running node model.dbt_idr.run_history
[0m18:06:56.067957 [debug] [Thread-2 (]: Began running node model.dbt_idr.stage_metrics
[0m18:06:56.067772 [info ] [Thread-1 (]: 10 of 11 SKIP relation main_idr_out.run_history ................................ [[33mSKIP[0m]
[0m18:06:56.068268 [info ] [Thread-2 (]: 11 of 11 SKIP relation main_idr_out.stage_metrics .............................. [[33mSKIP[0m]
[0m18:06:56.068526 [debug] [Thread-1 (]: Finished running node model.dbt_idr.run_history
[0m18:06:56.068741 [debug] [Thread-2 (]: Finished running node model.dbt_idr.stage_metrics
[0m18:06:56.069411 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:56.069589 [debug] [MainThread]: On master: BEGIN
[0m18:06:56.069744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:06:56.070160 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:56.070340 [debug] [MainThread]: On master: COMMIT
[0m18:06:56.070497 [debug] [MainThread]: Using duckdb connection "master"
[0m18:06:56.070650 [debug] [MainThread]: On master: COMMIT
[0m18:06:56.070983 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:06:56.071157 [debug] [MainThread]: On master: Close
[0m18:06:56.071373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:56.071531 [debug] [MainThread]: Connection 'model.dbt_idr.int_labels' was properly closed.
[0m18:06:56.071675 [debug] [MainThread]: Connection 'model.dbt_idr.int_edges' was properly closed.
[0m18:06:56.071818 [debug] [MainThread]: Connection 'model.dbt_idr.rule_match_audit' was properly closed.
[0m18:06:56.071967 [debug] [MainThread]: Connection 'model.dbt_idr.identity_edges' was properly closed.
[0m18:06:56.072195 [info ] [MainThread]: 
[0m18:06:56.072412 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m18:06:56.073189 [debug] [MainThread]: Command end result
[0m18:06:56.097184 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:06:56.098493 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:06:56.102151 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/run_results.json
[0m18:06:56.102382 [info ] [MainThread]: 
[0m18:06:56.102602 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:06:56.102788 [info ] [MainThread]: 
[0m18:06:56.103011 [error] [MainThread]: [31mFailure in model int_labels (models/intermediate/int_labels.sql)[0m
[0m18:06:56.103233 [error] [MainThread]:   Compilation Error in model int_labels (models/intermediate/int_labels.sql)
  'run_label_propagation_inline' is undefined
  
  > in macro run_hooks (macros/materializations/hooks.sql)
  > called by macro materialization_table_duckdb (macros/materializations/table.sql)
  > called by model int_labels (models/intermediate/int_labels.sql). This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:06:56.103413 [info ] [MainThread]: 
[0m18:06:56.103606 [info ] [MainThread]:   compiled code at target/compiled/dbt_idr/models/intermediate/int_labels.sql
[0m18:06:56.103775 [info ] [MainThread]: 
[0m18:06:56.103966 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=5 NO-OP=0 TOTAL=11
[0m18:06:56.105334 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8211327, "process_in_blocks": "0", "process_kernel_time": 0.162432, "process_mem_max_rss": "169164800", "process_out_blocks": "0", "process_user_time": 1.498338}
[0m18:06:56.105584 [debug] [MainThread]: Command `dbt run` failed at 18:06:56.105542 after 0.82 seconds
[0m18:06:56.105801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ba5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110977bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110977b30>]}
[0m18:06:56.106004 [debug] [MainThread]: Flushing usage events
[0m18:06:56.497224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:56.912008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cec590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7f890>]}


============================== 18:07:56.915353 | 8146065c-b2a3-4856-9996-0d702bd19afb ==============================
[0m18:07:56.915353 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:07:56.915752 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'debug': 'False', 'profiles_dir': '.', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'printer_width': '80', 'fail_fast': 'False', 'empty': 'None', 'no_print': 'None', 'version_check': 'True', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'use_experimental_parser': 'False', 'invocation_command': 'dbt deps --profiles-dir .', 'target_path': 'None'}
[0m18:07:56.990956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8146065c-b2a3-4856-9996-0d702bd19afb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e95810>]}
[0m18:07:57.024562 [debug] [MainThread]: Set downloads directory='/var/folders/pt/f4g5v3rd52xd_n4yxjprb57h0000gn/T/dbt-downloads-srszcjkz'
[0m18:07:57.024893 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:07:57.072392 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:07:57.073464 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:07:57.109271 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:07:57.112941 [info ] [MainThread]: Installing ../
[0m18:07:57.115595 [debug] [MainThread]: Creating symlink to local dependency.
[0m18:07:57.115936 [info ] [MainThread]: Installed from <local @ ../>
[0m18:07:57.116188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8146065c-b2a3-4856-9996-0d702bd19afb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a1ee00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a1ead0>]}
[0m18:07:57.116436 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:07:57.315960 [info ] [MainThread]: Installed from version 1.3.3
[0m18:07:57.316295 [info ] [MainThread]: Up to date!
[0m18:07:57.316566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8146065c-b2a3-4856-9996-0d702bd19afb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d3b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2bd40>]}
[0m18:07:57.319022 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.4520792, "process_in_blocks": "0", "process_kernel_time": 0.172433, "process_mem_max_rss": "117129216", "process_out_blocks": "0", "process_user_time": 0.895583}
[0m18:07:57.319389 [debug] [MainThread]: Command `dbt deps` succeeded at 18:07:57.319324 after 0.45 seconds
[0m18:07:57.319615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f7e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc9b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d86dd0>]}
[0m18:07:57.319841 [debug] [MainThread]: Flushing usage events
[0m18:07:57.629739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:58.846114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a7890>]}


============================== 18:07:58.848977 | 9344b40d-400e-4dbc-9c4b-e291b9e42104 ==============================
[0m18:07:58.848977 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:07:58.849362 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'no_print': 'None', 'warn_error': 'None', 'target_path': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'quiet': 'False', 'debug': 'False', 'profiles_dir': '.', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt seed --profiles-dir .', 'introspect': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'empty': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'partial_parse': 'True'}
[0m18:07:59.053892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638d810>]}
[0m18:07:59.088822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107447790>]}
[0m18:07:59.090750 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:07:59.161257 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:07:59.255444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:07:59.256023 [debug] [MainThread]: Partial parsing: updated file: dbt_idr://models/intermediate/int_labels.sql
[0m18:07:59.547341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104dc050>]}
[0m18:07:59.626298 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:07:59.627929 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:07:59.641045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105d6300>]}
[0m18:07:59.641367 [info ] [MainThread]: Found 35 data tests, 15 seeds, 11 models, 6 sources, 591 macros
[0m18:07:59.641587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ab6430>]}
[0m18:07:59.643397 [info ] [MainThread]: 
[0m18:07:59.643619 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:07:59.643798 [info ] [MainThread]: 
[0m18:07:59.644118 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:07:59.647853 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:07:59.654914 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:07:59.680518 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:07:59.680804 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:07:59.681014 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:07:59.681218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:59.681422 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:07:59.681677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:59.698923 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m18:07:59.699205 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m18:07:59.700367 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:07:59.701086 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:07:59.701530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main)
[0m18:07:59.701769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_meta)
[0m18:07:59.702030 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main"
"
[0m18:07:59.702278 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_meta"
"
[0m18:07:59.706398 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:07:59.709254 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:07:59.709523 [debug] [ThreadPool]: On create_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:07:59.709767 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_meta"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:07:59.709979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:59.710303 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:59.711433 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:59.711635 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:07:59.712412 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:07:59.712610 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: BEGIN
[0m18:07:59.713279 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:07:59.713510 [debug] [ThreadPool]: On create_test_idr_main: BEGIN
[0m18:07:59.713730 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:59.713919 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:07:59.714090 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:59.714275 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_meta"} */

    
    
        create schema if not exists "test_idr"."main_idr_meta"
    
[0m18:07:59.714466 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:07:59.714714 [debug] [ThreadPool]: On create_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main"} */

    
    
        create schema if not exists "test_idr"."main"
    
[0m18:07:59.715058 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:59.715234 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:59.715714 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: COMMIT
[0m18:07:59.716191 [debug] [ThreadPool]: On create_test_idr_main: COMMIT
[0m18:07:59.716378 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m18:07:59.716566 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m18:07:59.716747 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: COMMIT
[0m18:07:59.716936 [debug] [ThreadPool]: On create_test_idr_main: COMMIT
[0m18:07:59.717329 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:59.717582 [debug] [ThreadPool]: On create_test_idr_main: Close
[0m18:07:59.717773 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:59.718115 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: Close
[0m18:07:59.719609 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main, now list_test_idr_main)
[0m18:07:59.722847 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:07:59.723103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_meta, now list_test_idr_main_idr_staging)
[0m18:07:59.723363 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_meta'
[0m18:07:59.723538 [debug] [ThreadPool]: On list_test_idr_main: BEGIN
[0m18:07:59.723805 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_work'
[0m18:07:59.725031 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:07:59.726044 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:07:59.726231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:59.727420 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:07:59.727655 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: BEGIN
[0m18:07:59.727916 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: BEGIN
[0m18:07:59.728236 [debug] [ThreadPool]: On list_test_idr_main_idr_work: BEGIN
[0m18:07:59.728431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:59.728619 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:07:59.728814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:59.728997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:07:59.729629 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:59.729831 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:07:59.730153 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:07:59.730486 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:07:59.730716 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:07:59.730935 [debug] [ThreadPool]: On list_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'test_idr'
  
[0m18:07:59.731141 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:07:59.731342 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_staging"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_staging'
    and lower(table_catalog) = 'test_idr'
  
[0m18:07:59.731533 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:07:59.731829 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_meta"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_meta'
    and lower(table_catalog) = 'test_idr'
  
[0m18:07:59.732137 [debug] [ThreadPool]: On list_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_work"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_work'
    and lower(table_catalog) = 'test_idr'
  
[0m18:07:59.742213 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:07:59.742448 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m18:07:59.742689 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:07:59.743648 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: ROLLBACK
[0m18:07:59.743840 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m18:07:59.744586 [debug] [ThreadPool]: On list_test_idr_main_idr_work: ROLLBACK
[0m18:07:59.745264 [debug] [ThreadPool]: On list_test_idr_main: ROLLBACK
[0m18:07:59.745998 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: ROLLBACK
[0m18:07:59.746677 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_work'
[0m18:07:59.746869 [debug] [ThreadPool]: On list_test_idr_main_idr_work: Close
[0m18:07:59.747154 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_meta'
[0m18:07:59.747467 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main'
[0m18:07:59.747760 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_staging'
[0m18:07:59.747949 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: Close
[0m18:07:59.748236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_work, now list_test_idr_main_idr_out)
[0m18:07:59.748441 [debug] [ThreadPool]: On list_test_idr_main: Close
[0m18:07:59.748616 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: Close
[0m18:07:59.749785 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:07:59.750114 [debug] [ThreadPool]: On list_test_idr_main_idr_out: BEGIN
[0m18:07:59.750300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:07:59.750661 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:07:59.750858 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:07:59.751049 [debug] [ThreadPool]: On list_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_out"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_out'
    and lower(table_catalog) = 'test_idr'
  
[0m18:07:59.753061 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:07:59.753774 [debug] [ThreadPool]: On list_test_idr_main_idr_out: ROLLBACK
[0m18:07:59.754057 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_out'
[0m18:07:59.754216 [debug] [ThreadPool]: On list_test_idr_main_idr_out: Close
[0m18:07:59.754652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d3eb60>]}
[0m18:07:59.754940 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:59.755111 [debug] [MainThread]: On master: BEGIN
[0m18:07:59.755273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:07:59.755595 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:59.755778 [debug] [MainThread]: On master: COMMIT
[0m18:07:59.755947 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:59.756108 [debug] [MainThread]: On master: COMMIT
[0m18:07:59.756399 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:59.756606 [debug] [MainThread]: On master: Close
[0m18:07:59.758243 [debug] [Thread-3 (]: Began running node seed.dbt_idr.idr_identifier_mappings
[0m18:07:59.758469 [debug] [Thread-4 (]: Began running node seed.dbt_idr.idr_rules
[0m18:07:59.758672 [debug] [Thread-1 (]: Began running node seed.dbt_idr.idr_attribute_mappings
[0m18:07:59.758885 [debug] [Thread-2 (]: Began running node seed.dbt_idr.idr_exclusions
[0m18:07:59.759174 [info ] [Thread-3 (]: 3 of 15 START seed file main_idr_meta.idr_identifier_mappings .................. [RUN]
[0m18:07:59.759486 [info ] [Thread-4 (]: 4 of 15 START seed file main_idr_meta.idr_rules ................................ [RUN]
[0m18:07:59.759845 [info ] [Thread-1 (]: 1 of 15 START seed file main_idr_meta.idr_attribute_mappings ................... [RUN]
[0m18:07:59.760220 [info ] [Thread-2 (]: 2 of 15 START seed file main_idr_meta.idr_exclusions ........................... [RUN]
[0m18:07:59.760509 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_meta, now seed.dbt_idr.idr_identifier_mappings)
[0m18:07:59.760747 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_out, now seed.dbt_idr.idr_rules)
[0m18:07:59.760978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_idr_main, now seed.dbt_idr.idr_attribute_mappings)
[0m18:07:59.761199 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_staging, now seed.dbt_idr.idr_exclusions)
[0m18:07:59.761426 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr.idr_identifier_mappings
[0m18:07:59.761642 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr.idr_rules
[0m18:07:59.761853 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr.idr_attribute_mappings
[0m18:07:59.762044 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr.idr_exclusions
[0m18:07:59.762260 [debug] [Thread-3 (]: Began executing node seed.dbt_idr.idr_identifier_mappings
[0m18:07:59.762464 [debug] [Thread-4 (]: Began executing node seed.dbt_idr.idr_rules
[0m18:07:59.762672 [debug] [Thread-1 (]: Began executing node seed.dbt_idr.idr_attribute_mappings
[0m18:07:59.762879 [debug] [Thread-2 (]: Began executing node seed.dbt_idr.idr_exclusions
[0m18:07:59.783114 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:07:59.784012 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:07:59.782352 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:07:59.785843 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: BEGIN
[0m18:07:59.786646 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:07:59.786903 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: BEGIN
[0m18:07:59.787125 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: BEGIN
[0m18:07:59.787331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:59.787541 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: BEGIN
[0m18:07:59.787722 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:07:59.787955 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:07:59.788327 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:07:59.788754 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.788993 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.789344 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.789623 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:07:59.789859 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:07:59.790052 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.790255 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:07:59.790477 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_attribute_mappings"} */

    create table "test_idr"."main_idr_meta"."idr_attribute_mappings" ("source_id" text,"attribute_name" text,"column_expr" text,"description" text)
  
[0m18:07:59.790708 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_rules"} */

    create table "test_idr"."main_idr_meta"."idr_rules" ("rule_id" text,"identifier_type" text,"priority" integer,"is_active" boolean,"canonicalize" text,"max_group_size" integer,"description" text)
  
[0m18:07:59.790935 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:07:59.791131 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_identifier_mappings"} */

    create table "test_idr"."main_idr_meta"."idr_identifier_mappings" ("source_id" text,"identifier_type" text,"column_name" text,"is_hashed" boolean,"description" text)
  
[0m18:07:59.791544 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_exclusions"} */

    create table "test_idr"."main_idr_meta"."idr_exclusions" ("identifier_type" text,"identifier_value_pattern" text,"match_type" text,"reason" text)
  
[0m18:07:59.792287 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.792526 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.792768 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.799908 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m18:07:59.806144 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:07:59.806453 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:07:59.807185 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:07:59.807857 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:07:59.808094 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: 
          COPY "test_idr"."main_idr_meta"."idr_attribute_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_attribute_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.808329 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: 
          COPY "test_idr"."main_idr_meta"."idr_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.808572 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: 
          COPY "test_idr"."main_idr_meta"."idr_exclusions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_exclusions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.808820 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: 
          COPY "test_idr"."main_idr_meta"."idr_identifier_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_identifier_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.820427 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m18:07:59.820736 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m18:07:59.820967 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m18:07:59.821184 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m18:07:59.824577 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr.idr_rules"
[0m18:07:59.824991 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr.idr_exclusions"
[0m18:07:59.825367 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr.idr_attribute_mappings"
[0m18:07:59.825767 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr.idr_identifier_mappings"
[0m18:07:59.835155 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: COMMIT
[0m18:07:59.835777 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: COMMIT
[0m18:07:59.836732 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: COMMIT
[0m18:07:59.837623 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: COMMIT
[0m18:07:59.837857 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m18:07:59.838080 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m18:07:59.838303 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m18:07:59.838533 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m18:07:59.838757 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: COMMIT
[0m18:07:59.838969 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: COMMIT
[0m18:07:59.839172 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: COMMIT
[0m18:07:59.839365 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: COMMIT
[0m18:07:59.840927 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.842010 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: Close
[0m18:07:59.842221 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:07:59.842433 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:07:59.842995 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:07:59.843720 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: Close
[0m18:07:59.844124 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: Close
[0m18:07:59.844513 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: Close
[0m18:07:59.845065 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f80110>]}
[0m18:07:59.845259 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d7cc00>]}
[0m18:07:59.845441 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d7c520>]}
[0m18:07:59.845657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10632f250>]}
[0m18:07:59.845912 [info ] [Thread-4 (]: 4 of 15 OK loaded seed file main_idr_meta.idr_rules ............................ [[32mINSERT 4[0m in 0.08s]
[0m18:07:59.846139 [info ] [Thread-3 (]: 3 of 15 OK loaded seed file main_idr_meta.idr_identifier_mappings .............. [[32mINSERT 5[0m in 0.08s]
[0m18:07:59.846486 [info ] [Thread-2 (]: 2 of 15 OK loaded seed file main_idr_meta.idr_exclusions ....................... [[32mINSERT 5[0m in 0.08s]
[0m18:07:59.846781 [info ] [Thread-1 (]: 1 of 15 OK loaded seed file main_idr_meta.idr_attribute_mappings ............... [[32mINSERT 10[0m in 0.08s]
[0m18:07:59.847106 [debug] [Thread-4 (]: Finished running node seed.dbt_idr.idr_rules
[0m18:07:59.847394 [debug] [Thread-3 (]: Finished running node seed.dbt_idr.idr_identifier_mappings
[0m18:07:59.847665 [debug] [Thread-2 (]: Finished running node seed.dbt_idr.idr_exclusions
[0m18:07:59.847947 [debug] [Thread-1 (]: Finished running node seed.dbt_idr.idr_attribute_mappings
[0m18:07:59.848178 [debug] [Thread-4 (]: Began running node seed.dbt_idr.idr_sources
[0m18:07:59.848438 [debug] [Thread-3 (]: Began running node seed.dbt_idr.idr_survivorship_rules
[0m18:07:59.848680 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:07:59.848910 [debug] [Thread-1 (]: Began running node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:07:59.849198 [info ] [Thread-4 (]: 5 of 15 START seed file main_idr_meta.idr_sources .............................. [RUN]
[0m18:07:59.849473 [info ] [Thread-3 (]: 6 of 15 START seed file main_idr_meta.idr_survivorship_rules ................... [RUN]
[0m18:07:59.849737 [info ] [Thread-2 (]: 7 of 15 START seed file main.idr_attribute_mappings ............................ [RUN]
[0m18:07:59.849998 [info ] [Thread-1 (]: 8 of 15 START seed file main.idr_exclusions .................................... [RUN]
[0m18:07:59.850249 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_rules, now seed.dbt_idr.idr_sources)
[0m18:07:59.850477 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_identifier_mappings, now seed.dbt_idr.idr_survivorship_rules)
[0m18:07:59.850704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_exclusions, now seed.dbt_idr_integration_tests.idr_attribute_mappings)
[0m18:07:59.850921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_attribute_mappings, now seed.dbt_idr_integration_tests.idr_exclusions)
[0m18:07:59.851140 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr.idr_sources
[0m18:07:59.851333 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr.idr_survivorship_rules
[0m18:07:59.851640 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:07:59.851926 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:07:59.852172 [debug] [Thread-4 (]: Began executing node seed.dbt_idr.idr_sources
[0m18:07:59.852416 [debug] [Thread-3 (]: Began executing node seed.dbt_idr.idr_survivorship_rules
[0m18:07:59.852639 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:07:59.852847 [debug] [Thread-1 (]: Began executing node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:07:59.857149 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:07:59.860955 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:07:59.861256 [debug] [Thread-4 (]: On seed.dbt_idr.idr_sources: BEGIN
[0m18:07:59.862034 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:07:59.863349 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:07:59.863593 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: BEGIN
[0m18:07:59.863822 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:07:59.864035 [debug] [Thread-3 (]: On seed.dbt_idr.idr_survivorship_rules: BEGIN
[0m18:07:59.864235 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: BEGIN
[0m18:07:59.864432 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:07:59.864803 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:07:59.865063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:59.865292 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.865845 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:07:59.866134 [debug] [Thread-4 (]: On seed.dbt_idr.idr_sources: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_sources"} */

    create table "test_idr"."main_idr_meta"."idr_sources" ("source_id" text,"source_name" text,"database" text,"schema" text,"table_name" text,"entity_key_column" text,"watermark_column" text,"is_active" boolean,"description" text)
  
[0m18:07:59.866518 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.866774 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:07:59.867029 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_attribute_mappings"} */

    create table "test_idr"."main"."idr_attribute_mappings" ("source_id" text,"attribute_name" text,"column_expr" text,"description" text)
  
[0m18:07:59.867279 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.867498 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.867809 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:07:59.868020 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:07:59.868230 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.868436 [debug] [Thread-3 (]: On seed.dbt_idr.idr_survivorship_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_survivorship_rules"} */

    create table "test_idr"."main_idr_meta"."idr_survivorship_rules" ("attribute_name" text,"strategy" text,"source_priority_list" text,"recency_field" text,"description" text)
  
[0m18:07:59.868644 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_exclusions"} */

    create table "test_idr"."main"."idr_exclusions" ("identifier_type" text,"identifier_value_pattern" text,"match_type" text,"reason" text)
  
[0m18:07:59.868904 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.869665 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:07:59.870578 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:07:59.870858 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.871069 [debug] [Thread-4 (]: On seed.dbt_idr.idr_sources: 
          COPY "test_idr"."main_idr_meta"."idr_sources" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_sources.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.871314 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: 
          COPY "test_idr"."main"."idr_attribute_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_attribute_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.871549 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.872243 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:07:59.873176 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:07:59.873417 [debug] [Thread-3 (]: On seed.dbt_idr.idr_survivorship_rules: 
          COPY "test_idr"."main_idr_meta"."idr_survivorship_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_survivorship_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.873640 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: 
          COPY "test_idr"."main"."idr_exclusions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_exclusions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.873917 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.874141 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.874554 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:07:59.875054 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr.idr_sources"
[0m18:07:59.876541 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: COMMIT
[0m18:07:59.876790 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m18:07:59.877044 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: COMMIT
[0m18:07:59.877265 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:07:59.877484 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:07:59.878490 [debug] [Thread-4 (]: On seed.dbt_idr.idr_sources: COMMIT
[0m18:07:59.878865 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr.idr_survivorship_rules"
[0m18:07:59.879230 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:07:59.879440 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.879639 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m18:07:59.880127 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: Close
[0m18:07:59.880344 [debug] [Thread-4 (]: On seed.dbt_idr.idr_sources: COMMIT
[0m18:07:59.880723 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f4de80>]}
[0m18:07:59.881671 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: COMMIT
[0m18:07:59.882605 [debug] [Thread-3 (]: On seed.dbt_idr.idr_survivorship_rules: COMMIT
[0m18:07:59.883140 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m18:07:59.882948 [info ] [Thread-2 (]: 7 of 15 OK loaded seed file main.idr_attribute_mappings ........................ [[32mINSERT 10[0m in 0.03s]
[0m18:07:59.883404 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:07:59.883596 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m18:07:59.883799 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: COMMIT
[0m18:07:59.884094 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m18:07:59.884457 [debug] [Thread-4 (]: On seed.dbt_idr.idr_sources: Close
[0m18:07:59.884661 [debug] [Thread-3 (]: On seed.dbt_idr.idr_survivorship_rules: COMMIT
[0m18:07:59.884930 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:07:59.885176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:07:59.885428 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f558b0>]}
[0m18:07:59.885733 [info ] [Thread-2 (]: 9 of 15 START seed file main.idr_identifier_mappings ........................... [RUN]
[0m18:07:59.886111 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: Close
[0m18:07:59.886367 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.886789 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_attribute_mappings, now seed.dbt_idr_integration_tests.idr_identifier_mappings)
[0m18:07:59.886612 [info ] [Thread-4 (]: 5 of 15 OK loaded seed file main_idr_meta.idr_sources .......................... [[32mINSERT 3[0m in 0.04s]
[0m18:07:59.887116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11020fef0>]}
[0m18:07:59.887463 [debug] [Thread-3 (]: On seed.dbt_idr.idr_survivorship_rules: Close
[0m18:07:59.887674 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:07:59.887959 [debug] [Thread-4 (]: Finished running node seed.dbt_idr.idr_sources
[0m18:07:59.888260 [info ] [Thread-1 (]: 8 of 15 OK loaded seed file main.idr_exclusions ................................ [[32mINSERT 2[0m in 0.04s]
[0m18:07:59.888604 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f563f0>]}
[0m18:07:59.888843 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:07:59.889080 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.idr_rules
[0m18:07:59.889503 [debug] [Thread-1 (]: Finished running node seed.dbt_idr_integration_tests.idr_exclusions
[0m18:07:59.889899 [info ] [Thread-3 (]: 6 of 15 OK loaded seed file main_idr_meta.idr_survivorship_rules ............... [[32mINSERT 5[0m in 0.04s]
[0m18:07:59.891769 [info ] [Thread-4 (]: 10 of 15 START seed file main.idr_rules ........................................ [RUN]
[0m18:07:59.892103 [debug] [Thread-1 (]: Began running node seed.dbt_idr_integration_tests.idr_sources
[0m18:07:59.892482 [debug] [Thread-3 (]: Finished running node seed.dbt_idr.idr_survivorship_rules
[0m18:07:59.893316 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:07:59.893565 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_sources, now seed.dbt_idr_integration_tests.idr_rules)
[0m18:07:59.894142 [debug] [Thread-3 (]: Began running node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:07:59.893886 [info ] [Thread-1 (]: 11 of 15 START seed file main.idr_sources ...................................... [RUN]
[0m18:07:59.894472 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: BEGIN
[0m18:07:59.894713 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.idr_rules
[0m18:07:59.895223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_exclusions, now seed.dbt_idr_integration_tests.idr_sources)
[0m18:07:59.894997 [info ] [Thread-3 (]: 12 of 15 START seed file main.idr_survivorship_rules ........................... [RUN]
[0m18:07:59.895541 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:07:59.895761 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.idr_rules
[0m18:07:59.895981 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr_integration_tests.idr_sources
[0m18:07:59.896206 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_survivorship_rules, now seed.dbt_idr_integration_tests.idr_survivorship_rules)
[0m18:07:59.897819 [debug] [Thread-1 (]: Began executing node seed.dbt_idr_integration_tests.idr_sources
[0m18:07:59.898763 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:07:59.898989 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:07:59.899601 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:07:59.901282 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:07:59.901539 [debug] [Thread-3 (]: Began executing node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:07:59.902318 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:07:59.902527 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_rules: BEGIN
[0m18:07:59.902731 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_identifier_mappings"} */

    create table "test_idr"."main"."idr_identifier_mappings" ("source_id" text,"identifier_type" text,"column_name" text,"is_hashed" boolean,"description" text)
  
[0m18:07:59.904508 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: BEGIN
[0m18:07:59.904815 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:07:59.905746 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:07:59.905980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:59.906185 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.906494 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: BEGIN
[0m18:07:59.906761 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.907587 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:07:59.907854 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:07:59.908158 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.908393 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:07:59.908660 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: 
          COPY "test_idr"."main"."idr_identifier_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_identifier_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.908990 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:07:59.909242 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.909452 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_rules"} */

    create table "test_idr"."main"."idr_rules" ("rule_id" text,"identifier_type" text,"priority" integer,"is_active" boolean,"canonicalize" text,"max_group_size" integer,"description" text)
  
[0m18:07:59.909760 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_sources"} */

    create table "test_idr"."main"."idr_sources" ("source_id" text,"source_name" text,"database" integer,"schema" text,"table_name" text,"entity_key_column" text,"watermark_column" text,"is_active" boolean,"description" text)
  
[0m18:07:59.909981 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:07:59.910438 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_survivorship_rules"} */

    create table "test_idr"."main"."idr_survivorship_rules" ("attribute_name" text,"strategy" text,"source_priority_list" integer,"recency_field" text,"description" text)
  
[0m18:07:59.910712 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.911017 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.911209 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.911962 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:07:59.912196 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.912910 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:07:59.913277 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:07:59.913486 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_rules: 
          COPY "test_idr"."main"."idr_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.914220 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:07:59.914455 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: 
          COPY "test_idr"."main"."idr_sources" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_sources.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.914864 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: 
          COPY "test_idr"."main"."idr_survivorship_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_survivorship_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.916024 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: COMMIT
[0m18:07:59.916276 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m18:07:59.916479 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: COMMIT
[0m18:07:59.916786 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.917210 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_rules"
[0m18:07:59.917440 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.917802 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_sources"
[0m18:07:59.918029 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:07:59.918374 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:07:59.918693 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.919105 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: Close
[0m18:07:59.920110 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_rules: COMMIT
[0m18:07:59.920313 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m18:07:59.920556 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_rules: COMMIT
[0m18:07:59.920865 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111154cb0>]}
[0m18:07:59.921840 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: COMMIT
[0m18:07:59.922736 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: COMMIT
[0m18:07:59.923312 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m18:07:59.923125 [info ] [Thread-2 (]: 9 of 15 OK loaded seed file main.idr_identifier_mappings ....................... [[32mINSERT 6[0m in 0.03s]
[0m18:07:59.923620 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m18:07:59.923831 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.924041 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: COMMIT
[0m18:07:59.924327 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m18:07:59.924535 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: COMMIT
[0m18:07:59.924899 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_rules: Close
[0m18:07:59.925175 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:07:59.925408 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:07:59.925717 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111544d0>]}
[0m18:07:59.925988 [info ] [Thread-2 (]: 13 of 15 START seed file main.sample_crm_customers ............................. [RUN]
[0m18:07:59.926216 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.926601 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_sources: Close
[0m18:07:59.927068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_identifier_mappings, now seed.dbt_idr_integration_tests.sample_crm_customers)
[0m18:07:59.926888 [info ] [Thread-4 (]: 10 of 15 OK loaded seed file main.idr_rules .................................... [[32mINSERT 3[0m in 0.03s]
[0m18:07:59.927478 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: Close
[0m18:07:59.927757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f55970>]}
[0m18:07:59.927974 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:07:59.928257 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.idr_rules
[0m18:07:59.928609 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111155250>]}
[0m18:07:59.929127 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:07:59.928933 [info ] [Thread-1 (]: 11 of 15 OK loaded seed file main.idr_sources .................................. [[32mINSERT 3[0m in 0.03s]
[0m18:07:59.929424 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.sample_orders
[0m18:07:59.929716 [info ] [Thread-3 (]: 12 of 15 OK loaded seed file main.idr_survivorship_rules ....................... [[32mINSERT 4[0m in 0.03s]
[0m18:07:59.931731 [debug] [Thread-1 (]: Finished running node seed.dbt_idr_integration_tests.idr_sources
[0m18:07:59.932024 [info ] [Thread-4 (]: 14 of 15 START seed file main.sample_orders .................................... [RUN]
[0m18:07:59.932436 [debug] [Thread-3 (]: Finished running node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m18:07:59.933004 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:07:59.933221 [debug] [Thread-1 (]: Began running node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:07:59.933469 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_rules, now seed.dbt_idr_integration_tests.sample_orders)
[0m18:07:59.933711 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: BEGIN
[0m18:07:59.933962 [info ] [Thread-1 (]: 15 of 15 START seed file main.sample_pos_transactions .......................... [RUN]
[0m18:07:59.934207 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.sample_orders
[0m18:07:59.934441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:07:59.934688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_sources, now seed.dbt_idr_integration_tests.sample_pos_transactions)
[0m18:07:59.934906 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.sample_orders
[0m18:07:59.935200 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:07:59.936883 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.937171 [debug] [Thread-1 (]: Began executing node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:07:59.937840 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:07:59.938078 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:07:59.941979 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: BEGIN
[0m18:07:59.942669 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_crm_customers"} */

    create table "test_idr"."main"."sample_crm_customers" ("customer_id" varchar,"email" varchar,"phone" varchar,"first_name" varchar,"last_name" varchar,"loyalty_id" varchar,"updated_at" varchar)
  
[0m18:07:59.943280 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:07:59.943528 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:07:59.943801 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: BEGIN
[0m18:07:59.944250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:07:59.944607 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.944918 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:07:59.945121 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_orders"} */

    create table "test_idr"."main"."sample_orders" ("order_id" varchar,"customer_email" varchar,"contact_phone" varchar,"order_date" varchar)
  
[0m18:07:59.945349 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.945593 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:07:59.945799 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_pos_transactions"} */

    create table "test_idr"."main"."sample_pos_transactions" ("transaction_id" varchar,"loyalty_card_id" varchar,"contact_phone" varchar,"transaction_date" varchar)
  
[0m18:07:59.946149 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.946876 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:07:59.947079 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: 
          COPY "test_idr"."main"."sample_crm_customers" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_crm_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.947392 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.948178 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:07:59.948398 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: 
          COPY "test_idr"."main"."sample_orders" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.948625 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m18:07:59.949393 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:07:59.949620 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: 
          COPY "test_idr"."main"."sample_pos_transactions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_pos_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:07:59.950040 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:07:59.950400 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:07:59.951491 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: COMMIT
[0m18:07:59.951779 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m18:07:59.952050 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:07:59.952274 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:07:59.952490 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: COMMIT
[0m18:07:59.952919 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:07:59.953310 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_orders"
[0m18:07:59.953861 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:07:59.954944 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: COMMIT
[0m18:07:59.955467 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: Close
[0m18:07:59.955740 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m18:07:59.956703 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: COMMIT
[0m18:07:59.957032 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f55970>]}
[0m18:07:59.957249 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: COMMIT
[0m18:07:59.957472 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m18:07:59.958043 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: COMMIT
[0m18:07:59.957804 [info ] [Thread-2 (]: 13 of 15 OK loaded seed file main.sample_crm_customers ......................... [[32mINSERT 10[0m in 0.03s]
[0m18:07:59.958331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:07:59.958650 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.sample_crm_customers
[0m18:07:59.959035 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: Close
[0m18:07:59.959303 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:07:59.959564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b96ff0>]}
[0m18:07:59.959948 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_orders: Close
[0m18:07:59.960236 [info ] [Thread-1 (]: 15 of 15 OK loaded seed file main.sample_pos_transactions ...................... [[32mINSERT 10[0m in 0.02s]
[0m18:07:59.960518 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9344b40d-400e-4dbc-9c4b-e291b9e42104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f57410>]}
[0m18:07:59.960806 [debug] [Thread-1 (]: Finished running node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m18:07:59.961067 [info ] [Thread-4 (]: 14 of 15 OK loaded seed file main.sample_orders ................................ [[32mINSERT 10[0m in 0.03s]
[0m18:07:59.961390 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.sample_orders
[0m18:07:59.962083 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:59.962264 [debug] [MainThread]: On master: BEGIN
[0m18:07:59.962424 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:07:59.962709 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:59.962871 [debug] [MainThread]: On master: COMMIT
[0m18:07:59.963031 [debug] [MainThread]: Using duckdb connection "master"
[0m18:07:59.963188 [debug] [MainThread]: On master: COMMIT
[0m18:07:59.963419 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:07:59.963575 [debug] [MainThread]: On master: Close
[0m18:07:59.963773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:07:59.964006 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_pos_transactions' was properly closed.
[0m18:07:59.964180 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_crm_customers' was properly closed.
[0m18:07:59.964334 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.idr_survivorship_rules' was properly closed.
[0m18:07:59.964482 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_orders' was properly closed.
[0m18:07:59.964676 [info ] [MainThread]: 
[0m18:07:59.964864 [info ] [MainThread]: Finished running 15 seeds in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m18:07:59.966195 [debug] [MainThread]: Command end result
[0m18:07:59.989982 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:07:59.991531 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:07:59.995070 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/run_results.json
[0m18:07:59.995276 [info ] [MainThread]: 
[0m18:07:59.995505 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:07:59.995688 [info ] [MainThread]: 
[0m18:07:59.995898 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m18:07:59.997272 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.2057855, "process_in_blocks": "0", "process_kernel_time": 0.243765, "process_mem_max_rss": "162185216", "process_out_blocks": "0", "process_user_time": 1.794098}
[0m18:07:59.997560 [debug] [MainThread]: Command `dbt seed` succeeded at 18:07:59.997511 after 1.21 seconds
[0m18:07:59.997775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cebe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100c64b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111562d0>]}
[0m18:07:59.997982 [debug] [MainThread]: Flushing usage events
[0m18:08:00.408491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:01.666089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10976b890>]}


============================== 18:08:01.668953 | 3208f48f-6d0f-4e92-b7ba-acf0141b973c ==============================
[0m18:08:01.668953 [info ] [MainThread]: Running with dbt=1.11.2
[0m18:08:01.669406 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'debug': 'False', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'write_json': 'True', 'profiles_dir': '.', 'empty': 'False', 'fail_fast': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False'}
[0m18:08:01.791675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a81810>]}
[0m18:08:01.827345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960b790>]}
[0m18:08:01.828577 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m18:08:01.894184 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m18:08:01.983238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:08:01.983558 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m18:08:01.983735 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:08:02.022419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ce0250>]}
[0m18:08:02.132124 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:08:02.133364 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:08:02.143891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986ee40>]}
[0m18:08:02.144235 [info ] [MainThread]: Found 35 data tests, 15 seeds, 11 models, 6 sources, 591 macros
[0m18:08:02.144453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10996dc50>]}
[0m18:08:02.146411 [info ] [MainThread]: 
[0m18:08:02.146659 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:08:02.146848 [info ] [MainThread]: 
[0m18:08:02.147163 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:08:02.150488 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:08:02.157249 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:08:02.157681 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m18:08:02.180975 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:08:02.181285 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:08:02.181498 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:08:02.181728 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m18:08:02.181925 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:08:02.182107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:02.182288 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m18:08:02.182457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:02.182724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:02.190944 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:08:02.191203 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:08:02.191431 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m18:08:02.192181 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:08:02.192911 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:08:02.193532 [debug] [ThreadPool]: On list_test_idr: Close
[0m18:08:02.194146 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_out)
[0m18:08:02.194459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_staging)
[0m18:08:02.194700 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_work)
[0m18:08:02.194960 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_out"
"
[0m18:08:02.195205 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_staging"
"
[0m18:08:02.195429 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_work"
"
[0m18:08:02.199279 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m18:08:02.200555 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m18:08:02.201528 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m18:08:02.201777 [debug] [ThreadPool]: On create_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_out"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:08:02.202036 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:08:02.202266 [debug] [ThreadPool]: On create_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_work"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m18:08:02.202455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:02.202623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:02.202786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:02.203353 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:02.204144 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m18:08:02.204327 [debug] [ThreadPool]: On create_test_idr_main_idr_out: BEGIN
[0m18:08:02.204575 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:08:02.204813 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:08:02.205495 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m18:08:02.205665 [debug] [ThreadPool]: On create_test_idr_main_idr_work: BEGIN
[0m18:08:02.205872 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:02.206055 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m18:08:02.206230 [debug] [ThreadPool]: On create_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_out"} */

    
    
        create schema if not exists "test_idr"."main_idr_out"
    
[0m18:08:02.207040 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m18:08:02.207291 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:02.207456 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:08:02.207621 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: BEGIN
[0m18:08:02.208225 [debug] [ThreadPool]: On create_test_idr_main_idr_out: COMMIT
[0m18:08:02.208523 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m18:08:02.208894 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:02.209122 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m18:08:02.209323 [debug] [ThreadPool]: On create_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_work"} */

    
    
        create schema if not exists "test_idr"."main_idr_work"
    
[0m18:08:02.210347 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m18:08:02.210581 [debug] [ThreadPool]: On create_test_idr_main_idr_out: COMMIT
[0m18:08:02.210862 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_staging"} */

    
    
        create schema if not exists "test_idr"."main_idr_staging"
    
[0m18:08:02.211158 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:02.211791 [debug] [ThreadPool]: On create_test_idr_main_idr_work: COMMIT
[0m18:08:02.212004 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m18:08:02.212175 [debug] [ThreadPool]: On create_test_idr_main_idr_work: COMMIT
[0m18:08:02.212402 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:02.212598 [debug] [ThreadPool]: On create_test_idr_main_idr_out: Close
[0m18:08:02.212791 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:02.212968 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:08:02.213250 [debug] [ThreadPool]: On create_test_idr_main_idr_work: Close
[0m18:08:02.213754 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: COMMIT
[0m18:08:02.214077 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m18:08:02.214269 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: COMMIT
[0m18:08:02.214586 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:08:02.214764 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: Close
[0m18:08:02.216358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_work, now list_test_idr_main_idr_out)
[0m18:08:02.216632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_staging, now list_test_idr_main_idr_work)
[0m18:08:02.220212 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:08:02.220460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_out, now list_test_idr_main_idr_meta)
[0m18:08:02.220739 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main'
[0m18:08:02.221763 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:08:02.221946 [debug] [ThreadPool]: On list_test_idr_main_idr_out: BEGIN
[0m18:08:02.223116 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:08:02.224151 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:08:02.224352 [debug] [ThreadPool]: On list_test_idr_main_idr_work: BEGIN
[0m18:08:02.224546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:02.224742 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: BEGIN
[0m18:08:02.224911 [debug] [ThreadPool]: On list_test_idr_main: BEGIN
[0m18:08:02.225075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:02.225314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:02.225482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:02.225657 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:02.225986 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m18:08:02.226165 [debug] [ThreadPool]: On list_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_out"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_out'
    and lower(table_catalog) = 'test_idr'
  
[0m18:08:02.226347 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:02.226515 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:02.226671 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:08:02.226908 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m18:08:02.227089 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m18:08:02.227268 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m18:08:02.227449 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_meta"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_meta'
    and lower(table_catalog) = 'test_idr'
  
[0m18:08:02.227652 [debug] [ThreadPool]: On list_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'test_idr'
  
[0m18:08:02.227851 [debug] [ThreadPool]: On list_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_work"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_work'
    and lower(table_catalog) = 'test_idr'
  
[0m18:08:02.234369 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:08:02.235160 [debug] [ThreadPool]: On list_test_idr_main_idr_out: ROLLBACK
[0m18:08:02.235379 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m18:08:02.235594 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:08:02.235855 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m18:08:02.236437 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_out'
[0m18:08:02.237090 [debug] [ThreadPool]: On list_test_idr_main_idr_work: ROLLBACK
[0m18:08:02.237872 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: ROLLBACK
[0m18:08:02.238039 [debug] [ThreadPool]: On list_test_idr_main_idr_out: Close
[0m18:08:02.238772 [debug] [ThreadPool]: On list_test_idr_main: ROLLBACK
[0m18:08:02.239102 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_work'
[0m18:08:02.239392 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_meta'
[0m18:08:02.239703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_out, now list_test_idr_main_idr_staging)
[0m18:08:02.239961 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main'
[0m18:08:02.240145 [debug] [ThreadPool]: On list_test_idr_main_idr_work: Close
[0m18:08:02.240323 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: Close
[0m18:08:02.243678 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:08:02.243911 [debug] [ThreadPool]: On list_test_idr_main: Close
[0m18:08:02.244767 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: BEGIN
[0m18:08:02.244961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:02.245919 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:08:02.246094 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m18:08:02.246270 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_staging"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_staging'
    and lower(table_catalog) = 'test_idr'
  
[0m18:08:02.248231 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:08:02.248928 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: ROLLBACK
[0m18:08:02.249219 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_staging'
[0m18:08:02.249375 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: Close
[0m18:08:02.249718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a81cd50>]}
[0m18:08:02.249974 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:02.250129 [debug] [MainThread]: On master: BEGIN
[0m18:08:02.250276 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:08:02.250558 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:02.250716 [debug] [MainThread]: On master: COMMIT
[0m18:08:02.250866 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:02.251012 [debug] [MainThread]: On master: COMMIT
[0m18:08:02.251250 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:02.251403 [debug] [MainThread]: On master: Close
[0m18:08:02.252550 [debug] [Thread-1 (]: Began running node model.dbt_idr.stg_identifiers
[0m18:08:02.252837 [info ] [Thread-1 (]: 1 of 11 START sql table model main_idr_staging.stg_identifiers ................. [RUN]
[0m18:08:02.253076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_staging, now model.dbt_idr.stg_identifiers)
[0m18:08:02.253275 [debug] [Thread-1 (]: Began compiling node model.dbt_idr.stg_identifiers
[0m18:08:02.266775 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:08:02.267103 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

    
    select * from "test_idr"."main"."idr_sources" where is_active = true

  
[0m18:08:02.267317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:02.268717 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.269628 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:08:02.269856 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

    
    select 
        m.*,
        r.canonicalize,
        r.priority,
        coalesce(r.max_group_size, 1000) as max_group_size
    from "test_idr"."main"."idr_identifier_mappings" m
    inner join "test_idr"."main"."idr_rules" r on m.identifier_type = r.identifier_type
    where r.is_active = true

  
[0m18:08:02.274188 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:08:02.279523 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idr.stg_identifiers"
[0m18:08:02.280035 [debug] [Thread-1 (]: Began executing node model.dbt_idr.stg_identifiers
[0m18:08:02.298990 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idr.stg_identifiers"
[0m18:08:02.299458 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:08:02.299674 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: BEGIN
[0m18:08:02.300068 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.300309 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:08:02.300644 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

  
    
    

    create  table
      "test_idr"."main_idr_staging"."stg_identifiers__dbt_tmp"
  
    as (
      









    
    
    
    
    






    
    
    
    
    
    
    
        
    
    
    
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
    
        
    
        
    
        
    

    
    
    
    
    
    
    
        
    
    
    
    
        
    
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
    
        
    

    
    
    
    
    
    
    
        
    
    
    
    
        
    
        
    
        
    
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    



with raw_identifiers as (
    
        
select
    'crm' as source_id,
    concat('crm', ':', cast(customer_id as TEXT)) as entity_key,
    'EMAIL' as identifier_type,
    cast(email as TEXT) as identifier_value_raw,
    cast(lower(email) as TEXT) as identifier_value_norm,
    False as is_hashed,
    1 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_crm_customers
where email is not null
            
union all

select
    'crm' as source_id,
    concat('crm', ':', cast(customer_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(phone as TEXT) as identifier_value_raw,
    cast(phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_crm_customers
where phone is not null
            
union all

select
    'orders' as source_id,
    concat('orders', ':', cast(order_id as TEXT)) as entity_key,
    'EMAIL' as identifier_type,
    cast(customer_email as TEXT) as identifier_value_raw,
    cast(lower(customer_email) as TEXT) as identifier_value_norm,
    False as is_hashed,
    1 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_orders
where customer_email is not null
            
union all

select
    'orders' as source_id,
    concat('orders', ':', cast(order_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(contact_phone as TEXT) as identifier_value_raw,
    cast(contact_phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_orders
where contact_phone is not null
            
union all

select
    'pos' as source_id,
    concat('pos', ':', cast(transaction_id as TEXT)) as entity_key,
    'LOYALTY' as identifier_type,
    cast(loyalty_card_id as TEXT) as identifier_value_raw,
    cast(loyalty_card_id as TEXT) as identifier_value_norm,
    False as is_hashed,
    3 as priority,
    10 as max_group_size,
    current_timestamp as extracted_at
from main.sample_pos_transactions
where loyalty_card_id is not null
            
union all

select
    'pos' as source_id,
    concat('pos', ':', cast(transaction_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(contact_phone as TEXT) as identifier_value_raw,
    cast(contact_phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_pos_transactions
where contact_phone is not null
            
    
),

exclusions as (
    select identifier_type, identifier_value_pattern, match_type
    from "test_idr"."main"."idr_exclusions"
),


filtered_identifiers as (
    select r.*
    from raw_identifiers r
    where not exists (
        select 1 from exclusions e
        where e.identifier_type = r.identifier_type
          and (
            (e.match_type = 'EXACT' and r.identifier_value_norm = e.identifier_value_pattern)
            or (e.match_type = 'LIKE' and r.identifier_value_norm like e.identifier_value_pattern)
          )
    )
)

select * from filtered_identifiers
    );
  
  
[0m18:08:02.305908 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m18:08:02.309755 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:08:02.309982 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */
alter table "test_idr"."main_idr_staging"."stg_identifiers__dbt_tmp" rename to "stg_identifiers"
[0m18:08:02.310835 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.318837 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: COMMIT
[0m18:08:02.319093 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:08:02.319288 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: COMMIT
[0m18:08:02.319823 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.323345 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m18:08:02.323581 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

      drop table if exists "test_idr"."main_idr_staging"."stg_identifiers__dbt_backup" cascade
    
[0m18:08:02.323945 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.325293 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: Close
[0m18:08:02.326241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8031d0>]}
[0m18:08:02.326620 [info ] [Thread-1 (]: 1 of 11 OK created sql table model main_idr_staging.stg_identifiers ............ [[32mOK[0m in 0.07s]
[0m18:08:02.327003 [debug] [Thread-1 (]: Finished running node model.dbt_idr.stg_identifiers
[0m18:08:02.327543 [debug] [Thread-3 (]: Began running node model.dbt_idr.skipped_identifier_groups
[0m18:08:02.327830 [debug] [Thread-2 (]: Began running node model.dbt_idr.int_edges
[0m18:08:02.328162 [info ] [Thread-3 (]: 3 of 11 START sql table model main_idr_out.skipped_identifier_groups ........... [RUN]
[0m18:08:02.328501 [info ] [Thread-2 (]: 2 of 11 START sql table model main_idr_work.int_edges .......................... [RUN]
[0m18:08:02.328828 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_meta, now model.dbt_idr.skipped_identifier_groups)
[0m18:08:02.329111 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_work, now model.dbt_idr.int_edges)
[0m18:08:02.329359 [debug] [Thread-3 (]: Began compiling node model.dbt_idr.skipped_identifier_groups
[0m18:08:02.329584 [debug] [Thread-2 (]: Began compiling node model.dbt_idr.int_edges
[0m18:08:02.331493 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_idr.skipped_identifier_groups"
[0m18:08:02.333579 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_idr.int_edges"
[0m18:08:02.334184 [debug] [Thread-2 (]: Began executing node model.dbt_idr.int_edges
[0m18:08:02.334475 [debug] [Thread-3 (]: Began executing node model.dbt_idr.skipped_identifier_groups
[0m18:08:02.336479 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_idr.int_edges"
[0m18:08:02.338754 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_idr.skipped_identifier_groups"
[0m18:08:02.339480 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m18:08:02.339721 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: BEGIN
[0m18:08:02.339983 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m18:08:02.340263 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:08:02.340530 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: BEGIN
[0m18:08:02.340893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:08:02.341170 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.341384 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m18:08:02.341584 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.341806 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.skipped_identifier_groups"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."skipped_identifier_groups__dbt_tmp"
  
    as (
      



with identifier_groups as (
    select
        identifier_type,
        identifier_value_norm,
        max_group_size,
        count(*) as group_size,
        min(entity_key) as sample_entity_key
    from "test_idr"."main_idr_staging"."stg_identifiers"
    where identifier_value_norm is not null
    group by identifier_type, identifier_value_norm, max_group_size
),

skipped_groups as (
    select
        '3208f48f-6d0f-4e92-b7ba-acf0141b973c' as run_id,
        identifier_type,
        identifier_value_norm,
        group_size,
        max_group_size as max_allowed,
        sample_entity_key,
        'EXCEEDED_MAX_GROUP_SIZE' as reason,
        current_timestamp as skipped_at
    from identifier_groups
    where group_size > max_group_size
)

select * from skipped_groups
    );
  
  
[0m18:08:02.342139 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m18:08:02.342559 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_edges"} */

  
    
    

    create  table
      "test_idr"."main_idr_work"."int_edges__dbt_tmp"
  
    as (
      



with identifier_groups as (
    -- Count entities per identifier value
    select
        identifier_type,
        identifier_value_norm,
        max_group_size,
        count(*) as group_size,
        min(entity_key) as anchor_entity_key
    from "test_idr"."main_idr_staging"."stg_identifiers"
    where identifier_value_norm is not null
    group by identifier_type, identifier_value_norm, max_group_size
),

valid_groups as (
    -- Filter out oversized groups
    select
        identifier_type,
        identifier_value_norm,
        anchor_entity_key
    from identifier_groups
    where group_size <= max_group_size
),

edges as (
    -- Create edges from each entity to the anchor
    select distinct
        vg.anchor_entity_key as left_entity_key,
        i.entity_key as right_entity_key,
        vg.identifier_type,
        vg.identifier_value_norm,
        current_timestamp as created_at
    from valid_groups vg
    inner join "test_idr"."main_idr_staging"."stg_identifiers" i
        on i.identifier_type = vg.identifier_type
        and i.identifier_value_norm = vg.identifier_value_norm
    where i.entity_key != vg.anchor_entity_key
)

select * from edges
    );
  
  
[0m18:08:02.345190 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:08:02.347021 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m18:08:02.347277 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.skipped_identifier_groups"} */
alter table "test_idr"."main_idr_out"."skipped_identifier_groups__dbt_tmp" rename to "skipped_identifier_groups"
[0m18:08:02.347508 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m18:08:02.349548 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m18:08:02.349784 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_edges"} */
alter table "test_idr"."main_idr_work"."int_edges__dbt_tmp" rename to "int_edges"
[0m18:08:02.350042 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:08:02.351172 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: COMMIT
[0m18:08:02.351450 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m18:08:02.351667 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: COMMIT
[0m18:08:02.351890 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:08:02.353067 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: COMMIT
[0m18:08:02.353333 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m18:08:02.353543 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: COMMIT
[0m18:08:02.353824 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:08:02.355147 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m18:08:02.355389 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.skipped_identifier_groups"} */

      drop table if exists "test_idr"."main_idr_out"."skipped_identifier_groups__dbt_backup" cascade
    
[0m18:08:02.355600 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:08:02.357189 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m18:08:02.357470 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_edges"} */

      drop table if exists "test_idr"."main_idr_work"."int_edges__dbt_backup" cascade
    
[0m18:08:02.357713 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:08:02.358554 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: Close
[0m18:08:02.358921 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac98310>]}
[0m18:08:02.359152 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.360216 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: Close
[0m18:08:02.360470 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac34410>]}
[0m18:08:02.359534 [info ] [Thread-3 (]: 3 of 11 OK created sql table model main_idr_out.skipped_identifier_groups ...... [[32mOK[0m in 0.03s]
[0m18:08:02.360872 [info ] [Thread-2 (]: 2 of 11 OK created sql table model main_idr_work.int_edges ..................... [[32mOK[0m in 0.03s]
[0m18:08:02.361206 [debug] [Thread-3 (]: Finished running node model.dbt_idr.skipped_identifier_groups
[0m18:08:02.361509 [debug] [Thread-2 (]: Finished running node model.dbt_idr.int_edges
[0m18:08:02.361973 [debug] [Thread-3 (]: Began running node model.dbt_idr.rule_match_audit
[0m18:08:02.362193 [debug] [Thread-1 (]: Began running node model.dbt_idr.int_labels
[0m18:08:02.362415 [debug] [Thread-4 (]: Began running node model.dbt_idr.identity_edges
[0m18:08:02.362662 [info ] [Thread-3 (]: 6 of 11 START sql table model main_idr_out.rule_match_audit .................... [RUN]
[0m18:08:02.362888 [info ] [Thread-1 (]: 5 of 11 START sql table model main_idr_work.int_labels ......................... [RUN]
[0m18:08:02.363428 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_idr.skipped_identifier_groups, now model.dbt_idr.rule_match_audit)
[0m18:08:02.363656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idr.stg_identifiers, now model.dbt_idr.int_labels)
[0m18:08:02.363158 [info ] [Thread-4 (]: 4 of 11 START sql table model main_idr_out.identity_edges ...................... [RUN]
[0m18:08:02.363924 [debug] [Thread-3 (]: Began compiling node model.dbt_idr.rule_match_audit
[0m18:08:02.364127 [debug] [Thread-1 (]: Began compiling node model.dbt_idr.int_labels
[0m18:08:02.364345 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_test_idr_main, now model.dbt_idr.identity_edges)
[0m18:08:02.366382 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_idr.rule_match_audit"
[0m18:08:02.368725 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idr.int_labels"
[0m18:08:02.368972 [debug] [Thread-4 (]: Began compiling node model.dbt_idr.identity_edges
[0m18:08:02.371325 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_idr.identity_edges"
[0m18:08:02.371819 [debug] [Thread-1 (]: Began executing node model.dbt_idr.int_labels
[0m18:08:02.373679 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idr.int_labels"
[0m18:08:02.373950 [debug] [Thread-4 (]: Began executing node model.dbt_idr.identity_edges
[0m18:08:02.374218 [debug] [Thread-3 (]: Began executing node model.dbt_idr.rule_match_audit
[0m18:08:02.376387 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_idr.identity_edges"
[0m18:08:02.378232 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_idr.rule_match_audit"
[0m18:08:02.378630 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.int_labels"
[0m18:08:02.378857 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: BEGIN
[0m18:08:02.379091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:02.379497 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m18:08:02.379732 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m18:08:02.379940 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: BEGIN
[0m18:08:02.380148 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.380353 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: BEGIN
[0m18:08:02.380548 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:08:02.380747 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.int_labels"
[0m18:08:02.380936 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:08:02.381235 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_labels"} */

  
    
    

    create  table
      "test_idr"."main_idr_work"."int_labels__dbt_tmp"
  
    as (
      



with recursive 

all_nodes as (
    select distinct left_entity_key as entity_key from "test_idr"."main_idr_work"."int_edges"
    union
    select distinct right_entity_key as entity_key from "test_idr"."main_idr_work"."int_edges"
),

undirected_edges as (
    select left_entity_key as src, right_entity_key as dst from "test_idr"."main_idr_work"."int_edges"
    union
    select right_entity_key as src, left_entity_key as dst from "test_idr"."main_idr_work"."int_edges"
),


label_propagation as (
    -- Base case: initial labels
    select 
        entity_key,
        entity_key as label,
        0 as iteration
    from all_nodes
    
    union all
    
    -- Recursive case: propagate minimum label
    select 
        lp.entity_key,
        least(lp.label, e.dst) as label,
        lp.iteration + 1
    from label_propagation lp
    join undirected_edges e on e.src = lp.entity_key
    where lp.iteration < 30
      and e.dst < lp.label
),

final_labels as (
    select 
        entity_key,
        min(label) as label
    from label_propagation
    group by entity_key
)

select 
    entity_key,
    label as resolved_id,
    current_timestamp as updated_at
from final_labels
    );
  
  
[0m18:08:02.381519 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.381891 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.382100 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m18:08:02.382310 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m18:08:02.382542 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.rule_match_audit"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."rule_match_audit__dbt_tmp"
  
    as (
      



select
    '3208f48f-6d0f-4e92-b7ba-acf0141b973c' as run_id,
    'rule_' || identifier_type as rule_id,
    count(*) as edges_created,
    min(created_at) as started_at,
    max(created_at) as ended_at
from "test_idr"."main_idr_work"."int_edges"
group by identifier_type
    );
  
  
[0m18:08:02.382777 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_edges"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."identity_edges__dbt_tmp"
  
    as (
      



select
    'rule_' || identifier_type as rule_id,
    left_entity_key,
    right_entity_key,
    identifier_type,
    identifier_value_norm,
    created_at as first_seen_ts,
    created_at as last_seen_ts
from "test_idr"."main_idr_work"."int_edges"
    );
  
  
[0m18:08:02.383903 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.385731 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m18:08:02.385992 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_edges"} */
alter table "test_idr"."main_idr_out"."identity_edges__dbt_tmp" rename to "identity_edges"
[0m18:08:02.386231 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:08:02.386462 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:08:02.388155 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.int_labels"
[0m18:08:02.389820 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m18:08:02.390051 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_labels"} */
alter table "test_idr"."main_idr_work"."int_labels__dbt_tmp" rename to "int_labels"
[0m18:08:02.390262 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m18:08:02.390463 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.rule_match_audit"} */
alter table "test_idr"."main_idr_out"."rule_match_audit__dbt_tmp" rename to "rule_match_audit"
[0m18:08:02.391400 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: COMMIT
[0m18:08:02.391674 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m18:08:02.391880 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.392086 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: COMMIT
[0m18:08:02.392279 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.393198 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: COMMIT
[0m18:08:02.394118 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: COMMIT
[0m18:08:02.394325 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.int_labels"
[0m18:08:02.394526 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m18:08:02.394723 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.394906 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: COMMIT
[0m18:08:02.395103 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: COMMIT
[0m18:08:02.398727 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m18:08:02.399101 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_edges"} */

      drop table if exists "test_idr"."main_idr_out"."identity_edges__dbt_backup" cascade
    
[0m18:08:02.399378 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.400567 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.int_labels"
[0m18:08:02.400777 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_labels"} */

      drop table if exists "test_idr"."main_idr_work"."int_labels__dbt_backup" cascade
    
[0m18:08:02.400989 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:08:02.401251 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:08:02.401992 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: Close
[0m18:08:02.402212 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.403393 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m18:08:02.403710 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac17650>]}
[0m18:08:02.404395 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: Close
[0m18:08:02.404602 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.rule_match_audit"} */

      drop table if exists "test_idr"."main_idr_out"."rule_match_audit__dbt_backup" cascade
    
[0m18:08:02.404980 [info ] [Thread-4 (]: 4 of 11 OK created sql table model main_idr_out.identity_edges ................. [[32mOK[0m in 0.04s]
[0m18:08:02.405334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b90e270>]}
[0m18:08:02.405627 [debug] [Thread-4 (]: Finished running node model.dbt_idr.identity_edges
[0m18:08:02.406024 [info ] [Thread-1 (]: 5 of 11 OK created sql table model main_idr_work.int_labels .................... [[32mOK[0m in 0.04s]
[0m18:08:02.406269 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.406566 [debug] [Thread-1 (]: Finished running node model.dbt_idr.int_labels
[0m18:08:02.407246 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: Close
[0m18:08:02.407546 [debug] [Thread-2 (]: Began running node model.dbt_idr.identity_membership
[0m18:08:02.407805 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a85ff50>]}
[0m18:08:02.408063 [info ] [Thread-2 (]: 7 of 11 START sql table model main_idr_out.identity_membership ................. [RUN]
[0m18:08:02.408583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_idr.int_edges, now model.dbt_idr.identity_membership)
[0m18:08:02.408400 [info ] [Thread-3 (]: 6 of 11 OK created sql table model main_idr_out.rule_match_audit ............... [[32mOK[0m in 0.04s]
[0m18:08:02.408856 [debug] [Thread-2 (]: Began compiling node model.dbt_idr.identity_membership
[0m18:08:02.409122 [debug] [Thread-3 (]: Finished running node model.dbt_idr.rule_match_audit
[0m18:08:02.411393 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_idr.identity_membership"
[0m18:08:02.411984 [debug] [Thread-2 (]: Began executing node model.dbt_idr.identity_membership
[0m18:08:02.413804 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_idr.identity_membership"
[0m18:08:02.414347 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.identity_membership"
[0m18:08:02.414561 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: BEGIN
[0m18:08:02.414747 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:08:02.415197 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.415476 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.identity_membership"
[0m18:08:02.415705 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_membership"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."identity_membership__dbt_tmp"
  
    as (
      



with labeled_entities as (
    select
        entity_key,
        resolved_id,
        updated_at
    from "test_idr"."main_idr_work"."int_labels"
),

-- Get all entities from staging (for singletons)
all_entities as (
    select distinct entity_key
    from "test_idr"."main_idr_staging"."stg_identifiers"
),

-- Singletons: entities with no edges
singletons as (
    select
        e.entity_key,
        e.entity_key as resolved_id,  -- Singleton is its own cluster
        current_timestamp as updated_at
    from all_entities e
    where not exists (
        select 1 from labeled_entities l where l.entity_key = e.entity_key
    )
),

-- Combine labeled entities and singletons
final as (
    select entity_key, resolved_id, updated_at from labeled_entities
    union all
    select entity_key, resolved_id, updated_at from singletons
)

select * from final
    );
  
  
[0m18:08:02.417372 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.419482 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.identity_membership"
[0m18:08:02.419769 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_membership"} */
alter table "test_idr"."main_idr_out"."identity_membership__dbt_tmp" rename to "identity_membership"
[0m18:08:02.420193 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.421115 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: COMMIT
[0m18:08:02.421316 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.identity_membership"
[0m18:08:02.421500 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: COMMIT
[0m18:08:02.421968 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.423311 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.identity_membership"
[0m18:08:02.423526 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_membership"} */

      drop table if exists "test_idr"."main_idr_out"."identity_membership__dbt_backup" cascade
    
[0m18:08:02.423889 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.424675 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: Close
[0m18:08:02.425030 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f7a870>]}
[0m18:08:02.425397 [info ] [Thread-2 (]: 7 of 11 OK created sql table model main_idr_out.identity_membership ............ [[32mOK[0m in 0.02s]
[0m18:08:02.425710 [debug] [Thread-2 (]: Finished running node model.dbt_idr.identity_membership
[0m18:08:02.426095 [debug] [Thread-1 (]: Began running node model.dbt_idr.identity_clusters
[0m18:08:02.426542 [debug] [Thread-4 (]: Began running node model.dbt_idr.golden_profiles
[0m18:08:02.426372 [info ] [Thread-1 (]: 9 of 11 START sql table model main_idr_out.identity_clusters ................... [RUN]
[0m18:08:02.427067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idr.int_labels, now model.dbt_idr.identity_clusters)
[0m18:08:02.426879 [info ] [Thread-4 (]: 8 of 11 START sql table model main_idr_out.golden_profiles ..................... [RUN]
[0m18:08:02.427343 [debug] [Thread-1 (]: Began compiling node model.dbt_idr.identity_clusters
[0m18:08:02.427552 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_idr.identity_edges, now model.dbt_idr.golden_profiles)
[0m18:08:02.430210 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idr.identity_clusters"
[0m18:08:02.430434 [debug] [Thread-4 (]: Began compiling node model.dbt_idr.golden_profiles
[0m18:08:02.442787 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m18:08:02.443101 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.golden_profiles"} */

    
    select * from "test_idr"."main"."idr_sources" where is_active = true

  
[0m18:08:02.443309 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:08:02.443749 [debug] [Thread-1 (]: Began executing node model.dbt_idr.identity_clusters
[0m18:08:02.445989 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idr.identity_clusters"
[0m18:08:02.446280 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:08:02.447201 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m18:08:02.447413 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.golden_profiles"} */

    
    select * from "test_idr"."main"."idr_attribute_mappings"

  
[0m18:08:02.447745 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.identity_clusters"
[0m18:08:02.447959 [debug] [Thread-1 (]: On model.dbt_idr.identity_clusters: BEGIN
[0m18:08:02.448151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:02.448348 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.449217 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m18:08:02.449447 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.golden_profiles"} */

    
    select * from "test_idr"."main"."idr_survivorship_rules"

  
[0m18:08:02.449730 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:08:02.449932 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.identity_clusters"
[0m18:08:02.450131 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.450390 [debug] [Thread-1 (]: On model.dbt_idr.identity_clusters: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_clusters"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."identity_clusters__dbt_tmp"
  
    as (
      



with cluster_sizes as (
    select
        resolved_id,
        count(*) as cluster_size
    from "test_idr"."main_idr_out"."identity_membership"
    group by resolved_id
),

cluster_edge_stats as (
    select
        m.resolved_id,
        count(distinct e.identifier_type) as edge_diversity,
        count(*) as edge_count
    from "test_idr"."main_idr_out"."identity_membership" m
    inner join "test_idr"."main_idr_work"."int_edges" e
        on e.left_entity_key = m.entity_key 
        or e.right_entity_key = m.entity_key
    group by m.resolved_id
),

max_diversity as (
    select coalesce(max(edge_diversity), 1) as max_edge_diversity
    from cluster_edge_stats
),

clusters_with_confidence as (
    select
        cs.resolved_id,
        cs.cluster_size,
        
        -- Edge diversity (number of identifier types)
        coalesce(es.edge_diversity, 0) as edge_diversity,
        
        -- Match density (actual edges / max possible edges for cluster size)
        case 
            when cs.cluster_size <= 1 then 1.0
            else least(1.0, coalesce(es.edge_count, 0) * 1.0 / greatest(1, cs.cluster_size - 1))
        end as match_density,
        
        -- Confidence score: weighted combination
        case 
            when cs.cluster_size = 1 then 1.0
            else round(
                0.50 * (coalesce(es.edge_diversity, 0) * 1.0 / md.max_edge_diversity) +
                0.35 * least(1.0, coalesce(es.edge_count, 0) * 1.0 / greatest(1, cs.cluster_size - 1)) +
                0.15,
                3
            )
        end as confidence_score,
        
        -- Primary reason
        case 
            when cs.cluster_size = 1 then 'SINGLETON_NO_MATCH_REQUIRED'
            when coalesce(es.edge_diversity, 0) >= 2 then concat(cast(es.edge_diversity as TEXT), ' identifier types')
            else 'Single identifier type'
        end as primary_reason,
        
        current_timestamp as updated_at
        
    from cluster_sizes cs
    left join cluster_edge_stats es on es.resolved_id = cs.resolved_id
    cross join max_diversity md
)

select * from clusters_with_confidence
    );
  
  
[0m18:08:02.455295 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_idr.golden_profiles"
[0m18:08:02.456697 [debug] [Thread-4 (]: Began executing node model.dbt_idr.golden_profiles
[0m18:08:02.458922 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_idr.golden_profiles"
[0m18:08:02.459383 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m18:08:02.459616 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: BEGIN
[0m18:08:02.460167 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.460476 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m18:08:02.460853 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.golden_profiles"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."golden_profiles__dbt_tmp"
  
    as (
      











    
    
    
    
    
    
    





    

    

    

    






    
    
    
    
    
    
    
        
    
    
    
    
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
    
        
    
        
    
        
    
        
    
    
    
    
    
    
    
    
    
    
    
        
        
    
        
        
    
        
        
    
        
        
    
    
    
    
    
    
    

    
    
    
    
    
    
    
        
    
    
    
    
    
        
    
        
    
        
    
        
    
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
    
        
    
    
    
    
    
    
    
    
    
    
    
        
        
    
        
        
    
        
        
    
        
        
    
    
    
    
    
    
    

    
    
    
    
    
    
    
        
    
    
    
    
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            
        
    
        
            
        
    
    
    
    
    
    
    
    
    
    
    
        
        
    
        
        
    
        
        
    
        
        
    
    
    
    
    
    
    


with membership as (
    select distinct resolved_id, entity_key
    from "test_idr"."main_idr_out"."identity_membership"
),

entity_attributes as (
    
        
select 'crm' as source_id,
       concat('crm', ':', cast(customer_id as TEXT)) as entity_key,
       cast(email as TEXT) as email,
       cast(phone as TEXT) as phone,
       cast(first_name as TEXT) as first_name,
       cast(last_name as TEXT) as last_name,
       coalesce(cast(updated_at as timestamp), cast('1900-01-01' as timestamp)) as record_updated_at
from main.sample_crm_customers
    
union all

select 'orders' as source_id,
       concat('orders', ':', cast(order_id as TEXT)) as entity_key,
       cast(customer_email as TEXT) as email,
       cast(contact_phone as TEXT) as phone,
       cast(null as TEXT) as first_name,
       cast(null as TEXT) as last_name,
       coalesce(cast(order_date as timestamp), cast('1900-01-01' as timestamp)) as record_updated_at
from main.sample_orders
    
union all

select 'pos' as source_id,
       concat('pos', ':', cast(transaction_id as TEXT)) as entity_key,
       cast(null as TEXT) as email,
       cast(contact_phone as TEXT) as phone,
       cast(null as TEXT) as first_name,
       cast(null as TEXT) as last_name,
       coalesce(cast(transaction_date as timestamp), cast('1900-01-01' as timestamp)) as record_updated_at
from main.sample_pos_transactions
    
    
),

cluster_entities as (
    select
        m.resolved_id,
        e.*
    from membership m
    left join entity_attributes e on e.entity_key = m.entity_key
)



, email_ranked as (
    select resolved_id, email,
           row_number() over (partition by resolved_id order by record_updated_at desc) as rn
    from cluster_entities
    where email is not null
)

, phone_ranked as (
    select resolved_id, phone,
           row_number() over (partition by resolved_id order by record_updated_at desc) as rn
    from cluster_entities
    where phone is not null
)

, first_name_ranked as (
    select resolved_id, first_name,
           row_number() over (partition by resolved_id order by record_updated_at desc) as rn
    from cluster_entities
    where first_name is not null
)

, last_name_ranked as (
    select resolved_id, last_name,
           row_number() over (partition by resolved_id order by record_updated_at desc) as rn
    from cluster_entities
    where last_name is not null
)



, golden_profiles as (
    select distinct
        m.resolved_id
        
        , email_r.email as email_primary
        
        , phone_r.phone as phone_primary
        
        , first_name_r.first_name as first_name_primary
        
        , last_name_r.last_name as last_name_primary
        
        , current_timestamp as updated_at
    from membership m
    
    left join email_ranked email_r 
        on email_r.resolved_id = m.resolved_id and email_r.rn = 1
    
    left join phone_ranked phone_r 
        on phone_r.resolved_id = m.resolved_id and phone_r.rn = 1
    
    left join first_name_ranked first_name_r 
        on first_name_r.resolved_id = m.resolved_id and first_name_r.rn = 1
    
    left join last_name_ranked last_name_r 
        on last_name_r.resolved_id = m.resolved_id and last_name_r.rn = 1
    
)

select * from golden_profiles
    );
  
  
[0m18:08:02.461736 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:08:02.463394 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.identity_clusters"
[0m18:08:02.463677 [debug] [Thread-1 (]: On model.dbt_idr.identity_clusters: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_clusters"} */
alter table "test_idr"."main_idr_out"."identity_clusters__dbt_tmp" rename to "identity_clusters"
[0m18:08:02.464176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.465225 [debug] [Thread-1 (]: On model.dbt_idr.identity_clusters: COMMIT
[0m18:08:02.465459 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.identity_clusters"
[0m18:08:02.465665 [debug] [Thread-1 (]: On model.dbt_idr.identity_clusters: COMMIT
[0m18:08:02.467942 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:08:02.469982 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.identity_clusters"
[0m18:08:02.470291 [debug] [Thread-1 (]: On model.dbt_idr.identity_clusters: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_clusters"} */

      drop table if exists "test_idr"."main_idr_out"."identity_clusters__dbt_backup" cascade
    
[0m18:08:02.470774 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.471605 [debug] [Thread-1 (]: On model.dbt_idr.identity_clusters: Close
[0m18:08:02.471958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ddd1f0>]}
[0m18:08:02.472333 [info ] [Thread-1 (]: 9 of 11 OK created sql table model main_idr_out.identity_clusters .............. [[32mOK[0m in 0.04s]
[0m18:08:02.472765 [debug] [Thread-1 (]: Finished running node model.dbt_idr.identity_clusters
[0m18:08:02.473117 [debug] [Thread-3 (]: Began running node model.dbt_idr.run_history
[0m18:08:02.473396 [info ] [Thread-3 (]: 10 of 11 START sql table model main_idr_out.run_history ........................ [RUN]
[0m18:08:02.473646 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_idr.rule_match_audit, now model.dbt_idr.run_history)
[0m18:08:02.473859 [debug] [Thread-3 (]: Began compiling node model.dbt_idr.run_history
[0m18:08:02.476778 [debug] [Thread-4 (]: SQL status: OK in 0.016 seconds
[0m18:08:02.478666 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m18:08:02.479008 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.golden_profiles"} */
alter table "test_idr"."main_idr_out"."golden_profiles__dbt_tmp" rename to "golden_profiles"
[0m18:08:02.479627 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.481198 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: COMMIT
[0m18:08:02.481433 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m18:08:02.481640 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: COMMIT
[0m18:08:02.482473 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.483820 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m18:08:02.484066 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.golden_profiles"} */

      drop table if exists "test_idr"."main_idr_out"."golden_profiles__dbt_backup" cascade
    
[0m18:08:02.484545 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.485388 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: Close
[0m18:08:02.485783 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b96a630>]}
[0m18:08:02.486246 [info ] [Thread-4 (]: 8 of 11 OK created sql table model main_idr_out.golden_profiles ................ [[32mOK[0m in 0.06s]
[0m18:08:02.486648 [debug] [Thread-4 (]: Finished running node model.dbt_idr.golden_profiles
[0m18:08:02.487021 [debug] [Thread-2 (]: Began running node model.dbt_idr.stage_metrics
[0m18:08:02.487342 [info ] [Thread-2 (]: 11 of 11 START sql table model main_idr_out.stage_metrics ...................... [RUN]
[0m18:08:02.487706 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_idr.identity_membership, now model.dbt_idr.stage_metrics)
[0m18:08:02.488073 [debug] [Thread-2 (]: Began compiling node model.dbt_idr.stage_metrics
[0m18:08:02.491285 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_idr.stage_metrics"
[0m18:08:02.491804 [debug] [Thread-2 (]: Began executing node model.dbt_idr.stage_metrics
[0m18:08:02.493636 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_idr.stage_metrics"
[0m18:08:02.494217 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m18:08:02.494616 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: BEGIN
[0m18:08:02.494896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:08:02.495470 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.495762 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m18:08:02.496079 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stage_metrics"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."stage_metrics__dbt_tmp"
  
    as (
      



with stages as (
    select 1 as stage_order, 'stg_identifiers' as stage_name, 
           (select count(*) from "test_idr"."main_idr_staging"."stg_identifiers") as rows_out
    union all
    select 2, 'int_edges', 
           (select count(*) from "test_idr"."main_idr_work"."int_edges")
    union all
    select 3, 'int_labels', 
           (select count(*) from "test_idr"."main_idr_work"."int_labels")
    union all
    select 4, 'identity_membership', 
           (select count(*) from "test_idr"."main_idr_out"."identity_membership")
    union all
    select 5, 'identity_clusters', 
           (select count(*) from "test_idr"."main_idr_out"."identity_clusters")
    union all
    select 6, 'golden_profiles', 
           (select count(*) from "test_idr"."main_idr_out"."golden_profiles")
    union all
    select 7, 'skipped_identifier_groups', 
           (select count(*) from "test_idr"."main_idr_out"."skipped_identifier_groups")
)

select
    '3208f48f-6d0f-4e92-b7ba-acf0141b973c' as run_id,
    stage_name,
    stage_order,
    rows_out,
    current_timestamp as recorded_at
from stages
order by stage_order
    );
  
  
[0m18:08:02.498012 [debug] [Thread-3 (]: Compilation Error in model run_history (models/marts/run_history.sql)
  'dict object' has no attribute 'datediff'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:08:02.498308 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9d7c50>]}
[0m18:08:02.498990 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:08:02.498752 [error] [Thread-3 (]: 10 of 11 ERROR creating sql table model main_idr_out.run_history ............... [[31mERROR[0m in 0.02s]
[0m18:08:02.500830 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m18:08:02.501156 [debug] [Thread-3 (]: Finished running node model.dbt_idr.run_history
[0m18:08:02.501431 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stage_metrics"} */
alter table "test_idr"."main_idr_out"."stage_metrics__dbt_tmp" rename to "stage_metrics"
[0m18:08:02.501760 [debug] [Thread-7 (]: Marking all children of 'model.dbt_idr.run_history' to be skipped because of status 'error'.  Reason: Compilation Error in model run_history (models/marts/run_history.sql)
  'dict object' has no attribute 'datediff'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m18:08:02.502785 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:08:02.503731 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: COMMIT
[0m18:08:02.503933 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m18:08:02.504118 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: COMMIT
[0m18:08:02.504654 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.506047 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m18:08:02.506288 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stage_metrics"} */

      drop table if exists "test_idr"."main_idr_out"."stage_metrics__dbt_backup" cascade
    
[0m18:08:02.506614 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m18:08:02.507300 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: Close
[0m18:08:02.507574 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3208f48f-6d0f-4e92-b7ba-acf0141b973c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9a9550>]}
[0m18:08:02.507896 [info ] [Thread-2 (]: 11 of 11 OK created sql table model main_idr_out.stage_metrics ................. [[32mOK[0m in 0.02s]
[0m18:08:02.508188 [debug] [Thread-2 (]: Finished running node model.dbt_idr.stage_metrics
[0m18:08:02.508970 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:02.509146 [debug] [MainThread]: On master: BEGIN
[0m18:08:02.509304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:08:02.509579 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:02.509743 [debug] [MainThread]: On master: COMMIT
[0m18:08:02.509900 [debug] [MainThread]: Using duckdb connection "master"
[0m18:08:02.510053 [debug] [MainThread]: On master: COMMIT
[0m18:08:02.510396 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:08:02.510662 [debug] [MainThread]: On master: Close
[0m18:08:02.510883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:02.511037 [debug] [MainThread]: Connection 'model.dbt_idr.identity_clusters' was properly closed.
[0m18:08:02.511181 [debug] [MainThread]: Connection 'model.dbt_idr.stage_metrics' was properly closed.
[0m18:08:02.511322 [debug] [MainThread]: Connection 'model.dbt_idr.run_history' was properly closed.
[0m18:08:02.511468 [debug] [MainThread]: Connection 'model.dbt_idr.golden_profiles' was properly closed.
[0m18:08:02.511681 [info ] [MainThread]: 
[0m18:08:02.511857 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m18:08:02.512778 [debug] [MainThread]: Command end result
[0m18:08:02.539587 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m18:08:02.540714 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m18:08:02.544644 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/run_results.json
[0m18:08:02.544918 [info ] [MainThread]: 
[0m18:08:02.545143 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:08:02.545339 [info ] [MainThread]: 
[0m18:08:02.545575 [error] [MainThread]: [31mFailure in model run_history (models/marts/run_history.sql)[0m
[0m18:08:02.545799 [error] [MainThread]:   Compilation Error in model run_history (models/marts/run_history.sql)
  'dict object' has no attribute 'datediff'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m18:08:02.545989 [info ] [MainThread]: 
[0m18:08:02.546185 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=11
[0m18:08:02.547589 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9256369, "process_in_blocks": "0", "process_kernel_time": 0.179158, "process_mem_max_rss": "181944320", "process_out_blocks": "0", "process_user_time": 1.628378}
[0m18:08:02.547857 [debug] [MainThread]: Command `dbt run` failed at 18:08:02.547814 after 0.93 seconds
[0m18:08:02.548079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088fffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a85e3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a85ffb0>]}
[0m18:08:02.548294 [debug] [MainThread]: Flushing usage events
[0m18:08:02.949550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:23.773207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119810590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaa7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaa7890>]}


============================== 20:07:23.776530 | 2108e881-0b65-4765-91e3-a32a56bd4430 ==============================
[0m20:07:23.776530 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:07:23.776914 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '.', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'quiet': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'invocation_command': 'dbt deps --profiles-dir .', 'empty': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'static_parser': 'True', 'write_json': 'True', 'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'printer_width': '80'}
[0m20:07:23.848792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2108e881-0b65-4765-91e3-a32a56bd4430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199bd810>]}
[0m20:07:23.880699 [debug] [MainThread]: Set downloads directory='/var/folders/pt/f4g5v3rd52xd_n4yxjprb57h0000gn/T/dbt-downloads-uo0r8w6e'
[0m20:07:23.880993 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:07:24.043090 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:07:24.044646 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:07:24.083485 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:07:24.087629 [info ] [MainThread]: Installing ../
[0m20:07:24.089634 [debug] [MainThread]: Creating symlink to local dependency.
[0m20:07:24.089974 [info ] [MainThread]: Installed from <local @ ../>
[0m20:07:24.090251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2108e881-0b65-4765-91e3-a32a56bd4430', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a946e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a946ad0>]}
[0m20:07:24.090535 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:07:24.270610 [info ] [MainThread]: Installed from version 1.3.3
[0m20:07:24.270914 [info ] [MainThread]: Up to date!
[0m20:07:24.271138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2108e881-0b65-4765-91e3-a32a56bd4430', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac63450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac5fd40>]}
[0m20:07:24.278322 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5536717, "process_in_blocks": "0", "process_kernel_time": 0.212169, "process_mem_max_rss": "117293056", "process_out_blocks": "0", "process_user_time": 0.967591}
[0m20:07:24.278723 [debug] [MainThread]: Command `dbt deps` succeeded at 20:07:24.278663 after 0.55 seconds
[0m20:07:24.278961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a91fe70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abf1b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acaedd0>]}
[0m20:07:24.279196 [debug] [MainThread]: Flushing usage events
[0m20:07:24.740438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:25.922825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105567610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105567890>]}


============================== 20:07:25.925431 | a8ca6f01-b97b-4451-97cc-03ad6de4f3f0 ==============================
[0m20:07:25.925431 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:07:25.925813 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'static_parser': 'True', 'quiet': 'False', 'fail_fast': 'False', 'debug': 'False', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': '.', 'log_format': 'default', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'printer_width': '80', 'invocation_command': 'dbt seed --profiles-dir .', 'empty': 'None', 'partial_parse': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False'}
[0m20:07:26.122543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104881810>]}
[0m20:07:26.158309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105407790>]}
[0m20:07:26.160738 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:07:26.234914 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:07:26.334666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:07:26.335254 [debug] [MainThread]: Partial parsing: updated file: dbt_idr://models/marts/run_history.sql
[0m20:07:26.625755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599f050>]}
[0m20:07:26.705604 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m20:07:26.707779 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m20:07:26.721997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a96300>]}
[0m20:07:26.722332 [info ] [MainThread]: Found 35 data tests, 15 seeds, 11 models, 6 sources, 591 macros
[0m20:07:26.722560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e7a6d0>]}
[0m20:07:26.724371 [info ] [MainThread]: 
[0m20:07:26.724610 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:07:26.724790 [info ] [MainThread]: 
[0m20:07:26.725068 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:07:26.728309 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m20:07:26.735135 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m20:07:26.769528 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m20:07:26.769841 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m20:07:26.770056 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m20:07:26.770267 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m20:07:26.770462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:26.770640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:26.786848 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m20:07:26.787330 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:07:26.788078 [debug] [ThreadPool]: On list_test_idr: Close
[0m20:07:26.788744 [debug] [ThreadPool]: On list_test_idr: Close
[0m20:07:26.789226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main)
[0m20:07:26.789445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_meta)
[0m20:07:26.789698 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main"
"
[0m20:07:26.789982 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_meta"
"
[0m20:07:26.793985 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m20:07:26.796572 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m20:07:26.796795 [debug] [ThreadPool]: On create_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m20:07:26.797015 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_meta"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m20:07:26.797219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:26.797391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:26.798339 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:26.798530 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:26.799312 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m20:07:26.799498 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: BEGIN
[0m20:07:26.800138 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m20:07:26.800366 [debug] [ThreadPool]: On create_test_idr_main: BEGIN
[0m20:07:26.800576 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:26.800757 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m20:07:26.800923 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:26.801091 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_meta"} */

    
    
        create schema if not exists "test_idr"."main_idr_meta"
    
[0m20:07:26.801267 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m20:07:26.801483 [debug] [ThreadPool]: On create_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main"} */

    
    
        create schema if not exists "test_idr"."main"
    
[0m20:07:26.801773 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:26.801973 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:26.802464 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: COMMIT
[0m20:07:26.802940 [debug] [ThreadPool]: On create_test_idr_main: COMMIT
[0m20:07:26.803114 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_meta"
[0m20:07:26.803300 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main"
[0m20:07:26.803476 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: COMMIT
[0m20:07:26.803641 [debug] [ThreadPool]: On create_test_idr_main: COMMIT
[0m20:07:26.803964 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:26.804164 [debug] [ThreadPool]: On create_test_idr_main: Close
[0m20:07:26.804474 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:26.804646 [debug] [ThreadPool]: On create_test_idr_main_idr_meta: Close
[0m20:07:26.806106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_meta, now list_test_idr_main)
[0m20:07:26.809287 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m20:07:26.809477 [debug] [ThreadPool]: On list_test_idr_main: BEGIN
[0m20:07:26.809707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main, now list_test_idr_main_idr_meta)
[0m20:07:26.809969 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_staging'
[0m20:07:26.810133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:26.810382 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_work'
[0m20:07:26.811557 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m20:07:26.812549 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m20:07:26.813588 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m20:07:26.813767 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: BEGIN
[0m20:07:26.813934 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: BEGIN
[0m20:07:26.814089 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m20:07:26.814247 [debug] [ThreadPool]: On list_test_idr_main_idr_work: BEGIN
[0m20:07:26.814400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:26.814557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:26.814719 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m20:07:26.814876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:26.815242 [debug] [ThreadPool]: On list_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:26.815446 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:26.815699 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:26.816083 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m20:07:26.816264 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:26.816434 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m20:07:26.816609 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_staging"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_staging'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:26.816783 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m20:07:26.816956 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_meta"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_meta'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:26.817244 [debug] [ThreadPool]: On list_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_work"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_work'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:26.826188 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:07:26.826426 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:07:26.826633 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:07:26.826888 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:07:26.827797 [debug] [ThreadPool]: On list_test_idr_main: ROLLBACK
[0m20:07:26.828499 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: ROLLBACK
[0m20:07:26.829163 [debug] [ThreadPool]: On list_test_idr_main_idr_work: ROLLBACK
[0m20:07:26.829867 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: ROLLBACK
[0m20:07:26.830793 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main'
[0m20:07:26.830985 [debug] [ThreadPool]: On list_test_idr_main: Close
[0m20:07:26.831275 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_meta'
[0m20:07:26.831558 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_work'
[0m20:07:26.831766 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: Close
[0m20:07:26.832035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr_main, now list_test_idr_main_idr_out)
[0m20:07:26.832362 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_staging'
[0m20:07:26.832598 [debug] [ThreadPool]: On list_test_idr_main_idr_work: Close
[0m20:07:26.833755 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m20:07:26.833955 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: Close
[0m20:07:26.834211 [debug] [ThreadPool]: On list_test_idr_main_idr_out: BEGIN
[0m20:07:26.834456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:26.834828 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:26.835026 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m20:07:26.835210 [debug] [ThreadPool]: On list_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_out"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_out'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:26.837036 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:07:26.837741 [debug] [ThreadPool]: On list_test_idr_main_idr_out: ROLLBACK
[0m20:07:26.838056 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_out'
[0m20:07:26.838227 [debug] [ThreadPool]: On list_test_idr_main_idr_out: Close
[0m20:07:26.838605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ef110>]}
[0m20:07:26.838888 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:26.839058 [debug] [MainThread]: On master: BEGIN
[0m20:07:26.839214 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:26.839486 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:26.839656 [debug] [MainThread]: On master: COMMIT
[0m20:07:26.839818 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:26.840005 [debug] [MainThread]: On master: COMMIT
[0m20:07:26.840280 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:26.840457 [debug] [MainThread]: On master: Close
[0m20:07:26.841955 [debug] [Thread-1 (]: Began running node seed.dbt_idr.idr_attribute_mappings
[0m20:07:26.842191 [debug] [Thread-3 (]: Began running node seed.dbt_idr.idr_identifier_mappings
[0m20:07:26.842402 [debug] [Thread-4 (]: Began running node seed.dbt_idr.idr_rules
[0m20:07:26.842593 [debug] [Thread-2 (]: Began running node seed.dbt_idr.idr_exclusions
[0m20:07:26.842877 [info ] [Thread-1 (]: 1 of 15 START seed file main_idr_meta.idr_attribute_mappings ................... [RUN]
[0m20:07:26.843192 [info ] [Thread-3 (]: 3 of 15 START seed file main_idr_meta.idr_identifier_mappings .................. [RUN]
[0m20:07:26.843488 [info ] [Thread-4 (]: 4 of 15 START seed file main_idr_meta.idr_rules ................................ [RUN]
[0m20:07:26.843774 [info ] [Thread-2 (]: 2 of 15 START seed file main_idr_meta.idr_exclusions ........................... [RUN]
[0m20:07:26.844036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_out, now seed.dbt_idr.idr_attribute_mappings)
[0m20:07:26.844265 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_staging, now seed.dbt_idr.idr_identifier_mappings)
[0m20:07:26.844479 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_work, now seed.dbt_idr.idr_rules)
[0m20:07:26.844680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_meta, now seed.dbt_idr.idr_exclusions)
[0m20:07:26.844883 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr.idr_attribute_mappings
[0m20:07:26.845082 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr.idr_identifier_mappings
[0m20:07:26.845271 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr.idr_rules
[0m20:07:26.845457 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr.idr_exclusions
[0m20:07:26.845664 [debug] [Thread-1 (]: Began executing node seed.dbt_idr.idr_attribute_mappings
[0m20:07:26.845867 [debug] [Thread-3 (]: Began executing node seed.dbt_idr.idr_identifier_mappings
[0m20:07:26.846057 [debug] [Thread-4 (]: Began executing node seed.dbt_idr.idr_rules
[0m20:07:26.846245 [debug] [Thread-2 (]: Began executing node seed.dbt_idr.idr_exclusions
[0m20:07:26.868204 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m20:07:26.868471 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: BEGIN
[0m20:07:26.868677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:26.869011 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m20:07:26.869811 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m20:07:26.870595 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m20:07:26.870857 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: BEGIN
[0m20:07:26.871065 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: BEGIN
[0m20:07:26.871266 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:07:26.871459 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: BEGIN
[0m20:07:26.871644 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:26.871826 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:26.872008 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m20:07:26.872187 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:26.872581 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_attribute_mappings"} */

    create table "test_idr"."main_idr_meta"."idr_attribute_mappings" ("source_id" text,"attribute_name" text,"column_expr" text,"description" text)
  
[0m20:07:26.872907 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.873235 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.873490 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.873793 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m20:07:26.874130 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m20:07:26.874373 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m20:07:26.874591 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_identifier_mappings"} */

    create table "test_idr"."main_idr_meta"."idr_identifier_mappings" ("source_id" text,"identifier_type" text,"column_name" text,"is_hashed" boolean,"description" text)
  
[0m20:07:26.874833 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:26.875030 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_rules"} */

    create table "test_idr"."main_idr_meta"."idr_rules" ("rule_id" text,"identifier_type" text,"priority" integer,"is_active" boolean,"canonicalize" text,"max_group_size" integer,"description" text)
  
[0m20:07:26.875246 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_exclusions"} */

    create table "test_idr"."main_idr_meta"."idr_exclusions" ("identifier_type" text,"identifier_value_pattern" text,"match_type" text,"reason" text)
  
[0m20:07:26.882668 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m20:07:26.882933 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m20:07:26.883327 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:07:26.883560 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: 
          COPY "test_idr"."main_idr_meta"."idr_attribute_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_attribute_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:26.883776 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.884484 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m20:07:26.885190 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m20:07:26.885950 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m20:07:26.886194 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: 
          COPY "test_idr"."main_idr_meta"."idr_identifier_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_identifier_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:26.886463 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: 
          COPY "test_idr"."main_idr_meta"."idr_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:26.886724 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: 
          COPY "test_idr"."main_idr_meta"."idr_exclusions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_exclusions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:26.895973 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m20:07:26.896286 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m20:07:26.896513 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m20:07:26.900039 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr.idr_identifier_mappings"
[0m20:07:26.900261 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m20:07:26.900653 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr.idr_exclusions"
[0m20:07:26.901048 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr.idr_attribute_mappings"
[0m20:07:26.901533 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr.idr_rules"
[0m20:07:26.910123 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: COMMIT
[0m20:07:26.910381 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_identifier_mappings"
[0m20:07:26.910656 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: COMMIT
[0m20:07:26.911704 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: COMMIT
[0m20:07:26.912613 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: COMMIT
[0m20:07:26.913574 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: COMMIT
[0m20:07:26.913839 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr.idr_exclusions"
[0m20:07:26.914071 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr.idr_attribute_mappings"
[0m20:07:26.914309 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_rules"
[0m20:07:26.914515 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: COMMIT
[0m20:07:26.914715 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:07:26.914911 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: COMMIT
[0m20:07:26.915123 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: COMMIT
[0m20:07:26.916218 [debug] [Thread-3 (]: On seed.dbt_idr.idr_identifier_mappings: Close
[0m20:07:26.916612 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.917085 [debug] [Thread-2 (]: On seed.dbt_idr.idr_exclusions: Close
[0m20:07:26.917332 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.918397 [debug] [Thread-4 (]: On seed.dbt_idr.idr_rules: Close
[0m20:07:26.918661 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:26.919274 [debug] [Thread-1 (]: On seed.dbt_idr.idr_attribute_mappings: Close
[0m20:07:26.919791 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106384590>]}
[0m20:07:26.919991 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613d180>]}
[0m20:07:26.920223 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630fa70>]}
[0m20:07:26.920411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481f250>]}
[0m20:07:26.920674 [info ] [Thread-3 (]: 3 of 15 OK loaded seed file main_idr_meta.idr_identifier_mappings .............. [[32mINSERT 5[0m in 0.07s]
[0m20:07:26.920987 [info ] [Thread-4 (]: 4 of 15 OK loaded seed file main_idr_meta.idr_rules ............................ [[32mINSERT 4[0m in 0.07s]
[0m20:07:26.921211 [info ] [Thread-2 (]: 2 of 15 OK loaded seed file main_idr_meta.idr_exclusions ....................... [[32mINSERT 5[0m in 0.07s]
[0m20:07:26.921853 [debug] [Thread-3 (]: Finished running node seed.dbt_idr.idr_identifier_mappings
[0m20:07:26.921500 [info ] [Thread-1 (]: 1 of 15 OK loaded seed file main_idr_meta.idr_attribute_mappings ............... [[32mINSERT 10[0m in 0.08s]
[0m20:07:26.922204 [debug] [Thread-4 (]: Finished running node seed.dbt_idr.idr_rules
[0m20:07:26.922489 [debug] [Thread-2 (]: Finished running node seed.dbt_idr.idr_exclusions
[0m20:07:26.922732 [debug] [Thread-3 (]: Began running node seed.dbt_idr.idr_sources
[0m20:07:26.923034 [debug] [Thread-1 (]: Finished running node seed.dbt_idr.idr_attribute_mappings
[0m20:07:26.923248 [debug] [Thread-4 (]: Began running node seed.dbt_idr.idr_survivorship_rules
[0m20:07:26.923480 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m20:07:26.923749 [info ] [Thread-3 (]: 5 of 15 START seed file main_idr_meta.idr_sources .............................. [RUN]
[0m20:07:26.924022 [debug] [Thread-1 (]: Began running node seed.dbt_idr_integration_tests.idr_exclusions
[0m20:07:26.924306 [info ] [Thread-4 (]: 6 of 15 START seed file main_idr_meta.idr_survivorship_rules ................... [RUN]
[0m20:07:26.924579 [info ] [Thread-2 (]: 7 of 15 START seed file main.idr_attribute_mappings ............................ [RUN]
[0m20:07:26.924832 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_identifier_mappings, now seed.dbt_idr.idr_sources)
[0m20:07:26.925085 [info ] [Thread-1 (]: 8 of 15 START seed file main.idr_exclusions .................................... [RUN]
[0m20:07:26.925312 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_rules, now seed.dbt_idr.idr_survivorship_rules)
[0m20:07:26.925532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_exclusions, now seed.dbt_idr_integration_tests.idr_attribute_mappings)
[0m20:07:26.925736 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr.idr_sources
[0m20:07:26.925945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_attribute_mappings, now seed.dbt_idr_integration_tests.idr_exclusions)
[0m20:07:26.926140 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr.idr_survivorship_rules
[0m20:07:26.926335 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m20:07:26.926590 [debug] [Thread-3 (]: Began executing node seed.dbt_idr.idr_sources
[0m20:07:26.926789 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr_integration_tests.idr_exclusions
[0m20:07:26.927009 [debug] [Thread-4 (]: Began executing node seed.dbt_idr.idr_survivorship_rules
[0m20:07:26.927216 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m20:07:26.929244 [debug] [Thread-1 (]: Began executing node seed.dbt_idr_integration_tests.idr_exclusions
[0m20:07:26.934560 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m20:07:26.934810 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: BEGIN
[0m20:07:26.935095 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:26.935956 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m20:07:26.936185 [debug] [Thread-4 (]: On seed.dbt_idr.idr_survivorship_rules: BEGIN
[0m20:07:26.936381 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:26.937055 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m20:07:26.937256 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: BEGIN
[0m20:07:26.937441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:26.938938 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m20:07:26.939221 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:07:26.939481 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: BEGIN
[0m20:07:26.939669 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:07:26.939859 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:07:26.940122 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m20:07:26.940306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:26.940489 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m20:07:26.940686 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m20:07:26.940893 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_attribute_mappings"} */

    create table "test_idr"."main"."idr_attribute_mappings" ("source_id" text,"attribute_name" text,"column_expr" text,"description" text)
  
[0m20:07:26.941196 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_sources"} */

    create table "test_idr"."main_idr_meta"."idr_sources" ("source_id" text,"source_name" text,"database" text,"schema" text,"table_name" text,"entity_key_column" text,"watermark_column" text,"is_active" boolean,"description" text)
  
[0m20:07:26.941412 [debug] [Thread-4 (]: On seed.dbt_idr.idr_survivorship_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr.idr_survivorship_rules"} */

    create table "test_idr"."main_idr_meta"."idr_survivorship_rules" ("attribute_name" text,"strategy" text,"source_priority_list" text,"recency_field" text,"description" text)
  
[0m20:07:26.941629 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.942125 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:07:26.942354 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m20:07:26.942541 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.943269 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m20:07:26.943460 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.943662 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_exclusions"} */

    create table "test_idr"."main"."idr_exclusions" ("identifier_type" text,"identifier_value_pattern" text,"match_type" text,"reason" text)
  
[0m20:07:26.944307 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m20:07:26.944511 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: 
          COPY "test_idr"."main"."idr_attribute_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_attribute_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:26.945148 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m20:07:26.945447 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: 
          COPY "test_idr"."main_idr_meta"."idr_sources" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_sources.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:26.945687 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:26.945950 [debug] [Thread-4 (]: On seed.dbt_idr.idr_survivorship_rules: 
          COPY "test_idr"."main_idr_meta"."idr_survivorship_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/dbt_packages/dbt_idr/seeds/idr_survivorship_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:26.946822 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m20:07:26.947226 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: 
          COPY "test_idr"."main"."idr_exclusions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_exclusions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:26.947505 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:07:26.948057 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m20:07:26.948488 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.948788 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:07:26.949305 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr.idr_survivorship_rules"
[0m20:07:26.950349 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: COMMIT
[0m20:07:26.950762 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr.idr_sources"
[0m20:07:26.950979 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:07:26.951248 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_attribute_mappings"
[0m20:07:26.951708 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_exclusions"
[0m20:07:26.951963 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: COMMIT
[0m20:07:26.953128 [debug] [Thread-4 (]: On seed.dbt_idr.idr_survivorship_rules: COMMIT
[0m20:07:26.954095 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: COMMIT
[0m20:07:26.955075 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: COMMIT
[0m20:07:26.955294 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr.idr_survivorship_rules"
[0m20:07:26.955502 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr.idr_sources"
[0m20:07:26.955710 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.955915 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_exclusions"
[0m20:07:26.956129 [debug] [Thread-4 (]: On seed.dbt_idr.idr_survivorship_rules: COMMIT
[0m20:07:26.956320 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: COMMIT
[0m20:07:26.956703 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_attribute_mappings: Close
[0m20:07:26.956903 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: COMMIT
[0m20:07:26.957410 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10637f7e0>]}
[0m20:07:26.957741 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.957961 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.958365 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.958778 [debug] [Thread-4 (]: On seed.dbt_idr.idr_survivorship_rules: Close
[0m20:07:26.958208 [info ] [Thread-2 (]: 7 of 15 OK loaded seed file main.idr_attribute_mappings ........................ [[32mINSERT 10[0m in 0.03s]
[0m20:07:26.959243 [debug] [Thread-3 (]: On seed.dbt_idr.idr_sources: Close
[0m20:07:26.959622 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_exclusions: Close
[0m20:07:26.959927 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631b0b0>]}
[0m20:07:26.960244 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.idr_attribute_mappings
[0m20:07:26.960545 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106318830>]}
[0m20:07:26.960803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063194f0>]}
[0m20:07:26.961269 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m20:07:26.961084 [info ] [Thread-4 (]: 6 of 15 OK loaded seed file main_idr_meta.idr_survivorship_rules ............... [[32mINSERT 5[0m in 0.03s]
[0m20:07:26.961635 [info ] [Thread-3 (]: 5 of 15 OK loaded seed file main_idr_meta.idr_sources .......................... [[32mINSERT 3[0m in 0.04s]
[0m20:07:26.962405 [debug] [Thread-4 (]: Finished running node seed.dbt_idr.idr_survivorship_rules
[0m20:07:26.961850 [info ] [Thread-1 (]: 8 of 15 OK loaded seed file main.idr_exclusions ................................ [[32mINSERT 2[0m in 0.03s]
[0m20:07:26.962749 [debug] [Thread-3 (]: Finished running node seed.dbt_idr.idr_sources
[0m20:07:26.962149 [info ] [Thread-2 (]: 9 of 15 START seed file main.idr_identifier_mappings ........................... [RUN]
[0m20:07:26.963031 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.idr_rules
[0m20:07:26.963321 [debug] [Thread-1 (]: Finished running node seed.dbt_idr_integration_tests.idr_exclusions
[0m20:07:26.963532 [debug] [Thread-3 (]: Began running node seed.dbt_idr_integration_tests.idr_sources
[0m20:07:26.963759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_attribute_mappings, now seed.dbt_idr_integration_tests.idr_identifier_mappings)
[0m20:07:26.964029 [info ] [Thread-4 (]: 10 of 15 START seed file main.idr_rules ........................................ [RUN]
[0m20:07:26.964303 [debug] [Thread-1 (]: Began running node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m20:07:26.964742 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m20:07:26.964569 [info ] [Thread-3 (]: 11 of 15 START seed file main.idr_sources ...................................... [RUN]
[0m20:07:26.965040 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_survivorship_rules, now seed.dbt_idr_integration_tests.idr_rules)
[0m20:07:26.965489 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m20:07:26.965310 [info ] [Thread-1 (]: 12 of 15 START seed file main.idr_survivorship_rules ........................... [RUN]
[0m20:07:26.965782 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_idr.idr_sources, now seed.dbt_idr_integration_tests.idr_sources)
[0m20:07:26.966000 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.idr_rules
[0m20:07:26.967345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_exclusions, now seed.dbt_idr_integration_tests.idr_survivorship_rules)
[0m20:07:26.967645 [debug] [Thread-3 (]: Began compiling node seed.dbt_idr_integration_tests.idr_sources
[0m20:07:26.968380 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.idr_rules
[0m20:07:26.968654 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m20:07:26.969027 [debug] [Thread-3 (]: Began executing node seed.dbt_idr_integration_tests.idr_sources
[0m20:07:26.969605 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m20:07:26.971588 [debug] [Thread-1 (]: Began executing node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m20:07:26.972439 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m20:07:26.974664 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m20:07:26.974904 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: BEGIN
[0m20:07:26.976660 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_rules: BEGIN
[0m20:07:26.977473 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m20:07:26.977693 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: BEGIN
[0m20:07:26.977899 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:26.978088 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:26.978280 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: BEGIN
[0m20:07:26.978463 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:26.978946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:26.979341 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.979583 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:07:26.979882 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m20:07:26.980109 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:07:26.980321 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m20:07:26.980564 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_rules"} */

    create table "test_idr"."main"."idr_rules" ("rule_id" text,"identifier_type" text,"priority" integer,"is_active" boolean,"canonicalize" text,"max_group_size" integer,"description" text)
  
[0m20:07:26.980782 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:26.980983 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m20:07:26.981188 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_identifier_mappings"} */

    create table "test_idr"."main"."idr_identifier_mappings" ("source_id" text,"identifier_type" text,"column_name" text,"is_hashed" boolean,"description" text)
  
[0m20:07:26.981503 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m20:07:26.981726 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_sources"} */

    create table "test_idr"."main"."idr_sources" ("source_id" text,"source_name" text,"database" integer,"schema" text,"table_name" text,"entity_key_column" text,"watermark_column" text,"is_active" boolean,"description" text)
  
[0m20:07:26.981960 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.982228 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.idr_survivorship_rules"} */

    create table "test_idr"."main"."idr_survivorship_rules" ("attribute_name" text,"strategy" text,"source_priority_list" integer,"recency_field" text,"description" text)
  
[0m20:07:26.982629 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:07:26.983450 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m20:07:26.983782 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.984668 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m20:07:26.984927 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_rules: 
          COPY "test_idr"."main"."idr_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:26.985596 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m20:07:26.985794 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:26.986016 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: 
          COPY "test_idr"."main"."idr_identifier_mappings" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_identifier_mappings.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:26.986333 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: 
          COPY "test_idr"."main"."idr_sources" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_sources.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:26.986997 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m20:07:26.987373 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: 
          COPY "test_idr"."main"."idr_survivorship_rules" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/idr_survivorship_rules.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:26.987733 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:07:26.988132 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_rules"
[0m20:07:26.988578 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.988990 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m20:07:26.990153 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_rules: COMMIT
[0m20:07:26.990429 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_rules"
[0m20:07:26.990639 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_rules: COMMIT
[0m20:07:26.990873 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:07:26.991099 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m20:07:26.991513 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m20:07:26.991897 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.idr_sources"
[0m20:07:26.992127 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.993193 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: COMMIT
[0m20:07:26.993594 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.idr_rules: Close
[0m20:07:26.993875 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_identifier_mappings"
[0m20:07:26.994794 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: COMMIT
[0m20:07:26.995138 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665d550>]}
[0m20:07:26.995400 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: COMMIT
[0m20:07:26.996356 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: COMMIT
[0m20:07:26.996563 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_survivorship_rules"
[0m20:07:26.996918 [info ] [Thread-4 (]: 10 of 15 OK loaded seed file main.idr_rules .................................... [[32mINSERT 3[0m in 0.03s]
[0m20:07:26.997263 [debug] [Thread-3 (]: Using duckdb connection "seed.dbt_idr_integration_tests.idr_sources"
[0m20:07:26.997494 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: COMMIT
[0m20:07:26.997705 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.998002 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.idr_rules
[0m20:07:26.998215 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: COMMIT
[0m20:07:26.998663 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.idr_identifier_mappings: Close
[0m20:07:26.998908 [debug] [Thread-4 (]: Began running node seed.dbt_idr_integration_tests.sample_crm_customers
[0m20:07:26.999143 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:26.999487 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665c7d0>]}
[0m20:07:26.999770 [info ] [Thread-4 (]: 13 of 15 START seed file main.sample_crm_customers ............................. [RUN]
[0m20:07:26.999999 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:27.000378 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.idr_survivorship_rules: Close
[0m20:07:27.000874 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_rules, now seed.dbt_idr_integration_tests.sample_crm_customers)
[0m20:07:27.000681 [info ] [Thread-2 (]: 9 of 15 OK loaded seed file main.idr_identifier_mappings ....................... [[32mINSERT 6[0m in 0.04s]
[0m20:07:27.001316 [debug] [Thread-3 (]: On seed.dbt_idr_integration_tests.idr_sources: Close
[0m20:07:27.001588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631be90>]}
[0m20:07:27.001796 [debug] [Thread-4 (]: Began compiling node seed.dbt_idr_integration_tests.sample_crm_customers
[0m20:07:27.002086 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.idr_identifier_mappings
[0m20:07:27.002448 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665d790>]}
[0m20:07:27.002950 [debug] [Thread-4 (]: Began executing node seed.dbt_idr_integration_tests.sample_crm_customers
[0m20:07:27.002765 [info ] [Thread-1 (]: 12 of 15 OK loaded seed file main.idr_survivorship_rules ....................... [[32mINSERT 4[0m in 0.03s]
[0m20:07:27.003232 [debug] [Thread-2 (]: Began running node seed.dbt_idr_integration_tests.sample_orders
[0m20:07:27.003527 [info ] [Thread-3 (]: 11 of 15 OK loaded seed file main.idr_sources .................................. [[32mINSERT 3[0m in 0.04s]
[0m20:07:27.005560 [debug] [Thread-1 (]: Finished running node seed.dbt_idr_integration_tests.idr_survivorship_rules
[0m20:07:27.005864 [info ] [Thread-2 (]: 14 of 15 START seed file main.sample_orders .................................... [RUN]
[0m20:07:27.006248 [debug] [Thread-3 (]: Finished running node seed.dbt_idr_integration_tests.idr_sources
[0m20:07:27.006836 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m20:07:27.007077 [debug] [Thread-1 (]: Began running node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m20:07:27.007342 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_identifier_mappings, now seed.dbt_idr_integration_tests.sample_orders)
[0m20:07:27.007612 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: BEGIN
[0m20:07:27.008051 [info ] [Thread-1 (]: 15 of 15 START seed file main.sample_pos_transactions .......................... [RUN]
[0m20:07:27.008377 [debug] [Thread-2 (]: Began compiling node seed.dbt_idr_integration_tests.sample_orders
[0m20:07:27.008663 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:27.008941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_idr_integration_tests.idr_survivorship_rules, now seed.dbt_idr_integration_tests.sample_pos_transactions)
[0m20:07:27.009179 [debug] [Thread-2 (]: Began executing node seed.dbt_idr_integration_tests.sample_orders
[0m20:07:27.009514 [debug] [Thread-1 (]: Began compiling node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m20:07:27.011222 [debug] [Thread-1 (]: Began executing node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m20:07:27.011459 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:07:27.015826 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m20:07:27.016586 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m20:07:27.017176 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m20:07:27.017392 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: BEGIN
[0m20:07:27.017604 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_crm_customers"} */

    create table "test_idr"."main"."sample_crm_customers" ("customer_id" varchar,"email" varchar,"phone" varchar,"first_name" varchar,"last_name" varchar,"loyalty_id" varchar,"updated_at" varchar)
  
[0m20:07:27.017807 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: BEGIN
[0m20:07:27.018004 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:27.018224 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:27.018753 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:27.019480 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m20:07:27.019686 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: 
          COPY "test_idr"."main"."sample_crm_customers" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_crm_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:27.019985 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:07:27.020292 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m20:07:27.020502 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_orders"} */

    create table "test_idr"."main"."sample_orders" ("order_id" varchar,"customer_email" varchar,"contact_phone" varchar,"order_date" varchar)
  
[0m20:07:27.020807 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:07:27.021052 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m20:07:27.021275 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:27.021554 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "seed.dbt_idr_integration_tests.sample_pos_transactions"} */

    create table "test_idr"."main"."sample_pos_transactions" ("transaction_id" varchar,"loyalty_card_id" varchar,"contact_phone" varchar,"transaction_date" varchar)
  
[0m20:07:27.022338 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m20:07:27.022701 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:07:27.022968 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: 
          COPY "test_idr"."main"."sample_orders" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:27.023193 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:27.023595 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m20:07:27.024415 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m20:07:27.024714 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: 
          COPY "test_idr"."main"."sample_pos_transactions" FROM '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/seeds/sample_pos_transactions.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m20:07:27.025890 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: COMMIT
[0m20:07:27.026129 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:07:27.026361 [debug] [Thread-4 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_crm_customers"
[0m20:07:27.026565 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:27.026952 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_orders"
[0m20:07:27.027163 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: COMMIT
[0m20:07:27.027542 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m20:07:27.028715 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: COMMIT
[0m20:07:27.028927 [debug] [Thread-2 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_orders"
[0m20:07:27.029156 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: COMMIT
[0m20:07:27.030103 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: COMMIT
[0m20:07:27.030314 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:07:27.030573 [debug] [Thread-1 (]: Using duckdb connection "seed.dbt_idr_integration_tests.sample_pos_transactions"
[0m20:07:27.030970 [debug] [Thread-4 (]: On seed.dbt_idr_integration_tests.sample_crm_customers: Close
[0m20:07:27.031184 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: COMMIT
[0m20:07:27.031376 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:27.031716 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631be90>]}
[0m20:07:27.032129 [debug] [Thread-2 (]: On seed.dbt_idr_integration_tests.sample_orders: Close
[0m20:07:27.032399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:27.032654 [info ] [Thread-4 (]: 13 of 15 OK loaded seed file main.sample_crm_customers ......................... [[32mINSERT 10[0m in 0.03s]
[0m20:07:27.032968 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f59f70>]}
[0m20:07:27.033359 [debug] [Thread-1 (]: On seed.dbt_idr_integration_tests.sample_pos_transactions: Close
[0m20:07:27.033665 [debug] [Thread-4 (]: Finished running node seed.dbt_idr_integration_tests.sample_crm_customers
[0m20:07:27.034199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ca6f01-b97b-4451-97cc-03ad6de4f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4f290>]}
[0m20:07:27.033970 [info ] [Thread-2 (]: 14 of 15 OK loaded seed file main.sample_orders ................................ [[32mINSERT 10[0m in 0.03s]
[0m20:07:27.034583 [info ] [Thread-1 (]: 15 of 15 OK loaded seed file main.sample_pos_transactions ...................... [[32mINSERT 10[0m in 0.03s]
[0m20:07:27.034899 [debug] [Thread-2 (]: Finished running node seed.dbt_idr_integration_tests.sample_orders
[0m20:07:27.035189 [debug] [Thread-1 (]: Finished running node seed.dbt_idr_integration_tests.sample_pos_transactions
[0m20:07:27.035914 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:27.036097 [debug] [MainThread]: On master: BEGIN
[0m20:07:27.036255 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:27.036541 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:27.036702 [debug] [MainThread]: On master: COMMIT
[0m20:07:27.036863 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:27.037015 [debug] [MainThread]: On master: COMMIT
[0m20:07:27.037267 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:27.037428 [debug] [MainThread]: On master: Close
[0m20:07:27.037645 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:27.037827 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_pos_transactions' was properly closed.
[0m20:07:27.037988 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_orders' was properly closed.
[0m20:07:27.038138 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.idr_sources' was properly closed.
[0m20:07:27.038285 [debug] [MainThread]: Connection 'seed.dbt_idr_integration_tests.sample_crm_customers' was properly closed.
[0m20:07:27.038471 [info ] [MainThread]: 
[0m20:07:27.038727 [info ] [MainThread]: Finished running 15 seeds in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m20:07:27.040028 [debug] [MainThread]: Command end result
[0m20:07:27.063581 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m20:07:27.064767 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m20:07:27.069579 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/run_results.json
[0m20:07:27.069857 [info ] [MainThread]: 
[0m20:07:27.070097 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:07:27.070287 [info ] [MainThread]: 
[0m20:07:27.070486 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=15
[0m20:07:27.072046 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.1916541, "process_in_blocks": "0", "process_kernel_time": 0.221499, "process_mem_max_rss": "165789696", "process_out_blocks": "0", "process_user_time": 1.795074}
[0m20:07:27.072337 [debug] [MainThread]: Command `dbt seed` succeeded at 20:07:27.072288 after 1.19 seconds
[0m20:07:27.072578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10474b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ca73b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066cbc50>]}
[0m20:07:27.072804 [debug] [MainThread]: Flushing usage events
[0m20:07:27.497211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:28.718256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a7890>]}


============================== 20:07:28.721138 | d1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db ==============================
[0m20:07:28.721138 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:07:28.721538 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'introspect': 'True', 'profiles_dir': '.', 'target_path': 'None', 'version_check': 'True', 'write_json': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'printer_width': '80', 'empty': 'False', 'no_print': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_colors': 'True', 'static_parser': 'True'}
[0m20:07:28.843206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dbd810>]}
[0m20:07:28.878694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106747790>]}
[0m20:07:28.879915 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:07:28.945023 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:07:29.036533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:07:29.036856 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:07:29.037040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:07:29.074206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de0250>]}
[0m20:07:29.184515 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m20:07:29.185831 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m20:07:29.197289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a6e40>]}
[0m20:07:29.197622 [info ] [MainThread]: Found 35 data tests, 15 seeds, 11 models, 6 sources, 591 macros
[0m20:07:29.197841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba9c50>]}
[0m20:07:29.199478 [info ] [MainThread]: 
[0m20:07:29.199701 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:07:29.199888 [info ] [MainThread]: 
[0m20:07:29.200190 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:07:29.203339 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m20:07:29.211343 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m20:07:29.215512 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m20:07:29.237068 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m20:07:29.237358 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m20:07:29.237578 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m20:07:29.237859 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m20:07:29.238105 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m20:07:29.238358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:29.238571 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m20:07:29.238769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:29.239065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:29.249486 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:07:29.250489 [debug] [ThreadPool]: On list_test_idr: Close
[0m20:07:29.250831 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:07:29.251098 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m20:07:29.252031 [debug] [ThreadPool]: On list_test_idr: Close
[0m20:07:29.252855 [debug] [ThreadPool]: On list_test_idr: Close
[0m20:07:29.253433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_out)
[0m20:07:29.253698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_work)
[0m20:07:29.254054 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_out"
"
[0m20:07:29.254278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_staging)
[0m20:07:29.254517 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_work"
"
[0m20:07:29.258441 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m20:07:29.258707 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_staging"
"
[0m20:07:29.259984 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m20:07:29.260189 [debug] [ThreadPool]: On create_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_out"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m20:07:29.261144 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m20:07:29.261327 [debug] [ThreadPool]: On create_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_work"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m20:07:29.261503 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:29.261678 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_staging"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m20:07:29.261899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:29.262378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:29.262799 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:29.263154 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:29.264046 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m20:07:29.264311 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:07:29.264496 [debug] [ThreadPool]: On create_test_idr_main_idr_out: BEGIN
[0m20:07:29.265153 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m20:07:29.265960 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m20:07:29.266308 [debug] [ThreadPool]: On create_test_idr_main_idr_work: BEGIN
[0m20:07:29.266520 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: BEGIN
[0m20:07:29.266793 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:29.267103 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m20:07:29.267292 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:29.267480 [debug] [ThreadPool]: On create_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_out"} */

    
    
        create schema if not exists "test_idr"."main_idr_out"
    
[0m20:07:29.267680 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:29.267851 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m20:07:29.268081 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m20:07:29.268360 [debug] [ThreadPool]: On create_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_work"} */

    
    
        create schema if not exists "test_idr"."main_idr_work"
    
[0m20:07:29.268551 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_staging"} */

    
    
        create schema if not exists "test_idr"."main_idr_staging"
    
[0m20:07:29.268852 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:29.269516 [debug] [ThreadPool]: On create_test_idr_main_idr_out: COMMIT
[0m20:07:29.269755 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:29.269967 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m20:07:29.270145 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:29.270668 [debug] [ThreadPool]: On create_test_idr_main_idr_work: COMMIT
[0m20:07:29.270867 [debug] [ThreadPool]: On create_test_idr_main_idr_out: COMMIT
[0m20:07:29.271436 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: COMMIT
[0m20:07:29.271700 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_work"
[0m20:07:29.271988 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_staging"
[0m20:07:29.272219 [debug] [ThreadPool]: On create_test_idr_main_idr_work: COMMIT
[0m20:07:29.272423 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:29.272588 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: COMMIT
[0m20:07:29.272819 [debug] [ThreadPool]: On create_test_idr_main_idr_out: Close
[0m20:07:29.273077 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:29.273280 [debug] [ThreadPool]: On create_test_idr_main_idr_work: Close
[0m20:07:29.273464 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:29.273874 [debug] [ThreadPool]: On create_test_idr_main_idr_staging: Close
[0m20:07:29.275513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_staging, now list_test_idr_main_idr_out)
[0m20:07:29.279263 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m20:07:29.279535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_out, now list_test_idr_main_idr_staging)
[0m20:07:29.279809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_work, now list_test_idr_main_idr_work)
[0m20:07:29.280037 [debug] [ThreadPool]: On list_test_idr_main_idr_out: BEGIN
[0m20:07:29.280275 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_meta'
[0m20:07:29.281424 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m20:07:29.282642 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m20:07:29.282857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:29.283905 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m20:07:29.284100 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: BEGIN
[0m20:07:29.284293 [debug] [ThreadPool]: On list_test_idr_main_idr_work: BEGIN
[0m20:07:29.284568 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: BEGIN
[0m20:07:29.284746 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:29.284932 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:07:29.285103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:29.285285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:29.285528 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m20:07:29.285791 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:29.286024 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:29.286226 [debug] [ThreadPool]: On list_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_out"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_out'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:29.286421 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:29.286594 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m20:07:29.286763 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m20:07:29.287021 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m20:07:29.287207 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_staging"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_staging'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:29.287420 [debug] [ThreadPool]: On list_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_work"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_work'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:29.287623 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_meta"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_meta'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:29.294759 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:07:29.295111 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:07:29.295400 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:07:29.296224 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: ROLLBACK
[0m20:07:29.296895 [debug] [ThreadPool]: On list_test_idr_main_idr_work: ROLLBACK
[0m20:07:29.297100 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:07:29.297926 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: ROLLBACK
[0m20:07:29.298654 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_staging'
[0m20:07:29.299316 [debug] [ThreadPool]: On list_test_idr_main_idr_out: ROLLBACK
[0m20:07:29.299584 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: Close
[0m20:07:29.299884 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_work'
[0m20:07:29.300146 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_meta'
[0m20:07:29.300437 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_out'
[0m20:07:29.300629 [debug] [ThreadPool]: On list_test_idr_main_idr_work: Close
[0m20:07:29.300908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_staging, now list_test_idr_main)
[0m20:07:29.301099 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: Close
[0m20:07:29.301279 [debug] [ThreadPool]: On list_test_idr_main_idr_out: Close
[0m20:07:29.302439 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m20:07:29.303314 [debug] [ThreadPool]: On list_test_idr_main: BEGIN
[0m20:07:29.303496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:29.303841 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:29.304031 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m20:07:29.304213 [debug] [ThreadPool]: On list_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:29.306250 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:07:29.309512 [debug] [ThreadPool]: On list_test_idr_main: ROLLBACK
[0m20:07:29.309860 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main'
[0m20:07:29.310038 [debug] [ThreadPool]: On list_test_idr_main: Close
[0m20:07:29.311058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108214c80>]}
[0m20:07:29.311357 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:29.311536 [debug] [MainThread]: On master: BEGIN
[0m20:07:29.311696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:29.312021 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:29.312187 [debug] [MainThread]: On master: COMMIT
[0m20:07:29.312361 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:29.312518 [debug] [MainThread]: On master: COMMIT
[0m20:07:29.312778 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:29.312951 [debug] [MainThread]: On master: Close
[0m20:07:29.314398 [debug] [Thread-1 (]: Began running node model.dbt_idr.stg_identifiers
[0m20:07:29.314758 [info ] [Thread-1 (]: 1 of 11 START sql table model main_idr_staging.stg_identifiers ................. [RUN]
[0m20:07:29.315034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_out, now model.dbt_idr.stg_identifiers)
[0m20:07:29.315243 [debug] [Thread-1 (]: Began compiling node model.dbt_idr.stg_identifiers
[0m20:07:29.328464 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m20:07:29.328770 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

    
    select * from "test_idr"."main"."idr_sources" where is_active = true

  
[0m20:07:29.328976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:29.330250 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.331194 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m20:07:29.331403 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

    
    select 
        m.*,
        r.canonicalize,
        r.priority,
        coalesce(r.max_group_size, 1000) as max_group_size
    from "test_idr"."main"."idr_identifier_mappings" m
    inner join "test_idr"."main"."idr_rules" r on m.identifier_type = r.identifier_type
    where r.is_active = true

  
[0m20:07:29.335857 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m20:07:29.341372 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idr.stg_identifiers"
[0m20:07:29.341963 [debug] [Thread-1 (]: Began executing node model.dbt_idr.stg_identifiers
[0m20:07:29.361775 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idr.stg_identifiers"
[0m20:07:29.362334 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m20:07:29.362552 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: BEGIN
[0m20:07:29.362958 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.363186 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m20:07:29.363526 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

  
    
    

    create  table
      "test_idr"."main_idr_staging"."stg_identifiers__dbt_tmp"
  
    as (
      









    
    
    
    
    






    
    
    
    
    
    
    
        
    
    
    
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
    
        
    
        
    
        
    

    
    
    
    
    
    
    
        
    
    
    
    
        
    
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
    
        
    

    
    
    
    
    
    
    
        
    
    
    
    
        
    
        
    
        
    
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    
        
            
            
            
            
            
            
            
            
            
                
            
            
            
            
            
        
    



with raw_identifiers as (
    
        
select
    'crm' as source_id,
    concat('crm', ':', cast(customer_id as TEXT)) as entity_key,
    'EMAIL' as identifier_type,
    cast(email as TEXT) as identifier_value_raw,
    cast(lower(email) as TEXT) as identifier_value_norm,
    False as is_hashed,
    1 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_crm_customers
where email is not null
            
union all

select
    'crm' as source_id,
    concat('crm', ':', cast(customer_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(phone as TEXT) as identifier_value_raw,
    cast(phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_crm_customers
where phone is not null
            
union all

select
    'orders' as source_id,
    concat('orders', ':', cast(order_id as TEXT)) as entity_key,
    'EMAIL' as identifier_type,
    cast(customer_email as TEXT) as identifier_value_raw,
    cast(lower(customer_email) as TEXT) as identifier_value_norm,
    False as is_hashed,
    1 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_orders
where customer_email is not null
            
union all

select
    'orders' as source_id,
    concat('orders', ':', cast(order_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(contact_phone as TEXT) as identifier_value_raw,
    cast(contact_phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_orders
where contact_phone is not null
            
union all

select
    'pos' as source_id,
    concat('pos', ':', cast(transaction_id as TEXT)) as entity_key,
    'LOYALTY' as identifier_type,
    cast(loyalty_card_id as TEXT) as identifier_value_raw,
    cast(loyalty_card_id as TEXT) as identifier_value_norm,
    False as is_hashed,
    3 as priority,
    10 as max_group_size,
    current_timestamp as extracted_at
from main.sample_pos_transactions
where loyalty_card_id is not null
            
union all

select
    'pos' as source_id,
    concat('pos', ':', cast(transaction_id as TEXT)) as entity_key,
    'PHONE' as identifier_type,
    cast(contact_phone as TEXT) as identifier_value_raw,
    cast(contact_phone as TEXT) as identifier_value_norm,
    False as is_hashed,
    2 as priority,
    100 as max_group_size,
    current_timestamp as extracted_at
from main.sample_pos_transactions
where contact_phone is not null
            
    
),

exclusions as (
    select identifier_type, identifier_value_pattern, match_type
    from "test_idr"."main"."idr_exclusions"
),


filtered_identifiers as (
    select r.*
    from raw_identifiers r
    where not exists (
        select 1 from exclusions e
        where e.identifier_type = r.identifier_type
          and (
            (e.match_type = 'EXACT' and r.identifier_value_norm = e.identifier_value_pattern)
            or (e.match_type = 'LIKE' and r.identifier_value_norm like e.identifier_value_pattern)
          )
    )
)

select * from filtered_identifiers
    );
  
  
[0m20:07:29.371281 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m20:07:29.411585 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m20:07:29.412665 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */
alter table "test_idr"."main_idr_staging"."stg_identifiers__dbt_tmp" rename to "stg_identifiers"
[0m20:07:29.416871 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:07:29.488628 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: COMMIT
[0m20:07:29.488959 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m20:07:29.489159 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: COMMIT
[0m20:07:29.490250 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.494200 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stg_identifiers"
[0m20:07:29.494543 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stg_identifiers"} */

      drop table if exists "test_idr"."main_idr_staging"."stg_identifiers__dbt_backup" cascade
    
[0m20:07:29.495026 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.496614 [debug] [Thread-1 (]: On model.dbt_idr.stg_identifiers: Close
[0m20:07:29.497663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082271d0>]}
[0m20:07:29.498039 [info ] [Thread-1 (]: 1 of 11 OK created sql table model main_idr_staging.stg_identifiers ............ [[32mOK[0m in 0.18s]
[0m20:07:29.498366 [debug] [Thread-1 (]: Finished running node model.dbt_idr.stg_identifiers
[0m20:07:29.498901 [debug] [Thread-3 (]: Began running node model.dbt_idr.skipped_identifier_groups
[0m20:07:29.499635 [debug] [Thread-2 (]: Began running node model.dbt_idr.int_edges
[0m20:07:29.499395 [info ] [Thread-3 (]: 3 of 11 START sql table model main_idr_out.skipped_identifier_groups ........... [RUN]
[0m20:07:29.500038 [info ] [Thread-2 (]: 2 of 11 START sql table model main_idr_work.int_edges .......................... [RUN]
[0m20:07:29.500347 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_work, now model.dbt_idr.skipped_identifier_groups)
[0m20:07:29.500616 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_idr_main, now model.dbt_idr.int_edges)
[0m20:07:29.500865 [debug] [Thread-3 (]: Began compiling node model.dbt_idr.skipped_identifier_groups
[0m20:07:29.501082 [debug] [Thread-2 (]: Began compiling node model.dbt_idr.int_edges
[0m20:07:29.503014 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_idr.skipped_identifier_groups"
[0m20:07:29.505060 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_idr.int_edges"
[0m20:07:29.505765 [debug] [Thread-3 (]: Began executing node model.dbt_idr.skipped_identifier_groups
[0m20:07:29.507781 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_idr.skipped_identifier_groups"
[0m20:07:29.508228 [debug] [Thread-2 (]: Began executing node model.dbt_idr.int_edges
[0m20:07:29.510274 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_idr.int_edges"
[0m20:07:29.510738 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m20:07:29.511028 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: BEGIN
[0m20:07:29.511331 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:29.511625 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m20:07:29.512032 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: BEGIN
[0m20:07:29.512241 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:29.512541 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.512960 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m20:07:29.513208 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.skipped_identifier_groups"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."skipped_identifier_groups__dbt_tmp"
  
    as (
      



with identifier_groups as (
    select
        identifier_type,
        identifier_value_norm,
        max_group_size,
        count(*) as group_size,
        min(entity_key) as sample_entity_key
    from "test_idr"."main_idr_staging"."stg_identifiers"
    where identifier_value_norm is not null
    group by identifier_type, identifier_value_norm, max_group_size
),

skipped_groups as (
    select
        'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db' as run_id,
        identifier_type,
        identifier_value_norm,
        group_size,
        max_group_size as max_allowed,
        sample_entity_key,
        'EXCEEDED_MAX_GROUP_SIZE' as reason,
        current_timestamp as skipped_at
    from identifier_groups
    where group_size > max_group_size
)

select * from skipped_groups
    );
  
  
[0m20:07:29.513599 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.513844 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m20:07:29.514083 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_edges"} */

  
    
    

    create  table
      "test_idr"."main_idr_work"."int_edges__dbt_tmp"
  
    as (
      



with identifier_groups as (
    -- Count entities per identifier value
    select
        identifier_type,
        identifier_value_norm,
        max_group_size,
        count(*) as group_size,
        min(entity_key) as anchor_entity_key
    from "test_idr"."main_idr_staging"."stg_identifiers"
    where identifier_value_norm is not null
    group by identifier_type, identifier_value_norm, max_group_size
),

valid_groups as (
    -- Filter out oversized groups
    select
        identifier_type,
        identifier_value_norm,
        anchor_entity_key
    from identifier_groups
    where group_size <= max_group_size
),

edges as (
    -- Create edges from each entity to the anchor
    select distinct
        vg.anchor_entity_key as left_entity_key,
        i.entity_key as right_entity_key,
        vg.identifier_type,
        vg.identifier_value_norm,
        current_timestamp as created_at
    from valid_groups vg
    inner join "test_idr"."main_idr_staging"."stg_identifiers" i
        on i.identifier_type = vg.identifier_type
        and i.identifier_value_norm = vg.identifier_value_norm
    where i.entity_key != vg.anchor_entity_key
)

select * from edges
    );
  
  
[0m20:07:29.515979 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:07:29.517714 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m20:07:29.517929 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.skipped_identifier_groups"} */
alter table "test_idr"."main_idr_out"."skipped_identifier_groups__dbt_tmp" rename to "skipped_identifier_groups"
[0m20:07:29.518258 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:07:29.520267 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m20:07:29.520502 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:07:29.520749 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_edges"} */
alter table "test_idr"."main_idr_work"."int_edges__dbt_tmp" rename to "int_edges"
[0m20:07:29.521832 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: COMMIT
[0m20:07:29.522149 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m20:07:29.522366 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: COMMIT
[0m20:07:29.522585 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.523579 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: COMMIT
[0m20:07:29.523799 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m20:07:29.524004 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.524201 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: COMMIT
[0m20:07:29.525525 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.skipped_identifier_groups"
[0m20:07:29.525825 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.skipped_identifier_groups"} */

      drop table if exists "test_idr"."main_idr_out"."skipped_identifier_groups__dbt_backup" cascade
    
[0m20:07:29.526442 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.526686 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.527450 [debug] [Thread-3 (]: On model.dbt_idr.skipped_identifier_groups: Close
[0m20:07:29.529003 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.int_edges"
[0m20:07:29.529290 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_edges"} */

      drop table if exists "test_idr"."main_idr_work"."int_edges__dbt_backup" cascade
    
[0m20:07:29.529642 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108718260>]}
[0m20:07:29.530076 [info ] [Thread-3 (]: 3 of 11 OK created sql table model main_idr_out.skipped_identifier_groups ...... [[32mOK[0m in 0.03s]
[0m20:07:29.530327 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.530629 [debug] [Thread-3 (]: Finished running node model.dbt_idr.skipped_identifier_groups
[0m20:07:29.531386 [debug] [Thread-2 (]: On model.dbt_idr.int_edges: Close
[0m20:07:29.531778 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087af4d0>]}
[0m20:07:29.532101 [info ] [Thread-2 (]: 2 of 11 OK created sql table model main_idr_work.int_edges ..................... [[32mOK[0m in 0.03s]
[0m20:07:29.532410 [debug] [Thread-2 (]: Finished running node model.dbt_idr.int_edges
[0m20:07:29.532817 [debug] [Thread-1 (]: Began running node model.dbt_idr.int_labels
[0m20:07:29.533068 [debug] [Thread-3 (]: Began running node model.dbt_idr.rule_match_audit
[0m20:07:29.533305 [debug] [Thread-4 (]: Began running node model.dbt_idr.identity_edges
[0m20:07:29.533548 [info ] [Thread-1 (]: 5 of 11 START sql table model main_idr_work.int_labels ......................... [RUN]
[0m20:07:29.533848 [info ] [Thread-3 (]: 6 of 11 START sql table model main_idr_out.rule_match_audit .................... [RUN]
[0m20:07:29.534124 [info ] [Thread-4 (]: 4 of 11 START sql table model main_idr_out.identity_edges ...................... [RUN]
[0m20:07:29.534402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idr.stg_identifiers, now model.dbt_idr.int_labels)
[0m20:07:29.534635 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_idr.skipped_identifier_groups, now model.dbt_idr.rule_match_audit)
[0m20:07:29.534871 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_meta, now model.dbt_idr.identity_edges)
[0m20:07:29.535099 [debug] [Thread-1 (]: Began compiling node model.dbt_idr.int_labels
[0m20:07:29.535307 [debug] [Thread-3 (]: Began compiling node model.dbt_idr.rule_match_audit
[0m20:07:29.535510 [debug] [Thread-4 (]: Began compiling node model.dbt_idr.identity_edges
[0m20:07:29.537983 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idr.int_labels"
[0m20:07:29.539683 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_idr.rule_match_audit"
[0m20:07:29.542022 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_idr.identity_edges"
[0m20:07:29.542708 [debug] [Thread-4 (]: Began executing node model.dbt_idr.identity_edges
[0m20:07:29.542938 [debug] [Thread-1 (]: Began executing node model.dbt_idr.int_labels
[0m20:07:29.543149 [debug] [Thread-3 (]: Began executing node model.dbt_idr.rule_match_audit
[0m20:07:29.545098 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_idr.identity_edges"
[0m20:07:29.547196 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idr.int_labels"
[0m20:07:29.549924 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_idr.rule_match_audit"
[0m20:07:29.550862 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m20:07:29.551100 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: BEGIN
[0m20:07:29.551340 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.int_labels"
[0m20:07:29.551612 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:29.551861 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: BEGIN
[0m20:07:29.552098 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m20:07:29.552485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:29.552803 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: BEGIN
[0m20:07:29.553180 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:07:29.553450 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:29.553728 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m20:07:29.554026 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:29.554262 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_edges"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."identity_edges__dbt_tmp"
  
    as (
      



select
    'rule_' || identifier_type as rule_id,
    left_entity_key,
    right_entity_key,
    identifier_type,
    identifier_value_norm,
    created_at as first_seen_ts,
    created_at as last_seen_ts
from "test_idr"."main_idr_work"."int_edges"
    );
  
  
[0m20:07:29.554546 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.554755 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.int_labels"
[0m20:07:29.555068 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m20:07:29.555342 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_labels"} */

  
    
    

    create  table
      "test_idr"."main_idr_work"."int_labels__dbt_tmp"
  
    as (
      



with recursive 

all_nodes as (
    select distinct left_entity_key as entity_key from "test_idr"."main_idr_work"."int_edges"
    union
    select distinct right_entity_key as entity_key from "test_idr"."main_idr_work"."int_edges"
),

undirected_edges as (
    select left_entity_key as src, right_entity_key as dst from "test_idr"."main_idr_work"."int_edges"
    union
    select right_entity_key as src, left_entity_key as dst from "test_idr"."main_idr_work"."int_edges"
),


label_propagation as (
    -- Base case: initial labels
    select 
        entity_key,
        entity_key as label,
        0 as iteration
    from all_nodes
    
    union all
    
    -- Recursive case: propagate minimum label
    select 
        lp.entity_key,
        least(lp.label, e.dst) as label,
        lp.iteration + 1
    from label_propagation lp
    join undirected_edges e on e.src = lp.entity_key
    where lp.iteration < 30
      and e.dst < lp.label
),

final_labels as (
    select 
        entity_key,
        min(label) as label
    from label_propagation
    group by entity_key
)

select 
    entity_key,
    label as resolved_id,
    current_timestamp as updated_at
from final_labels
    );
  
  
[0m20:07:29.555605 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.rule_match_audit"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."rule_match_audit__dbt_tmp"
  
    as (
      



select
    'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db' as run_id,
    'rule_' || identifier_type as rule_id,
    count(*) as edges_created,
    min(created_at) as started_at,
    max(created_at) as ended_at
from "test_idr"."main_idr_work"."int_edges"
group by identifier_type
    );
  
  
[0m20:07:29.555828 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.557822 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m20:07:29.558062 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_edges"} */
alter table "test_idr"."main_idr_out"."identity_edges__dbt_tmp" rename to "identity_edges"
[0m20:07:29.558482 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:07:29.560199 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m20:07:29.560431 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:07:29.560733 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.rule_match_audit"} */
alter table "test_idr"."main_idr_out"."rule_match_audit__dbt_tmp" rename to "rule_match_audit"
[0m20:07:29.560973 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m20:07:29.562400 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: COMMIT
[0m20:07:29.564198 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.int_labels"
[0m20:07:29.564428 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m20:07:29.564656 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:07:29.564848 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_labels"} */
alter table "test_idr"."main_idr_work"."int_labels__dbt_tmp" rename to "int_labels"
[0m20:07:29.565116 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: COMMIT
[0m20:07:29.566249 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: COMMIT
[0m20:07:29.566716 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m20:07:29.566938 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: COMMIT
[0m20:07:29.567156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.567379 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.568416 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: COMMIT
[0m20:07:29.572211 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.identity_edges"
[0m20:07:29.572523 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.int_labels"
[0m20:07:29.572739 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m20:07:29.572979 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_edges"} */

      drop table if exists "test_idr"."main_idr_out"."identity_edges__dbt_backup" cascade
    
[0m20:07:29.573198 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: COMMIT
[0m20:07:29.574513 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.rule_match_audit"
[0m20:07:29.574960 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.rule_match_audit"} */

      drop table if exists "test_idr"."main_idr_out"."rule_match_audit__dbt_backup" cascade
    
[0m20:07:29.575228 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.575514 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.576396 [debug] [Thread-4 (]: On model.dbt_idr.identity_edges: Close
[0m20:07:29.577729 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.int_labels"
[0m20:07:29.577938 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:07:29.578201 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.int_labels"} */

      drop table if exists "test_idr"."main_idr_work"."int_labels__dbt_backup" cascade
    
[0m20:07:29.578538 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108600050>]}
[0m20:07:29.579365 [debug] [Thread-3 (]: On model.dbt_idr.rule_match_audit: Close
[0m20:07:29.579849 [info ] [Thread-4 (]: 4 of 11 OK created sql table model main_idr_out.identity_edges ................. [[32mOK[0m in 0.04s]
[0m20:07:29.580188 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10874d9b0>]}
[0m20:07:29.580414 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.580693 [debug] [Thread-4 (]: Finished running node model.dbt_idr.identity_edges
[0m20:07:29.581004 [info ] [Thread-3 (]: 6 of 11 OK created sql table model main_idr_out.rule_match_audit ............... [[32mOK[0m in 0.05s]
[0m20:07:29.581758 [debug] [Thread-1 (]: On model.dbt_idr.int_labels: Close
[0m20:07:29.582107 [debug] [Thread-3 (]: Finished running node model.dbt_idr.rule_match_audit
[0m20:07:29.582407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10825d790>]}
[0m20:07:29.582742 [info ] [Thread-1 (]: 5 of 11 OK created sql table model main_idr_work.int_labels .................... [[32mOK[0m in 0.05s]
[0m20:07:29.583034 [debug] [Thread-1 (]: Finished running node model.dbt_idr.int_labels
[0m20:07:29.583357 [debug] [Thread-2 (]: Began running node model.dbt_idr.identity_membership
[0m20:07:29.583636 [info ] [Thread-2 (]: 7 of 11 START sql table model main_idr_out.identity_membership ................. [RUN]
[0m20:07:29.583887 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_idr.int_edges, now model.dbt_idr.identity_membership)
[0m20:07:29.584088 [debug] [Thread-2 (]: Began compiling node model.dbt_idr.identity_membership
[0m20:07:29.586468 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_idr.identity_membership"
[0m20:07:29.586932 [debug] [Thread-2 (]: Began executing node model.dbt_idr.identity_membership
[0m20:07:29.588643 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_idr.identity_membership"
[0m20:07:29.589001 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.identity_membership"
[0m20:07:29.589206 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: BEGIN
[0m20:07:29.589391 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:29.589819 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.590041 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.identity_membership"
[0m20:07:29.590271 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_membership"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."identity_membership__dbt_tmp"
  
    as (
      



with labeled_entities as (
    select
        entity_key,
        resolved_id,
        updated_at
    from "test_idr"."main_idr_work"."int_labels"
),

-- Get all entities from staging (for singletons)
all_entities as (
    select distinct entity_key
    from "test_idr"."main_idr_staging"."stg_identifiers"
),

-- Singletons: entities with no edges
singletons as (
    select
        e.entity_key,
        e.entity_key as resolved_id,  -- Singleton is its own cluster
        current_timestamp as updated_at
    from all_entities e
    where not exists (
        select 1 from labeled_entities l where l.entity_key = e.entity_key
    )
),

-- Combine labeled entities and singletons
final as (
    select entity_key, resolved_id, updated_at from labeled_entities
    union all
    select entity_key, resolved_id, updated_at from singletons
)

select * from final
    );
  
  
[0m20:07:29.591822 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.593582 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.identity_membership"
[0m20:07:29.593784 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_membership"} */
alter table "test_idr"."main_idr_out"."identity_membership__dbt_tmp" rename to "identity_membership"
[0m20:07:29.594140 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.594987 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: COMMIT
[0m20:07:29.595183 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.identity_membership"
[0m20:07:29.595368 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: COMMIT
[0m20:07:29.595823 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.596927 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.identity_membership"
[0m20:07:29.597119 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_membership"} */

      drop table if exists "test_idr"."main_idr_out"."identity_membership__dbt_backup" cascade
    
[0m20:07:29.597415 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.598049 [debug] [Thread-2 (]: On model.dbt_idr.identity_membership: Close
[0m20:07:29.598343 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107927b90>]}
[0m20:07:29.598671 [info ] [Thread-2 (]: 7 of 11 OK created sql table model main_idr_out.identity_membership ............ [[32mOK[0m in 0.01s]
[0m20:07:29.598956 [debug] [Thread-2 (]: Finished running node model.dbt_idr.identity_membership
[0m20:07:29.599397 [debug] [Thread-3 (]: Began running node model.dbt_idr.identity_clusters
[0m20:07:29.599991 [debug] [Thread-4 (]: Began running node model.dbt_idr.golden_profiles
[0m20:07:29.599767 [info ] [Thread-3 (]: 9 of 11 START sql table model main_idr_out.identity_clusters ................... [RUN]
[0m20:07:29.600590 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_idr.rule_match_audit, now model.dbt_idr.identity_clusters)
[0m20:07:29.600358 [info ] [Thread-4 (]: 8 of 11 START sql table model main_idr_out.golden_profiles ..................... [RUN]
[0m20:07:29.600928 [debug] [Thread-3 (]: Began compiling node model.dbt_idr.identity_clusters
[0m20:07:29.601197 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_idr.identity_edges, now model.dbt_idr.golden_profiles)
[0m20:07:29.604180 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_idr.identity_clusters"
[0m20:07:29.604501 [debug] [Thread-4 (]: Began compiling node model.dbt_idr.golden_profiles
[0m20:07:29.616859 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m20:07:29.617186 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.golden_profiles"} */

    
    select * from "test_idr"."main"."idr_sources" where is_active = true

  
[0m20:07:29.617414 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:29.617948 [debug] [Thread-3 (]: Began executing node model.dbt_idr.identity_clusters
[0m20:07:29.620210 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_idr.identity_clusters"
[0m20:07:29.620487 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:07:29.621496 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m20:07:29.621720 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.golden_profiles"} */

    
    select * from "test_idr"."main"."idr_attribute_mappings"

  
[0m20:07:29.622158 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.identity_clusters"
[0m20:07:29.622394 [debug] [Thread-3 (]: On model.dbt_idr.identity_clusters: BEGIN
[0m20:07:29.622602 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:29.622883 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.623178 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.623443 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.identity_clusters"
[0m20:07:29.623780 [debug] [Thread-3 (]: On model.dbt_idr.identity_clusters: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_clusters"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."identity_clusters__dbt_tmp"
  
    as (
      



with cluster_sizes as (
    select
        resolved_id,
        count(*) as cluster_size
    from "test_idr"."main_idr_out"."identity_membership"
    group by resolved_id
),

cluster_edge_stats as (
    select
        m.resolved_id,
        count(distinct e.identifier_type) as edge_diversity,
        count(*) as edge_count
    from "test_idr"."main_idr_out"."identity_membership" m
    inner join "test_idr"."main_idr_work"."int_edges" e
        on e.left_entity_key = m.entity_key 
        or e.right_entity_key = m.entity_key
    group by m.resolved_id
),

max_diversity as (
    select coalesce(max(edge_diversity), 1) as max_edge_diversity
    from cluster_edge_stats
),

clusters_with_confidence as (
    select
        cs.resolved_id,
        cs.cluster_size,
        
        -- Edge diversity (number of identifier types)
        coalesce(es.edge_diversity, 0) as edge_diversity,
        
        -- Match density (actual edges / max possible edges for cluster size)
        case 
            when cs.cluster_size <= 1 then 1.0
            else least(1.0, coalesce(es.edge_count, 0) * 1.0 / greatest(1, cs.cluster_size - 1))
        end as match_density,
        
        -- Confidence score: weighted combination
        case 
            when cs.cluster_size = 1 then 1.0
            else round(
                0.50 * (coalesce(es.edge_diversity, 0) * 1.0 / md.max_edge_diversity) +
                0.35 * least(1.0, coalesce(es.edge_count, 0) * 1.0 / greatest(1, cs.cluster_size - 1)) +
                0.15,
                3
            )
        end as confidence_score,
        
        -- Primary reason
        case 
            when cs.cluster_size = 1 then 'SINGLETON_NO_MATCH_REQUIRED'
            when coalesce(es.edge_diversity, 0) >= 2 then concat(cast(es.edge_diversity as TEXT), ' identifier types')
            else 'Single identifier type'
        end as primary_reason,
        
        current_timestamp as updated_at
        
    from cluster_sizes cs
    left join cluster_edge_stats es on es.resolved_id = cs.resolved_id
    cross join max_diversity md
)

select * from clusters_with_confidence
    );
  
  
[0m20:07:29.624762 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m20:07:29.625786 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.golden_profiles"} */

    
    select * from "test_idr"."main"."idr_survivorship_rules"

  
[0m20:07:29.626356 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.631937 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_idr.golden_profiles"
[0m20:07:29.632380 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m20:07:29.634465 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.identity_clusters"
[0m20:07:29.634724 [debug] [Thread-4 (]: Began executing node model.dbt_idr.golden_profiles
[0m20:07:29.634967 [debug] [Thread-3 (]: On model.dbt_idr.identity_clusters: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_clusters"} */
alter table "test_idr"."main_idr_out"."identity_clusters__dbt_tmp" rename to "identity_clusters"
[0m20:07:29.636793 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_idr.golden_profiles"
[0m20:07:29.637280 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.638203 [debug] [Thread-3 (]: On model.dbt_idr.identity_clusters: COMMIT
[0m20:07:29.638417 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.identity_clusters"
[0m20:07:29.638634 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m20:07:29.638828 [debug] [Thread-3 (]: On model.dbt_idr.identity_clusters: COMMIT
[0m20:07:29.639019 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: BEGIN
[0m20:07:29.639411 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.639641 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m20:07:29.639841 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.640196 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.golden_profiles"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."golden_profiles__dbt_tmp"
  
    as (
      











    
    
    
    
    
    
    





    

    

    

    






    
    
    
    
    
    
    
        
    
    
    
    
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
    
        
    
        
    
        
    
        
    
    
    
    
    
    
    
    
    
    
    
        
        
    
        
        
    
        
        
    
        
        
    
    
    
    
    
    
    

    
    
    
    
    
    
    
        
    
    
    
    
    
        
    
        
    
        
    
        
    
        
    
        
            
        
    
        
            
        
    
        
            
        
    
        
    
        
    
    
    
    
    
    
    
    
    
    
    
        
        
    
        
        
    
        
        
    
        
        
    
    
    
    
    
    
    

    
    
    
    
    
    
    
        
    
    
    
    
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            
        
    
        
            
        
    
    
    
    
    
    
    
    
    
    
    
        
        
    
        
        
    
        
        
    
        
        
    
    
    
    
    
    
    


with membership as (
    select distinct resolved_id, entity_key
    from "test_idr"."main_idr_out"."identity_membership"
),

entity_attributes as (
    
        
select 'crm' as source_id,
       concat('crm', ':', cast(customer_id as TEXT)) as entity_key,
       cast(email as TEXT) as email,
       cast(phone as TEXT) as phone,
       cast(first_name as TEXT) as first_name,
       cast(last_name as TEXT) as last_name,
       coalesce(cast(updated_at as timestamp), cast('1900-01-01' as timestamp)) as record_updated_at
from main.sample_crm_customers
    
union all

select 'orders' as source_id,
       concat('orders', ':', cast(order_id as TEXT)) as entity_key,
       cast(customer_email as TEXT) as email,
       cast(contact_phone as TEXT) as phone,
       cast(null as TEXT) as first_name,
       cast(null as TEXT) as last_name,
       coalesce(cast(order_date as timestamp), cast('1900-01-01' as timestamp)) as record_updated_at
from main.sample_orders
    
union all

select 'pos' as source_id,
       concat('pos', ':', cast(transaction_id as TEXT)) as entity_key,
       cast(null as TEXT) as email,
       cast(contact_phone as TEXT) as phone,
       cast(null as TEXT) as first_name,
       cast(null as TEXT) as last_name,
       coalesce(cast(transaction_date as timestamp), cast('1900-01-01' as timestamp)) as record_updated_at
from main.sample_pos_transactions
    
    
),

cluster_entities as (
    select
        m.resolved_id,
        e.*
    from membership m
    left join entity_attributes e on e.entity_key = m.entity_key
)



, email_ranked as (
    select resolved_id, email,
           row_number() over (partition by resolved_id order by record_updated_at desc) as rn
    from cluster_entities
    where email is not null
)

, phone_ranked as (
    select resolved_id, phone,
           row_number() over (partition by resolved_id order by record_updated_at desc) as rn
    from cluster_entities
    where phone is not null
)

, first_name_ranked as (
    select resolved_id, first_name,
           row_number() over (partition by resolved_id order by record_updated_at desc) as rn
    from cluster_entities
    where first_name is not null
)

, last_name_ranked as (
    select resolved_id, last_name,
           row_number() over (partition by resolved_id order by record_updated_at desc) as rn
    from cluster_entities
    where last_name is not null
)



, golden_profiles as (
    select distinct
        m.resolved_id
        
        , email_r.email as email_primary
        
        , phone_r.phone as phone_primary
        
        , first_name_r.first_name as first_name_primary
        
        , last_name_r.last_name as last_name_primary
        
        , current_timestamp as updated_at
    from membership m
    
    left join email_ranked email_r 
        on email_r.resolved_id = m.resolved_id and email_r.rn = 1
    
    left join phone_ranked phone_r 
        on phone_r.resolved_id = m.resolved_id and phone_r.rn = 1
    
    left join first_name_ranked first_name_r 
        on first_name_r.resolved_id = m.resolved_id and first_name_r.rn = 1
    
    left join last_name_ranked last_name_r 
        on last_name_r.resolved_id = m.resolved_id and last_name_r.rn = 1
    
)

select * from golden_profiles
    );
  
  
[0m20:07:29.641740 [debug] [Thread-3 (]: Using duckdb connection "model.dbt_idr.identity_clusters"
[0m20:07:29.642328 [debug] [Thread-3 (]: On model.dbt_idr.identity_clusters: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.identity_clusters"} */

      drop table if exists "test_idr"."main_idr_out"."identity_clusters__dbt_backup" cascade
    
[0m20:07:29.642661 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.643367 [debug] [Thread-3 (]: On model.dbt_idr.identity_clusters: Close
[0m20:07:29.643691 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8aed0>]}
[0m20:07:29.644048 [info ] [Thread-3 (]: 9 of 11 OK created sql table model main_idr_out.identity_clusters .............. [[32mOK[0m in 0.04s]
[0m20:07:29.644400 [debug] [Thread-3 (]: Finished running node model.dbt_idr.identity_clusters
[0m20:07:29.644882 [debug] [Thread-1 (]: Began running node model.dbt_idr.run_history
[0m20:07:29.645216 [info ] [Thread-1 (]: 10 of 11 START sql table model main_idr_out.run_history ........................ [RUN]
[0m20:07:29.645543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idr.int_labels, now model.dbt_idr.run_history)
[0m20:07:29.645808 [debug] [Thread-1 (]: Began compiling node model.dbt_idr.run_history
[0m20:07:29.649219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idr.run_history"
[0m20:07:29.649725 [debug] [Thread-1 (]: Began executing node model.dbt_idr.run_history
[0m20:07:29.652069 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idr.run_history"
[0m20:07:29.652695 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.run_history"
[0m20:07:29.652976 [debug] [Thread-1 (]: On model.dbt_idr.run_history: BEGIN
[0m20:07:29.653221 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m20:07:29.653472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:29.655239 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m20:07:29.655577 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.golden_profiles"} */
alter table "test_idr"."main_idr_out"."golden_profiles__dbt_tmp" rename to "golden_profiles"
[0m20:07:29.655879 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:29.656113 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.run_history"
[0m20:07:29.656326 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.656566 [debug] [Thread-1 (]: On model.dbt_idr.run_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.run_history"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."run_history__dbt_tmp"
  
    as (
      



select
    'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db' as run_id,
    cast('2026-01-07 04:07:28.704983+00:00' as timestamp) as started_at,
    current_timestamp as ended_at,
    (select count(*) from "test_idr"."main_idr_staging"."stg_identifiers") as identifiers_extracted,
    (select count(*) from "test_idr"."main_idr_work"."int_edges") as edges_created,
    (select count(*) from "test_idr"."main_idr_out"."identity_clusters") as clusters_total,
    (select count(*) from "test_idr"."main_idr_out"."identity_membership") as entities_resolved,
    (select count(*) from "test_idr"."main_idr_out"."identity_clusters" where cluster_size >= 100) as large_clusters,
    'SUCCESS' as status,
    'dev' as target_name,
    'duckdb' as target_type
    );
  
  
[0m20:07:29.657665 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: COMMIT
[0m20:07:29.658027 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m20:07:29.658215 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: COMMIT
[0m20:07:29.658932 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.660584 [debug] [Thread-4 (]: Using duckdb connection "model.dbt_idr.golden_profiles"
[0m20:07:29.660805 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.golden_profiles"} */

      drop table if exists "test_idr"."main_idr_out"."golden_profiles__dbt_backup" cascade
    
[0m20:07:29.661165 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.661382 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:07:29.662155 [debug] [Thread-4 (]: On model.dbt_idr.golden_profiles: Close
[0m20:07:29.663770 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.run_history"
[0m20:07:29.664039 [debug] [Thread-1 (]: On model.dbt_idr.run_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.run_history"} */
alter table "test_idr"."main_idr_out"."run_history__dbt_tmp" rename to "run_history"
[0m20:07:29.664372 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108786ff0>]}
[0m20:07:29.664787 [info ] [Thread-4 (]: 8 of 11 OK created sql table model main_idr_out.golden_profiles ................ [[32mOK[0m in 0.06s]
[0m20:07:29.665052 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.665371 [debug] [Thread-4 (]: Finished running node model.dbt_idr.golden_profiles
[0m20:07:29.666359 [debug] [Thread-1 (]: On model.dbt_idr.run_history: COMMIT
[0m20:07:29.666673 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.run_history"
[0m20:07:29.666909 [debug] [Thread-1 (]: On model.dbt_idr.run_history: COMMIT
[0m20:07:29.667127 [debug] [Thread-2 (]: Began running node model.dbt_idr.stage_metrics
[0m20:07:29.667449 [info ] [Thread-2 (]: 11 of 11 START sql table model main_idr_out.stage_metrics ...................... [RUN]
[0m20:07:29.667703 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_idr.identity_membership, now model.dbt_idr.stage_metrics)
[0m20:07:29.667921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:29.668142 [debug] [Thread-2 (]: Began compiling node model.dbt_idr.stage_metrics
[0m20:07:29.669728 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.run_history"
[0m20:07:29.672490 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_idr.stage_metrics"
[0m20:07:29.672743 [debug] [Thread-1 (]: On model.dbt_idr.run_history: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.run_history"} */

      drop table if exists "test_idr"."main_idr_out"."run_history__dbt_backup" cascade
    
[0m20:07:29.673176 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.673944 [debug] [Thread-1 (]: On model.dbt_idr.run_history: Close
[0m20:07:29.674172 [debug] [Thread-2 (]: Began executing node model.dbt_idr.stage_metrics
[0m20:07:29.676209 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_idr.stage_metrics"
[0m20:07:29.676616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108787710>]}
[0m20:07:29.677097 [info ] [Thread-1 (]: 10 of 11 OK created sql table model main_idr_out.run_history ................... [[32mOK[0m in 0.03s]
[0m20:07:29.677487 [debug] [Thread-1 (]: Finished running node model.dbt_idr.run_history
[0m20:07:29.677906 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m20:07:29.678169 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: BEGIN
[0m20:07:29.678391 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:29.678822 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.679022 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m20:07:29.679241 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stage_metrics"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."stage_metrics__dbt_tmp"
  
    as (
      



with stages as (
    select 1 as stage_order, 'stg_identifiers' as stage_name, 
           (select count(*) from "test_idr"."main_idr_staging"."stg_identifiers") as rows_out
    union all
    select 2, 'int_edges', 
           (select count(*) from "test_idr"."main_idr_work"."int_edges")
    union all
    select 3, 'int_labels', 
           (select count(*) from "test_idr"."main_idr_work"."int_labels")
    union all
    select 4, 'identity_membership', 
           (select count(*) from "test_idr"."main_idr_out"."identity_membership")
    union all
    select 5, 'identity_clusters', 
           (select count(*) from "test_idr"."main_idr_out"."identity_clusters")
    union all
    select 6, 'golden_profiles', 
           (select count(*) from "test_idr"."main_idr_out"."golden_profiles")
    union all
    select 7, 'skipped_identifier_groups', 
           (select count(*) from "test_idr"."main_idr_out"."skipped_identifier_groups")
)

select
    'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db' as run_id,
    stage_name,
    stage_order,
    rows_out,
    current_timestamp as recorded_at
from stages
order by stage_order
    );
  
  
[0m20:07:29.681090 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:07:29.683184 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m20:07:29.683417 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stage_metrics"} */
alter table "test_idr"."main_idr_out"."stage_metrics__dbt_tmp" rename to "stage_metrics"
[0m20:07:29.683963 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.684970 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: COMMIT
[0m20:07:29.685197 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m20:07:29.685399 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: COMMIT
[0m20:07:29.685904 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.687168 [debug] [Thread-2 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m20:07:29.687382 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stage_metrics"} */

      drop table if exists "test_idr"."main_idr_out"."stage_metrics__dbt_backup" cascade
    
[0m20:07:29.687710 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:07:29.688416 [debug] [Thread-2 (]: On model.dbt_idr.stage_metrics: Close
[0m20:07:29.688728 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e3bbd7-90cb-4ff0-bdd2-4d94b1a6b9db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108784c50>]}
[0m20:07:29.689064 [info ] [Thread-2 (]: 11 of 11 OK created sql table model main_idr_out.stage_metrics ................. [[32mOK[0m in 0.02s]
[0m20:07:29.689370 [debug] [Thread-2 (]: Finished running node model.dbt_idr.stage_metrics
[0m20:07:29.690193 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:29.690401 [debug] [MainThread]: On master: BEGIN
[0m20:07:29.690564 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:29.690883 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:29.691066 [debug] [MainThread]: On master: COMMIT
[0m20:07:29.691233 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:29.691519 [debug] [MainThread]: On master: COMMIT
[0m20:07:29.691854 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:29.692082 [debug] [MainThread]: On master: Close
[0m20:07:29.692324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:29.692486 [debug] [MainThread]: Connection 'model.dbt_idr.run_history' was properly closed.
[0m20:07:29.692635 [debug] [MainThread]: Connection 'model.dbt_idr.stage_metrics' was properly closed.
[0m20:07:29.692781 [debug] [MainThread]: Connection 'model.dbt_idr.identity_clusters' was properly closed.
[0m20:07:29.692928 [debug] [MainThread]: Connection 'model.dbt_idr.golden_profiles' was properly closed.
[0m20:07:29.693147 [info ] [MainThread]: 
[0m20:07:29.693329 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m20:07:29.694284 [debug] [MainThread]: Command end result
[0m20:07:29.720404 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m20:07:29.721835 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m20:07:29.725691 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/run_results.json
[0m20:07:29.725897 [info ] [MainThread]: 
[0m20:07:29.726123 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:07:29.726313 [info ] [MainThread]: 
[0m20:07:29.726518 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m20:07:29.728106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0547305, "process_in_blocks": "0", "process_kernel_time": 0.207223, "process_mem_max_rss": "184975360", "process_out_blocks": "0", "process_user_time": 1.662179}
[0m20:07:29.728400 [debug] [MainThread]: Command `dbt run` succeeded at 20:07:29.728352 after 1.06 seconds
[0m20:07:29.728633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f01c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bcc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107edf650>]}
[0m20:07:29.728850 [debug] [MainThread]: Flushing usage events
[0m20:07:30.124486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:31.342271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105210590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca7890>]}


============================== 20:07:31.345149 | 060236ca-a3be-4354-b21a-5178d65abc5f ==============================
[0m20:07:31.345149 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:07:31.345611 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test --profiles-dir .', 'version_check': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_format': 'default', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'introspect': 'True', 'printer_width': '80', 'static_parser': 'True', 'target_path': 'None', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': '.'}
[0m20:07:31.468745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '060236ca-a3be-4354-b21a-5178d65abc5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c1810>]}
[0m20:07:31.503500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '060236ca-a3be-4354-b21a-5178d65abc5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b47790>]}
[0m20:07:31.504829 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:07:31.572799 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:07:31.663486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:07:31.663785 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:07:31.663961 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:07:31.702905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '060236ca-a3be-4354-b21a-5178d65abc5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103e8250>]}
[0m20:07:31.878672 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m20:07:31.879974 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m20:07:31.896498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '060236ca-a3be-4354-b21a-5178d65abc5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110770230>]}
[0m20:07:31.896816 [info ] [MainThread]: Found 35 data tests, 15 seeds, 11 models, 6 sources, 591 macros
[0m20:07:31.897048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '060236ca-a3be-4354-b21a-5178d65abc5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107f4910>]}
[0m20:07:31.899168 [info ] [MainThread]: 
[0m20:07:31.899382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:07:31.899565 [info ] [MainThread]: 
[0m20:07:31.899865 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:07:31.903573 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_meta'
[0m20:07:31.904009 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main'
[0m20:07:31.909517 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_out'
[0m20:07:31.911956 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_staging'
[0m20:07:31.931779 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m20:07:31.932086 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m20:07:31.932369 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: BEGIN
[0m20:07:31.932592 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m20:07:31.932803 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m20:07:31.932982 [debug] [ThreadPool]: On list_test_idr_main: BEGIN
[0m20:07:31.933164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:31.933333 [debug] [ThreadPool]: On list_test_idr_main_idr_out: BEGIN
[0m20:07:31.933502 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: BEGIN
[0m20:07:31.933663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:31.933910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:31.934128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:31.942811 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:07:31.943014 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m20:07:31.943203 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_meta"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_meta'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:31.943609 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:07:31.943820 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m20:07:31.944026 [debug] [ThreadPool]: On list_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:31.944253 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m20:07:31.944493 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m20:07:31.944685 [debug] [ThreadPool]: On list_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_out"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_out'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:31.944901 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:07:31.945273 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m20:07:31.945462 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_staging"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_staging'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:31.951380 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:07:31.951717 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m20:07:31.952009 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:07:31.952296 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m20:07:31.953304 [debug] [ThreadPool]: On list_test_idr_main: ROLLBACK
[0m20:07:31.954187 [debug] [ThreadPool]: On list_test_idr_main_idr_out: ROLLBACK
[0m20:07:31.954929 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: ROLLBACK
[0m20:07:31.955660 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: ROLLBACK
[0m20:07:31.956448 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_out'
[0m20:07:31.956683 [debug] [ThreadPool]: On list_test_idr_main_idr_out: Close
[0m20:07:31.957050 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_meta'
[0m20:07:31.957369 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_staging'
[0m20:07:31.957650 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main'
[0m20:07:31.958017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_out, now list_test_idr_main_idr_work)
[0m20:07:31.958843 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: Close
[0m20:07:31.959029 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: Close
[0m20:07:31.959191 [debug] [ThreadPool]: On list_test_idr_main: Close
[0m20:07:31.960334 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m20:07:31.961136 [debug] [ThreadPool]: On list_test_idr_main_idr_work: BEGIN
[0m20:07:31.961317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:31.962420 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:31.962600 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m20:07:31.962783 [debug] [ThreadPool]: On list_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_work"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_work'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:31.964867 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:07:31.965665 [debug] [ThreadPool]: On list_test_idr_main_idr_work: ROLLBACK
[0m20:07:31.966004 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_work'
[0m20:07:31.966176 [debug] [ThreadPool]: On list_test_idr_main_idr_work: Close
[0m20:07:31.966741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '060236ca-a3be-4354-b21a-5178d65abc5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110763a00>]}
[0m20:07:31.967021 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:31.967190 [debug] [MainThread]: On master: BEGIN
[0m20:07:31.967344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:31.967621 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:31.967782 [debug] [MainThread]: On master: COMMIT
[0m20:07:31.967936 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:31.968085 [debug] [MainThread]: On master: COMMIT
[0m20:07:31.968324 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:31.968481 [debug] [MainThread]: On master: Close
[0m20:07:31.969838 [debug] [Thread-1 (]: Began running node test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0
[0m20:07:31.970110 [info ] [Thread-1 (]: 1 of 35 START test not_null_golden_profiles_resolved_id ........................ [RUN]
[0m20:07:31.970386 [debug] [Thread-4 (]: Began running node test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873
[0m20:07:31.970606 [debug] [Thread-2 (]: Began running node test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a
[0m20:07:31.970838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_meta, now test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0)
[0m20:07:31.973038 [debug] [Thread-3 (]: Began running node test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601
[0m20:07:31.973290 [info ] [Thread-4 (]: 4 of 35 START test not_null_identity_clusters_resolved_id ...................... [RUN]
[0m20:07:31.973551 [info ] [Thread-2 (]: 2 of 35 START test not_null_identity_clusters_cluster_size ..................... [RUN]
[0m20:07:31.973778 [debug] [Thread-1 (]: Began compiling node test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0
[0m20:07:31.973989 [info ] [Thread-3 (]: 3 of 35 START test not_null_identity_clusters_confidence_score ................. [RUN]
[0m20:07:31.974270 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_staging, now test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873)
[0m20:07:31.974492 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_test_idr_main, now test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a)
[0m20:07:31.981140 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_work, now test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601)
[0m20:07:31.981390 [debug] [Thread-4 (]: Began compiling node test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873
[0m20:07:31.984546 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0"
[0m20:07:31.984785 [debug] [Thread-2 (]: Began compiling node test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a
[0m20:07:31.984990 [debug] [Thread-3 (]: Began compiling node test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601
[0m20:07:31.987258 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873"
[0m20:07:31.989428 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a"
[0m20:07:31.992181 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601"
[0m20:07:31.992881 [debug] [Thread-1 (]: Began executing node test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0
[0m20:07:32.003537 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0"
[0m20:07:32.003864 [debug] [Thread-3 (]: Began executing node test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601
[0m20:07:32.004116 [debug] [Thread-4 (]: Began executing node test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873
[0m20:07:32.005801 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601"
[0m20:07:32.007189 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873"
[0m20:07:32.007398 [debug] [Thread-2 (]: Began executing node test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a
[0m20:07:32.008988 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a"
[0m20:07:32.009281 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0"
[0m20:07:32.009512 [debug] [Thread-1 (]: On test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0: BEGIN
[0m20:07:32.009717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:32.010133 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601"
[0m20:07:32.010365 [debug] [Thread-3 (]: On test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601: BEGIN
[0m20:07:32.010596 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a"
[0m20:07:32.010815 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873"
[0m20:07:32.011020 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:32.011229 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:32.011444 [debug] [Thread-2 (]: On test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a: BEGIN
[0m20:07:32.011650 [debug] [Thread-4 (]: On test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873: BEGIN
[0m20:07:32.011944 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0"
[0m20:07:32.012144 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:32.012350 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.012536 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:32.012739 [debug] [Thread-1 (]: On test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select resolved_id
from "test_idr"."main_idr_out"."golden_profiles"
where resolved_id is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.013005 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601"
[0m20:07:32.013269 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.013560 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.013770 [debug] [Thread-3 (]: On test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select confidence_score
from "test_idr"."main_idr_out"."identity_clusters"
where confidence_score is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.013992 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a"
[0m20:07:32.014206 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873"
[0m20:07:32.014404 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.014656 [debug] [Thread-2 (]: On test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select cluster_size
from "test_idr"."main_idr_out"."identity_clusters"
where cluster_size is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.014929 [debug] [Thread-4 (]: On test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select resolved_id
from "test_idr"."main_idr_out"."identity_clusters"
where resolved_id is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.015191 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.017675 [debug] [Thread-1 (]: On test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0: ROLLBACK
[0m20:07:32.018715 [debug] [Thread-3 (]: On test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601: ROLLBACK
[0m20:07:32.019120 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0'
[0m20:07:32.019348 [debug] [Thread-1 (]: On test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0: Close
[0m20:07:32.019560 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:07:32.019839 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601'
[0m20:07:32.020068 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m20:07:32.020410 [info ] [Thread-1 (]: 1 of 35 PASS not_null_golden_profiles_resolved_id .............................. [[32mPASS[0m in 0.05s]
[0m20:07:32.020696 [debug] [Thread-3 (]: On test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601: Close
[0m20:07:32.021456 [debug] [Thread-2 (]: On test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a: ROLLBACK
[0m20:07:32.021812 [debug] [Thread-1 (]: Finished running node test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0
[0m20:07:32.022525 [debug] [Thread-4 (]: On test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873: ROLLBACK
[0m20:07:32.022854 [info ] [Thread-3 (]: 3 of 35 PASS not_null_identity_clusters_confidence_score ....................... [[32mPASS[0m in 0.04s]
[0m20:07:32.023213 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a'
[0m20:07:32.023449 [debug] [Thread-1 (]: Began running node test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102
[0m20:07:32.023752 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873'
[0m20:07:32.024078 [debug] [Thread-3 (]: Finished running node test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601
[0m20:07:32.024278 [debug] [Thread-2 (]: On test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a: Close
[0m20:07:32.024659 [debug] [Thread-4 (]: On test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873: Close
[0m20:07:32.024497 [info ] [Thread-1 (]: 5 of 35 START test not_null_identity_edges_identifier_type ..................... [RUN]
[0m20:07:32.024928 [debug] [Thread-3 (]: Began running node test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b
[0m20:07:32.025255 [info ] [Thread-2 (]: 2 of 35 PASS not_null_identity_clusters_cluster_size ........................... [[32mPASS[0m in 0.05s]
[0m20:07:32.025540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_golden_profiles_resolved_id.f4c53b2da0, now test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102)
[0m20:07:32.025879 [info ] [Thread-4 (]: 4 of 35 PASS not_null_identity_clusters_resolved_id ............................ [[32mPASS[0m in 0.05s]
[0m20:07:32.026380 [debug] [Thread-2 (]: Finished running node test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a
[0m20:07:32.026068 [info ] [Thread-3 (]: 6 of 35 START test not_null_identity_edges_left_entity_key ..................... [RUN]
[0m20:07:32.026680 [debug] [Thread-1 (]: Began compiling node test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102
[0m20:07:32.027042 [debug] [Thread-4 (]: Finished running node test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873
[0m20:07:32.027490 [debug] [Thread-2 (]: Began running node test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e
[0m20:07:32.027785 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_identity_clusters_confidence_score.ade04fe601, now test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b)
[0m20:07:32.030136 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102"
[0m20:07:32.030465 [debug] [Thread-4 (]: Began running node test.dbt_idr.not_null_identity_membership_entity_key.051834f307
[0m20:07:32.030868 [info ] [Thread-2 (]: 7 of 35 START test not_null_identity_edges_right_entity_key .................... [RUN]
[0m20:07:32.031135 [debug] [Thread-3 (]: Began compiling node test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b
[0m20:07:32.031439 [info ] [Thread-4 (]: 8 of 35 START test not_null_identity_membership_entity_key ..................... [RUN]
[0m20:07:32.031781 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_identity_clusters_cluster_size.7c2849b39a, now test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e)
[0m20:07:32.034368 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b"
[0m20:07:32.034719 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_identity_clusters_resolved_id.0c7e3d6873, now test.dbt_idr.not_null_identity_membership_entity_key.051834f307)
[0m20:07:32.034985 [debug] [Thread-2 (]: Began compiling node test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e
[0m20:07:32.035300 [debug] [Thread-4 (]: Began compiling node test.dbt_idr.not_null_identity_membership_entity_key.051834f307
[0m20:07:32.035553 [debug] [Thread-1 (]: Began executing node test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102
[0m20:07:32.038008 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e"
[0m20:07:32.040567 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_idr.not_null_identity_membership_entity_key.051834f307"
[0m20:07:32.042387 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102"
[0m20:07:32.042703 [debug] [Thread-3 (]: Began executing node test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b
[0m20:07:32.044183 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b"
[0m20:07:32.044621 [debug] [Thread-2 (]: Began executing node test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e
[0m20:07:32.046275 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e"
[0m20:07:32.046556 [debug] [Thread-4 (]: Began executing node test.dbt_idr.not_null_identity_membership_entity_key.051834f307
[0m20:07:32.046861 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102"
[0m20:07:32.048245 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_idr.not_null_identity_membership_entity_key.051834f307"
[0m20:07:32.048495 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b"
[0m20:07:32.048767 [debug] [Thread-1 (]: On test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102: BEGIN
[0m20:07:32.049107 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e"
[0m20:07:32.049349 [debug] [Thread-3 (]: On test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b: BEGIN
[0m20:07:32.049571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:32.049810 [debug] [Thread-2 (]: On test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e: BEGIN
[0m20:07:32.050015 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:32.050247 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.not_null_identity_membership_entity_key.051834f307"
[0m20:07:32.050567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:32.050820 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.051026 [debug] [Thread-4 (]: On test.dbt_idr.not_null_identity_membership_entity_key.051834f307: BEGIN
[0m20:07:32.051236 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.051503 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102"
[0m20:07:32.051705 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:32.051900 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.052086 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b"
[0m20:07:32.052308 [debug] [Thread-1 (]: On test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select identifier_type
from "test_idr"."main_idr_out"."identity_edges"
where identifier_type is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.052584 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e"
[0m20:07:32.052802 [debug] [Thread-3 (]: On test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select left_entity_key
from "test_idr"."main_idr_out"."identity_edges"
where left_entity_key is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.053018 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.053283 [debug] [Thread-2 (]: On test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select right_entity_key
from "test_idr"."main_idr_out"."identity_edges"
where right_entity_key is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.053564 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.not_null_identity_membership_entity_key.051834f307"
[0m20:07:32.053796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.054011 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.054228 [debug] [Thread-4 (]: On test.dbt_idr.not_null_identity_membership_entity_key.051834f307: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_identity_membership_entity_key.051834f307"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select entity_key
from "test_idr"."main_idr_out"."identity_membership"
where entity_key is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.054486 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.055411 [debug] [Thread-3 (]: On test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b: ROLLBACK
[0m20:07:32.056249 [debug] [Thread-1 (]: On test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102: ROLLBACK
[0m20:07:32.057222 [debug] [Thread-2 (]: On test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e: ROLLBACK
[0m20:07:32.057581 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102'
[0m20:07:32.057817 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:07:32.058111 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b'
[0m20:07:32.058382 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e'
[0m20:07:32.058580 [debug] [Thread-1 (]: On test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102: Close
[0m20:07:32.059320 [debug] [Thread-4 (]: On test.dbt_idr.not_null_identity_membership_entity_key.051834f307: ROLLBACK
[0m20:07:32.059514 [debug] [Thread-3 (]: On test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b: Close
[0m20:07:32.059721 [debug] [Thread-2 (]: On test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e: Close
[0m20:07:32.060095 [info ] [Thread-1 (]: 5 of 35 PASS not_null_identity_edges_identifier_type ........................... [[32mPASS[0m in 0.03s]
[0m20:07:32.060438 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_idr.not_null_identity_membership_entity_key.051834f307'
[0m20:07:32.060788 [info ] [Thread-3 (]: 6 of 35 PASS not_null_identity_edges_left_entity_key ........................... [[32mPASS[0m in 0.03s]
[0m20:07:32.061111 [info ] [Thread-2 (]: 7 of 35 PASS not_null_identity_edges_right_entity_key .......................... [[32mPASS[0m in 0.03s]
[0m20:07:32.061440 [debug] [Thread-1 (]: Finished running node test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102
[0m20:07:32.061659 [debug] [Thread-4 (]: On test.dbt_idr.not_null_identity_membership_entity_key.051834f307: Close
[0m20:07:32.061957 [debug] [Thread-3 (]: Finished running node test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b
[0m20:07:32.062234 [debug] [Thread-2 (]: Finished running node test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e
[0m20:07:32.062464 [debug] [Thread-1 (]: Began running node test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7
[0m20:07:32.062723 [debug] [Thread-3 (]: Began running node test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8
[0m20:07:32.063194 [debug] [Thread-2 (]: Began running node test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a
[0m20:07:32.063014 [info ] [Thread-4 (]: 8 of 35 PASS not_null_identity_membership_entity_key ........................... [[32mPASS[0m in 0.03s]
[0m20:07:32.063483 [info ] [Thread-1 (]: 9 of 35 START test not_null_identity_membership_resolved_id .................... [RUN]
[0m20:07:32.063662 [info ] [Thread-3 (]: 10 of 35 START test not_null_int_edges_identifier_type ......................... [RUN]
[0m20:07:32.063938 [info ] [Thread-2 (]: 11 of 35 START test not_null_int_edges_left_entity_key ......................... [RUN]
[0m20:07:32.064232 [debug] [Thread-4 (]: Finished running node test.dbt_idr.not_null_identity_membership_entity_key.051834f307
[0m20:07:32.064450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_identity_edges_identifier_type.c983d9e102, now test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7)
[0m20:07:32.064721 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_identity_edges_left_entity_key.d385e1f04b, now test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8)
[0m20:07:32.064964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_identity_edges_right_entity_key.6633bd3b6e, now test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a)
[0m20:07:32.065183 [debug] [Thread-4 (]: Began running node test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0
[0m20:07:32.065396 [debug] [Thread-1 (]: Began compiling node test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7
[0m20:07:32.065598 [debug] [Thread-3 (]: Began compiling node test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8
[0m20:07:32.065790 [debug] [Thread-2 (]: Began compiling node test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a
[0m20:07:32.065987 [info ] [Thread-4 (]: 12 of 35 START test not_null_int_edges_right_entity_key ........................ [RUN]
[0m20:07:32.068553 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7"
[0m20:07:32.070594 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8"
[0m20:07:32.072785 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a"
[0m20:07:32.073044 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_identity_membership_entity_key.051834f307, now test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0)
[0m20:07:32.073513 [debug] [Thread-4 (]: Began compiling node test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0
[0m20:07:32.075662 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0"
[0m20:07:32.076052 [debug] [Thread-3 (]: Began executing node test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8
[0m20:07:32.077811 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8"
[0m20:07:32.078147 [debug] [Thread-1 (]: Began executing node test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7
[0m20:07:32.079558 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7"
[0m20:07:32.079875 [debug] [Thread-2 (]: Began executing node test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a
[0m20:07:32.081501 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a"
[0m20:07:32.081784 [debug] [Thread-4 (]: Began executing node test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0
[0m20:07:32.082075 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8"
[0m20:07:32.083406 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0"
[0m20:07:32.083712 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a"
[0m20:07:32.083924 [debug] [Thread-3 (]: On test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8: BEGIN
[0m20:07:32.084166 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7"
[0m20:07:32.084400 [debug] [Thread-2 (]: On test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a: BEGIN
[0m20:07:32.084599 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:32.084823 [debug] [Thread-1 (]: On test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7: BEGIN
[0m20:07:32.085046 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:32.085258 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0"
[0m20:07:32.085560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:32.085810 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.086018 [debug] [Thread-4 (]: On test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0: BEGIN
[0m20:07:32.086220 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.086451 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8"
[0m20:07:32.086657 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:32.086868 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.087050 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a"
[0m20:07:32.087252 [debug] [Thread-3 (]: On test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select identifier_type
from "test_idr"."main_idr_work"."int_edges"
where identifier_type is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.087517 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7"
[0m20:07:32.087730 [debug] [Thread-2 (]: On test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select left_entity_key
from "test_idr"."main_idr_work"."int_edges"
where left_entity_key is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.087935 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.088200 [debug] [Thread-1 (]: On test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select resolved_id
from "test_idr"."main_idr_out"."identity_membership"
where resolved_id is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.088492 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0"
[0m20:07:32.088771 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.088980 [debug] [Thread-4 (]: On test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select right_entity_key
from "test_idr"."main_idr_work"."int_edges"
where right_entity_key is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.089196 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.089463 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.090316 [debug] [Thread-3 (]: On test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8: ROLLBACK
[0m20:07:32.091153 [debug] [Thread-2 (]: On test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a: ROLLBACK
[0m20:07:32.091904 [debug] [Thread-1 (]: On test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7: ROLLBACK
[0m20:07:32.092141 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:07:32.092469 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a'
[0m20:07:32.092732 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8'
[0m20:07:32.093037 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7'
[0m20:07:32.093780 [debug] [Thread-4 (]: On test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0: ROLLBACK
[0m20:07:32.094000 [debug] [Thread-2 (]: On test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a: Close
[0m20:07:32.094198 [debug] [Thread-3 (]: On test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8: Close
[0m20:07:32.094385 [debug] [Thread-1 (]: On test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7: Close
[0m20:07:32.094675 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0'
[0m20:07:32.095003 [info ] [Thread-2 (]: 11 of 35 PASS not_null_int_edges_left_entity_key ............................... [[32mPASS[0m in 0.03s]
[0m20:07:32.095249 [info ] [Thread-3 (]: 10 of 35 PASS not_null_int_edges_identifier_type ............................... [[32mPASS[0m in 0.03s]
[0m20:07:32.095782 [debug] [Thread-4 (]: On test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0: Close
[0m20:07:32.095626 [info ] [Thread-1 (]: 9 of 35 PASS not_null_identity_membership_resolved_id .......................... [[32mPASS[0m in 0.03s]
[0m20:07:32.096120 [debug] [Thread-2 (]: Finished running node test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a
[0m20:07:32.096385 [debug] [Thread-3 (]: Finished running node test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8
[0m20:07:32.096898 [debug] [Thread-1 (]: Finished running node test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7
[0m20:07:32.096669 [info ] [Thread-4 (]: 12 of 35 PASS not_null_int_edges_right_entity_key .............................. [[32mPASS[0m in 0.02s]
[0m20:07:32.097180 [debug] [Thread-2 (]: Began running node test.dbt_idr.not_null_int_labels_entity_key.7611c7b464
[0m20:07:32.097429 [debug] [Thread-3 (]: Began running node test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e
[0m20:07:32.097653 [debug] [Thread-1 (]: Began running node test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7
[0m20:07:32.097937 [debug] [Thread-4 (]: Finished running node test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0
[0m20:07:32.098151 [info ] [Thread-2 (]: 13 of 35 START test not_null_int_labels_entity_key ............................. [RUN]
[0m20:07:32.098324 [info ] [Thread-3 (]: 14 of 35 START test not_null_int_labels_resolved_id ............................ [RUN]
[0m20:07:32.098769 [debug] [Thread-4 (]: Began running node test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec
[0m20:07:32.098547 [info ] [Thread-1 (]: 15 of 35 START test not_null_rule_match_audit_edges_created .................... [RUN]
[0m20:07:32.099060 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_int_edges_left_entity_key.5e1bb3304a, now test.dbt_idr.not_null_int_labels_entity_key.7611c7b464)
[0m20:07:32.099277 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_int_edges_identifier_type.cf2ecb82b8, now test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e)
[0m20:07:32.099488 [info ] [Thread-4 (]: 16 of 35 START test not_null_rule_match_audit_rule_id .......................... [RUN]
[0m20:07:32.099735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_identity_membership_resolved_id.e90cf0c7f7, now test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7)
[0m20:07:32.099993 [debug] [Thread-2 (]: Began compiling node test.dbt_idr.not_null_int_labels_entity_key.7611c7b464
[0m20:07:32.100197 [debug] [Thread-3 (]: Began compiling node test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e
[0m20:07:32.100427 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_int_edges_right_entity_key.a4d93ebaa0, now test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec)
[0m20:07:32.100634 [debug] [Thread-1 (]: Began compiling node test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7
[0m20:07:32.104957 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_idr.not_null_int_labels_entity_key.7611c7b464"
[0m20:07:32.107497 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e"
[0m20:07:32.107790 [debug] [Thread-4 (]: Began compiling node test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec
[0m20:07:32.109974 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7"
[0m20:07:32.112507 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec"
[0m20:07:32.113022 [debug] [Thread-2 (]: Began executing node test.dbt_idr.not_null_int_labels_entity_key.7611c7b464
[0m20:07:32.113295 [debug] [Thread-3 (]: Began executing node test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e
[0m20:07:32.113538 [debug] [Thread-4 (]: Began executing node test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec
[0m20:07:32.114979 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_idr.not_null_int_labels_entity_key.7611c7b464"
[0m20:07:32.115211 [debug] [Thread-1 (]: Began executing node test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7
[0m20:07:32.116668 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e"
[0m20:07:32.117871 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec"
[0m20:07:32.119590 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7"
[0m20:07:32.120082 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_int_labels_entity_key.7611c7b464"
[0m20:07:32.120323 [debug] [Thread-2 (]: On test.dbt_idr.not_null_int_labels_entity_key.7611c7b464: BEGIN
[0m20:07:32.120563 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec"
[0m20:07:32.120790 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e"
[0m20:07:32.121002 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:32.121235 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7"
[0m20:07:32.121445 [debug] [Thread-4 (]: On test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec: BEGIN
[0m20:07:32.121648 [debug] [Thread-3 (]: On test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e: BEGIN
[0m20:07:32.121973 [debug] [Thread-1 (]: On test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7: BEGIN
[0m20:07:32.122170 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:32.122378 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.122564 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:32.122751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:32.122999 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_int_labels_entity_key.7611c7b464"
[0m20:07:32.123297 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.123571 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.123794 [debug] [Thread-2 (]: On test.dbt_idr.not_null_int_labels_entity_key.7611c7b464: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_int_labels_entity_key.7611c7b464"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select entity_key
from "test_idr"."main_idr_work"."int_labels"
where entity_key is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.124005 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.124198 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec"
[0m20:07:32.124402 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e"
[0m20:07:32.124676 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7"
[0m20:07:32.124898 [debug] [Thread-4 (]: On test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select rule_id
from "test_idr"."main_idr_out"."rule_match_audit"
where rule_id is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.125135 [debug] [Thread-3 (]: On test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select resolved_id
from "test_idr"."main_idr_work"."int_labels"
where resolved_id is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.125349 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.125553 [debug] [Thread-1 (]: On test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select edges_created
from "test_idr"."main_idr_out"."rule_match_audit"
where edges_created is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.126806 [debug] [Thread-2 (]: On test.dbt_idr.not_null_int_labels_entity_key.7611c7b464: ROLLBACK
[0m20:07:32.127090 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.127313 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.127563 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:32.127912 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_idr.not_null_int_labels_entity_key.7611c7b464'
[0m20:07:32.128882 [debug] [Thread-4 (]: On test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec: ROLLBACK
[0m20:07:32.129748 [debug] [Thread-3 (]: On test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e: ROLLBACK
[0m20:07:32.130593 [debug] [Thread-1 (]: On test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7: ROLLBACK
[0m20:07:32.130840 [debug] [Thread-2 (]: On test.dbt_idr.not_null_int_labels_entity_key.7611c7b464: Close
[0m20:07:32.131182 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec'
[0m20:07:32.131506 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e'
[0m20:07:32.131832 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7'
[0m20:07:32.132181 [info ] [Thread-2 (]: 13 of 35 PASS not_null_int_labels_entity_key ................................... [[32mPASS[0m in 0.03s]
[0m20:07:32.132410 [debug] [Thread-4 (]: On test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec: Close
[0m20:07:32.132624 [debug] [Thread-3 (]: On test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e: Close
[0m20:07:32.132833 [debug] [Thread-1 (]: On test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7: Close
[0m20:07:32.133120 [debug] [Thread-2 (]: Finished running node test.dbt_idr.not_null_int_labels_entity_key.7611c7b464
[0m20:07:32.133457 [info ] [Thread-3 (]: 14 of 35 PASS not_null_int_labels_resolved_id .................................. [[32mPASS[0m in 0.03s]
[0m20:07:32.134217 [debug] [Thread-2 (]: Began running node test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec
[0m20:07:32.134506 [debug] [Thread-3 (]: Finished running node test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e
[0m20:07:32.133715 [info ] [Thread-4 (]: 16 of 35 PASS not_null_rule_match_audit_rule_id ................................ [[32mPASS[0m in 0.03s]
[0m20:07:32.134024 [info ] [Thread-1 (]: 15 of 35 PASS not_null_rule_match_audit_edges_created .......................... [[32mPASS[0m in 0.03s]
[0m20:07:32.135062 [debug] [Thread-3 (]: Began running node test.dbt_idr.not_null_run_history_status.b95ff5281c
[0m20:07:32.134821 [info ] [Thread-2 (]: 17 of 35 START test not_null_run_history_run_id ................................ [RUN]
[0m20:07:32.135421 [debug] [Thread-4 (]: Finished running node test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec
[0m20:07:32.135698 [debug] [Thread-1 (]: Finished running node test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7
[0m20:07:32.135898 [info ] [Thread-3 (]: 18 of 35 START test not_null_run_history_status ................................ [RUN]
[0m20:07:32.136138 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_int_labels_entity_key.7611c7b464, now test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec)
[0m20:07:32.136360 [debug] [Thread-4 (]: Began running node test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52
[0m20:07:32.136568 [debug] [Thread-1 (]: Began running node test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e
[0m20:07:32.136797 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_int_labels_resolved_id.02359cdb4e, now test.dbt_idr.not_null_run_history_status.b95ff5281c)
[0m20:07:32.137005 [debug] [Thread-2 (]: Began compiling node test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec
[0m20:07:32.137205 [info ] [Thread-4 (]: 19 of 35 START test not_null_skipped_identifier_groups_identifier_type ......... [RUN]
[0m20:07:32.137516 [info ] [Thread-1 (]: 20 of 35 START test not_null_skipped_identifier_groups_reason .................. [RUN]
[0m20:07:32.137817 [debug] [Thread-3 (]: Began compiling node test.dbt_idr.not_null_run_history_status.b95ff5281c
[0m20:07:32.140442 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec"
[0m20:07:32.140702 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_rule_match_audit_rule_id.b74bbae7ec, now test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52)
[0m20:07:32.141039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_rule_match_audit_edges_created.330b2752a7, now test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e)
[0m20:07:32.143568 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_idr.not_null_run_history_status.b95ff5281c"
[0m20:07:32.143966 [debug] [Thread-4 (]: Began compiling node test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52
[0m20:07:32.144315 [debug] [Thread-1 (]: Began compiling node test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e
[0m20:07:32.146470 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52"
[0m20:07:32.146692 [debug] [Thread-2 (]: Began executing node test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec
[0m20:07:32.148908 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e"
[0m20:07:32.149209 [debug] [Thread-3 (]: Began executing node test.dbt_idr.not_null_run_history_status.b95ff5281c
[0m20:07:32.150788 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec"
[0m20:07:32.152220 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_idr.not_null_run_history_status.b95ff5281c"
[0m20:07:32.152543 [debug] [Thread-4 (]: Began executing node test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52
[0m20:07:32.152795 [debug] [Thread-1 (]: Began executing node test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e
[0m20:07:32.154560 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52"
[0m20:07:32.155989 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e"
[0m20:07:32.156323 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec"
[0m20:07:32.156683 [debug] [Thread-2 (]: On test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec: BEGIN
[0m20:07:32.156954 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_run_history_status.b95ff5281c"
[0m20:07:32.157192 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:32.157439 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52"
[0m20:07:32.157690 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e"
[0m20:07:32.157894 [debug] [Thread-3 (]: On test.dbt_idr.not_null_run_history_status.b95ff5281c: BEGIN
[0m20:07:32.158239 [debug] [Thread-4 (]: On test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52: BEGIN
[0m20:07:32.158452 [debug] [Thread-1 (]: On test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e: BEGIN
[0m20:07:32.158672 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.158853 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:32.159043 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:32.159244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:32.159443 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec"
[0m20:07:32.159889 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.160105 [debug] [Thread-2 (]: On test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select run_id
from "test_idr"."main_idr_out"."run_history"
where run_id is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.160329 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.160542 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_run_history_status.b95ff5281c"
[0m20:07:32.160738 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.161021 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52"
[0m20:07:32.161242 [debug] [Thread-3 (]: On test.dbt_idr.not_null_run_history_status.b95ff5281c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_run_history_status.b95ff5281c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select status
from "test_idr"."main_idr_out"."run_history"
where status is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.161478 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e"
[0m20:07:32.161678 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.161888 [debug] [Thread-4 (]: On test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select identifier_type
from "test_idr"."main_idr_out"."skipped_identifier_groups"
where identifier_type is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.162211 [debug] [Thread-1 (]: On test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select reason
from "test_idr"."main_idr_out"."skipped_identifier_groups"
where reason is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.162563 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:07:32.163649 [debug] [Thread-2 (]: On test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec: ROLLBACK
[0m20:07:32.163973 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.164283 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:32.164640 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec'
[0m20:07:32.165436 [debug] [Thread-3 (]: On test.dbt_idr.not_null_run_history_status.b95ff5281c: ROLLBACK
[0m20:07:32.166249 [debug] [Thread-4 (]: On test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52: ROLLBACK
[0m20:07:32.166942 [debug] [Thread-1 (]: On test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e: ROLLBACK
[0m20:07:32.167147 [debug] [Thread-2 (]: On test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec: Close
[0m20:07:32.167515 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_idr.not_null_run_history_status.b95ff5281c'
[0m20:07:32.167840 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52'
[0m20:07:32.168135 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e'
[0m20:07:32.168363 [debug] [Thread-3 (]: On test.dbt_idr.not_null_run_history_status.b95ff5281c: Close
[0m20:07:32.168693 [info ] [Thread-2 (]: 17 of 35 PASS not_null_run_history_run_id ...................................... [[32mPASS[0m in 0.03s]
[0m20:07:32.168968 [debug] [Thread-4 (]: On test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52: Close
[0m20:07:32.169207 [debug] [Thread-1 (]: On test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e: Close
[0m20:07:32.169524 [debug] [Thread-2 (]: Finished running node test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec
[0m20:07:32.169834 [info ] [Thread-3 (]: 18 of 35 PASS not_null_run_history_status ...................................... [[32mPASS[0m in 0.03s]
[0m20:07:32.170184 [info ] [Thread-4 (]: 19 of 35 PASS not_null_skipped_identifier_groups_identifier_type ............... [[32mPASS[0m in 0.03s]
[0m20:07:32.170712 [debug] [Thread-2 (]: Began running node test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5
[0m20:07:32.170463 [info ] [Thread-1 (]: 20 of 35 PASS not_null_skipped_identifier_groups_reason ........................ [[32mPASS[0m in 0.03s]
[0m20:07:32.171070 [debug] [Thread-3 (]: Finished running node test.dbt_idr.not_null_run_history_status.b95ff5281c
[0m20:07:32.171373 [debug] [Thread-4 (]: Finished running node test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52
[0m20:07:32.171581 [info ] [Thread-2 (]: 21 of 35 START test not_null_stage_metrics_run_id .............................. [RUN]
[0m20:07:32.171860 [debug] [Thread-1 (]: Finished running node test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e
[0m20:07:32.172075 [debug] [Thread-3 (]: Began running node test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa
[0m20:07:32.172278 [debug] [Thread-4 (]: Began running node test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9
[0m20:07:32.172512 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_run_history_run_id.d0b93ac2ec, now test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5)
[0m20:07:32.172737 [debug] [Thread-1 (]: Began running node test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712
[0m20:07:32.172936 [info ] [Thread-3 (]: 22 of 35 START test not_null_stage_metrics_stage_name .......................... [RUN]
[0m20:07:32.173164 [info ] [Thread-4 (]: 23 of 35 START test not_null_stg_identifiers_entity_key ........................ [RUN]
[0m20:07:32.173400 [debug] [Thread-2 (]: Began compiling node test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5
[0m20:07:32.173704 [info ] [Thread-1 (]: 24 of 35 START test not_null_stg_identifiers_identifier_type ................... [RUN]
[0m20:07:32.174005 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_run_history_status.b95ff5281c, now test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa)
[0m20:07:32.174293 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_skipped_identifier_groups_identifier_type.fe44c74a52, now test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9)
[0m20:07:32.177191 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5"
[0m20:07:32.177450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_skipped_identifier_groups_reason.18a8b6c66e, now test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712)
[0m20:07:32.177671 [debug] [Thread-3 (]: Began compiling node test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa
[0m20:07:32.177872 [debug] [Thread-4 (]: Began compiling node test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9
[0m20:07:32.178189 [debug] [Thread-1 (]: Began compiling node test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712
[0m20:07:32.180617 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa"
[0m20:07:32.183020 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9"
[0m20:07:32.185703 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712"
[0m20:07:32.186093 [debug] [Thread-2 (]: Began executing node test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5
[0m20:07:32.187918 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5"
[0m20:07:32.188226 [debug] [Thread-3 (]: Began executing node test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa
[0m20:07:32.189545 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa"
[0m20:07:32.189809 [debug] [Thread-4 (]: Began executing node test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9
[0m20:07:32.190089 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5"
[0m20:07:32.191600 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9"
[0m20:07:32.191869 [debug] [Thread-2 (]: On test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5: BEGIN
[0m20:07:32.192089 [debug] [Thread-1 (]: Began executing node test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712
[0m20:07:32.192347 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa"
[0m20:07:32.192668 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:32.194066 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712"
[0m20:07:32.194326 [debug] [Thread-3 (]: On test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa: BEGIN
[0m20:07:32.194837 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9"
[0m20:07:32.195072 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:32.195351 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m20:07:32.195558 [debug] [Thread-4 (]: On test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9: BEGIN
[0m20:07:32.195787 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712"
[0m20:07:32.196063 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5"
[0m20:07:32.196276 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:32.196481 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.196682 [debug] [Thread-1 (]: On test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712: BEGIN
[0m20:07:32.196905 [debug] [Thread-2 (]: On test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select run_id
from "test_idr"."main_idr_out"."stage_metrics"
where run_id is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.197180 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa"
[0m20:07:32.197384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:32.197589 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.197881 [debug] [Thread-3 (]: On test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select stage_name
from "test_idr"."main_idr_out"."stage_metrics"
where stage_name is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.198200 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9"
[0m20:07:32.198448 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.198667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.198919 [debug] [Thread-4 (]: On test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select entity_key
from "test_idr"."main_idr_staging"."stg_identifiers"
where entity_key is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.199173 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712"
[0m20:07:32.200033 [debug] [Thread-2 (]: On test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5: ROLLBACK
[0m20:07:32.200248 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:07:32.200544 [debug] [Thread-1 (]: On test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select identifier_type
from "test_idr"."main_idr_staging"."stg_identifiers"
where identifier_type is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.200813 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:07:32.201160 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5'
[0m20:07:32.201990 [debug] [Thread-3 (]: On test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa: ROLLBACK
[0m20:07:32.202818 [debug] [Thread-4 (]: On test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9: ROLLBACK
[0m20:07:32.203025 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:32.203223 [debug] [Thread-2 (]: On test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5: Close
[0m20:07:32.203585 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa'
[0m20:07:32.203904 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9'
[0m20:07:32.204618 [debug] [Thread-1 (]: On test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712: ROLLBACK
[0m20:07:32.204964 [info ] [Thread-2 (]: 21 of 35 PASS not_null_stage_metrics_run_id .................................... [[32mPASS[0m in 0.03s]
[0m20:07:32.205221 [debug] [Thread-3 (]: On test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa: Close
[0m20:07:32.205428 [debug] [Thread-4 (]: On test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9: Close
[0m20:07:32.205750 [debug] [Thread-2 (]: Finished running node test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5
[0m20:07:32.206026 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712'
[0m20:07:32.206340 [info ] [Thread-3 (]: 22 of 35 PASS not_null_stage_metrics_stage_name ................................ [[32mPASS[0m in 0.03s]
[0m20:07:32.206825 [debug] [Thread-2 (]: Began running node test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023
[0m20:07:32.207044 [debug] [Thread-1 (]: On test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712: Close
[0m20:07:32.206573 [info ] [Thread-4 (]: 23 of 35 PASS not_null_stg_identifiers_entity_key .............................. [[32mPASS[0m in 0.03s]
[0m20:07:32.207412 [debug] [Thread-3 (]: Finished running node test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa
[0m20:07:32.207646 [info ] [Thread-2 (]: 25 of 35 START test not_null_stg_identifiers_identifier_value_norm ............. [RUN]
[0m20:07:32.208210 [debug] [Thread-4 (]: Finished running node test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9
[0m20:07:32.207968 [info ] [Thread-1 (]: 24 of 35 PASS not_null_stg_identifiers_identifier_type ......................... [[32mPASS[0m in 0.03s]
[0m20:07:32.208523 [debug] [Thread-3 (]: Began running node test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2
[0m20:07:32.208772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_stage_metrics_run_id.d4cdc814d5, now test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023)
[0m20:07:32.209007 [debug] [Thread-4 (]: Began running node test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd
[0m20:07:32.209304 [debug] [Thread-1 (]: Finished running node test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712
[0m20:07:32.209692 [debug] [Thread-2 (]: Began compiling node test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023
[0m20:07:32.209516 [info ] [Thread-3 (]: 26 of 35 START test not_null_stg_identifiers_source_id ......................... [RUN]
[0m20:07:32.210001 [info ] [Thread-4 (]: 27 of 35 START test unique_golden_profiles_resolved_id ......................... [RUN]
[0m20:07:32.210253 [debug] [Thread-1 (]: Began running node test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9
[0m20:07:32.212747 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023"
[0m20:07:32.213013 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_stage_metrics_stage_name.2dd0aef8aa, now test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2)
[0m20:07:32.213260 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_stg_identifiers_entity_key.e7be19bbd9, now test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd)
[0m20:07:32.213705 [debug] [Thread-3 (]: Began compiling node test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2
[0m20:07:32.213489 [info ] [Thread-1 (]: 28 of 35 START test unique_identity_clusters_resolved_id ....................... [RUN]
[0m20:07:32.213973 [debug] [Thread-4 (]: Began compiling node test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd
[0m20:07:32.216678 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2"
[0m20:07:32.217009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_stg_identifiers_identifier_type.95d25b8712, now test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9)
[0m20:07:32.220609 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd"
[0m20:07:32.220905 [debug] [Thread-2 (]: Began executing node test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023
[0m20:07:32.221214 [debug] [Thread-1 (]: Began compiling node test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9
[0m20:07:32.225162 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023"
[0m20:07:32.227285 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9"
[0m20:07:32.227703 [debug] [Thread-3 (]: Began executing node test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2
[0m20:07:32.227981 [debug] [Thread-4 (]: Began executing node test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd
[0m20:07:32.229722 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2"
[0m20:07:32.229994 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023"
[0m20:07:32.231277 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd"
[0m20:07:32.231581 [debug] [Thread-1 (]: Began executing node test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9
[0m20:07:32.231796 [debug] [Thread-2 (]: On test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023: BEGIN
[0m20:07:32.233380 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9"
[0m20:07:32.233646 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2"
[0m20:07:32.233929 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:32.234199 [debug] [Thread-3 (]: On test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2: BEGIN
[0m20:07:32.234466 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd"
[0m20:07:32.234838 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:32.235121 [debug] [Thread-4 (]: On test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd: BEGIN
[0m20:07:32.235574 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:07:32.235889 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9"
[0m20:07:32.236099 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:32.236311 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.236566 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023"
[0m20:07:32.236804 [debug] [Thread-1 (]: On test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9: BEGIN
[0m20:07:32.237177 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2"
[0m20:07:32.237442 [debug] [Thread-2 (]: On test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select identifier_value_norm
from "test_idr"."main_idr_staging"."stg_identifiers"
where identifier_value_norm is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.237718 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:07:32.237925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:32.238171 [debug] [Thread-3 (]: On test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select source_id
from "test_idr"."main_idr_staging"."stg_identifiers"
where source_id is null



  
  
      
    ) dbt_internal_test
[0m20:07:32.238499 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd"
[0m20:07:32.238903 [debug] [Thread-4 (]: On test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    resolved_id as unique_field,
    count(*) as n_records

from "test_idr"."main_idr_out"."golden_profiles"
where resolved_id is not null
group by resolved_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:07:32.239167 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.239479 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.239688 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:32.240027 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9"
[0m20:07:32.240254 [debug] [Thread-1 (]: On test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    resolved_id as unique_field,
    count(*) as n_records

from "test_idr"."main_idr_out"."identity_clusters"
where resolved_id is not null
group by resolved_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:07:32.241168 [debug] [Thread-3 (]: On test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2: ROLLBACK
[0m20:07:32.241899 [debug] [Thread-2 (]: On test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023: ROLLBACK
[0m20:07:32.242231 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:07:32.242655 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2'
[0m20:07:32.242987 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023'
[0m20:07:32.243245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.243464 [debug] [Thread-3 (]: On test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2: Close
[0m20:07:32.244212 [debug] [Thread-4 (]: On test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd: ROLLBACK
[0m20:07:32.244411 [debug] [Thread-2 (]: On test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023: Close
[0m20:07:32.245286 [debug] [Thread-1 (]: On test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9: ROLLBACK
[0m20:07:32.245888 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd'
[0m20:07:32.245616 [info ] [Thread-3 (]: 26 of 35 PASS not_null_stg_identifiers_source_id ............................... [[32mPASS[0m in 0.03s]
[0m20:07:32.246276 [info ] [Thread-2 (]: 25 of 35 PASS not_null_stg_identifiers_identifier_value_norm ................... [[32mPASS[0m in 0.04s]
[0m20:07:32.246506 [debug] [Thread-4 (]: On test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd: Close
[0m20:07:32.246781 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9'
[0m20:07:32.247079 [debug] [Thread-3 (]: Finished running node test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2
[0m20:07:32.247374 [debug] [Thread-2 (]: Finished running node test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023
[0m20:07:32.247831 [debug] [Thread-1 (]: On test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9: Close
[0m20:07:32.247673 [info ] [Thread-4 (]: 27 of 35 PASS unique_golden_profiles_resolved_id ............................... [[32mPASS[0m in 0.03s]
[0m20:07:32.248118 [debug] [Thread-3 (]: Began running node test.dbt_idr.unique_identity_membership_entity_key.e26b27622f
[0m20:07:32.248377 [debug] [Thread-2 (]: Began running node test.dbt_idr.unique_int_labels_entity_key.bd2adc0180
[0m20:07:32.248702 [debug] [Thread-4 (]: Finished running node test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd
[0m20:07:32.248973 [info ] [Thread-1 (]: 28 of 35 PASS unique_identity_clusters_resolved_id ............................. [[32mPASS[0m in 0.03s]
[0m20:07:32.249223 [info ] [Thread-3 (]: 29 of 35 START test unique_identity_membership_entity_key ...................... [RUN]
[0m20:07:32.249452 [info ] [Thread-2 (]: 30 of 35 START test unique_int_labels_entity_key ............................... [RUN]
[0m20:07:32.249715 [debug] [Thread-4 (]: Began running node test.dbt_idr_integration_tests.test_alice_cluster
[0m20:07:32.249986 [debug] [Thread-1 (]: Finished running node test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9
[0m20:07:32.250234 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_stg_identifiers_source_id.3de0e454a2, now test.dbt_idr.unique_identity_membership_entity_key.e26b27622f)
[0m20:07:32.250454 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_idr.not_null_stg_identifiers_identifier_value_norm.efe5482023, now test.dbt_idr.unique_int_labels_entity_key.bd2adc0180)
[0m20:07:32.250660 [info ] [Thread-4 (]: 31 of 35 START test test_alice_cluster ......................................... [RUN]
[0m20:07:32.250913 [debug] [Thread-1 (]: Began running node test.dbt_idr_integration_tests.test_clusters_created
[0m20:07:32.251275 [debug] [Thread-3 (]: Began compiling node test.dbt_idr.unique_identity_membership_entity_key.e26b27622f
[0m20:07:32.252236 [debug] [Thread-2 (]: Began compiling node test.dbt_idr.unique_int_labels_entity_key.bd2adc0180
[0m20:07:32.252502 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_idr.unique_golden_profiles_resolved_id.e6bc09a4dd, now test.dbt_idr_integration_tests.test_alice_cluster)
[0m20:07:32.252736 [info ] [Thread-1 (]: 32 of 35 START test test_clusters_created ...................................... [RUN]
[0m20:07:32.255133 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_idr.unique_identity_membership_entity_key.e26b27622f"
[0m20:07:32.260095 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_idr.unique_int_labels_entity_key.bd2adc0180"
[0m20:07:32.261564 [debug] [Thread-4 (]: Began compiling node test.dbt_idr_integration_tests.test_alice_cluster
[0m20:07:32.261920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idr.unique_identity_clusters_resolved_id.d5699b74f9, now test.dbt_idr_integration_tests.test_clusters_created)
[0m20:07:32.263745 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_idr_integration_tests.test_alice_cluster"
[0m20:07:32.264011 [debug] [Thread-1 (]: Began compiling node test.dbt_idr_integration_tests.test_clusters_created
[0m20:07:32.265842 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idr_integration_tests.test_clusters_created"
[0m20:07:32.270613 [debug] [Thread-2 (]: Began executing node test.dbt_idr.unique_int_labels_entity_key.bd2adc0180
[0m20:07:32.270912 [debug] [Thread-3 (]: Began executing node test.dbt_idr.unique_identity_membership_entity_key.e26b27622f
[0m20:07:32.272716 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_idr.unique_int_labels_entity_key.bd2adc0180"
[0m20:07:32.276628 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_idr.unique_identity_membership_entity_key.e26b27622f"
[0m20:07:32.277110 [debug] [Thread-1 (]: Began executing node test.dbt_idr_integration_tests.test_clusters_created
[0m20:07:32.278486 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idr_integration_tests.test_clusters_created"
[0m20:07:32.278887 [debug] [Thread-4 (]: Began executing node test.dbt_idr_integration_tests.test_alice_cluster
[0m20:07:32.279272 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.unique_identity_membership_entity_key.e26b27622f"
[0m20:07:32.279496 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.unique_int_labels_entity_key.bd2adc0180"
[0m20:07:32.280787 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_idr_integration_tests.test_alice_cluster"
[0m20:07:32.282919 [debug] [Thread-3 (]: On test.dbt_idr.unique_identity_membership_entity_key.e26b27622f: BEGIN
[0m20:07:32.283205 [debug] [Thread-2 (]: On test.dbt_idr.unique_int_labels_entity_key.bd2adc0180: BEGIN
[0m20:07:32.283503 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr_integration_tests.test_clusters_created"
[0m20:07:32.283758 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:32.284046 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:32.284324 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr_integration_tests.test_alice_cluster"
[0m20:07:32.284576 [debug] [Thread-1 (]: On test.dbt_idr_integration_tests.test_clusters_created: BEGIN
[0m20:07:32.285017 [debug] [Thread-4 (]: On test.dbt_idr_integration_tests.test_alice_cluster: BEGIN
[0m20:07:32.285244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:32.285463 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.285658 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:07:32.285860 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:07:32.286118 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr.unique_int_labels_entity_key.bd2adc0180"
[0m20:07:32.286319 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr.unique_identity_membership_entity_key.e26b27622f"
[0m20:07:32.286522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.286760 [debug] [Thread-2 (]: On test.dbt_idr.unique_int_labels_entity_key.bd2adc0180: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.unique_int_labels_entity_key.bd2adc0180"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    entity_key as unique_field,
    count(*) as n_records

from "test_idr"."main_idr_work"."int_labels"
where entity_key is not null
group by entity_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:07:32.286988 [debug] [Thread-3 (]: On test.dbt_idr.unique_identity_membership_entity_key.e26b27622f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr.unique_identity_membership_entity_key.e26b27622f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    entity_key as unique_field,
    count(*) as n_records

from "test_idr"."main_idr_out"."identity_membership"
where entity_key is not null
group by entity_key
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m20:07:32.287200 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.287399 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr_integration_tests.test_clusters_created"
[0m20:07:32.287778 [debug] [Thread-4 (]: Using duckdb connection "test.dbt_idr_integration_tests.test_alice_cluster"
[0m20:07:32.288016 [debug] [Thread-1 (]: On test.dbt_idr_integration_tests.test_clusters_created: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr_integration_tests.test_clusters_created"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test: Verify clusters were created
-- Expected: Multiple clusters from matching identifiers

with cluster_count as (
    select count(*) as cnt from "test_idr"."main_idr_out"."identity_clusters"
)
select 'FAIL: No clusters created' as error
from cluster_count
where cnt = 0
  
  
      
    ) dbt_internal_test
[0m20:07:32.288282 [debug] [Thread-4 (]: On test.dbt_idr_integration_tests.test_alice_cluster: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr_integration_tests.test_alice_cluster"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test: Verify Alice cluster has multiple members
-- alice@example.com appears in CRM rows 1 and 4, and orders

with alice_cluster as (
    select m.resolved_id, count(*) as member_count
    from "test_idr"."main_idr_out"."identity_membership" m
    where m.entity_key like 'crm:1' or m.entity_key like 'crm:4'
       or m.entity_key like 'orders:101' or m.entity_key like 'orders:106'
    group by m.resolved_id
)
select 'FAIL: Alice cluster should have multiple members' as error
from alice_cluster
where member_count < 2
  
  
      
    ) dbt_internal_test
[0m20:07:32.288565 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.288838 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.289224 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:32.290166 [debug] [Thread-2 (]: On test.dbt_idr.unique_int_labels_entity_key.bd2adc0180: ROLLBACK
[0m20:07:32.290551 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.291408 [debug] [Thread-1 (]: On test.dbt_idr_integration_tests.test_clusters_created: ROLLBACK
[0m20:07:32.292139 [debug] [Thread-3 (]: On test.dbt_idr.unique_identity_membership_entity_key.e26b27622f: ROLLBACK
[0m20:07:32.292489 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_idr.unique_int_labels_entity_key.bd2adc0180'
[0m20:07:32.292848 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_idr_integration_tests.test_clusters_created'
[0m20:07:32.293641 [debug] [Thread-4 (]: On test.dbt_idr_integration_tests.test_alice_cluster: ROLLBACK
[0m20:07:32.293996 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_idr.unique_identity_membership_entity_key.e26b27622f'
[0m20:07:32.294193 [debug] [Thread-2 (]: On test.dbt_idr.unique_int_labels_entity_key.bd2adc0180: Close
[0m20:07:32.294408 [debug] [Thread-1 (]: On test.dbt_idr_integration_tests.test_clusters_created: Close
[0m20:07:32.294658 [debug] [Thread-3 (]: On test.dbt_idr.unique_identity_membership_entity_key.e26b27622f: Close
[0m20:07:32.294936 [debug] [Thread-4 (]: Failed to rollback 'test.dbt_idr_integration_tests.test_alice_cluster'
[0m20:07:32.295332 [info ] [Thread-2 (]: 30 of 35 PASS unique_int_labels_entity_key ..................................... [[32mPASS[0m in 0.04s]
[0m20:07:32.295656 [info ] [Thread-1 (]: 32 of 35 PASS test_clusters_created ............................................ [[32mPASS[0m in 0.03s]
[0m20:07:32.296152 [debug] [Thread-4 (]: On test.dbt_idr_integration_tests.test_alice_cluster: Close
[0m20:07:32.295981 [info ] [Thread-3 (]: 29 of 35 PASS unique_identity_membership_entity_key ............................ [[32mPASS[0m in 0.05s]
[0m20:07:32.296511 [debug] [Thread-2 (]: Finished running node test.dbt_idr.unique_int_labels_entity_key.bd2adc0180
[0m20:07:32.296782 [debug] [Thread-1 (]: Finished running node test.dbt_idr_integration_tests.test_clusters_created
[0m20:07:32.297076 [info ] [Thread-4 (]: 31 of 35 PASS test_alice_cluster ............................................... [[32mPASS[0m in 0.04s]
[0m20:07:32.297375 [debug] [Thread-3 (]: Finished running node test.dbt_idr.unique_identity_membership_entity_key.e26b27622f
[0m20:07:32.297622 [debug] [Thread-2 (]: Began running node test.dbt_idr_integration_tests.test_confidence_scores
[0m20:07:32.297890 [debug] [Thread-1 (]: Began running node test.dbt_idr_integration_tests.test_edges_created
[0m20:07:32.298197 [debug] [Thread-4 (]: Finished running node test.dbt_idr_integration_tests.test_alice_cluster
[0m20:07:32.298427 [debug] [Thread-3 (]: Began running node test.dbt_idr_integration_tests.test_golden_profiles
[0m20:07:32.298657 [info ] [Thread-2 (]: 33 of 35 START test test_confidence_scores ..................................... [RUN]
[0m20:07:32.298900 [info ] [Thread-1 (]: 34 of 35 START test test_edges_created ......................................... [RUN]
[0m20:07:32.299211 [info ] [Thread-3 (]: 35 of 35 START test test_golden_profiles ....................................... [RUN]
[0m20:07:32.299496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_idr.unique_int_labels_entity_key.bd2adc0180, now test.dbt_idr_integration_tests.test_confidence_scores)
[0m20:07:32.299744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idr_integration_tests.test_clusters_created, now test.dbt_idr_integration_tests.test_edges_created)
[0m20:07:32.299985 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_idr.unique_identity_membership_entity_key.e26b27622f, now test.dbt_idr_integration_tests.test_golden_profiles)
[0m20:07:32.300205 [debug] [Thread-2 (]: Began compiling node test.dbt_idr_integration_tests.test_confidence_scores
[0m20:07:32.300414 [debug] [Thread-1 (]: Began compiling node test.dbt_idr_integration_tests.test_edges_created
[0m20:07:32.300609 [debug] [Thread-3 (]: Began compiling node test.dbt_idr_integration_tests.test_golden_profiles
[0m20:07:32.302440 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_idr_integration_tests.test_confidence_scores"
[0m20:07:32.304231 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idr_integration_tests.test_edges_created"
[0m20:07:32.305685 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_idr_integration_tests.test_golden_profiles"
[0m20:07:32.306307 [debug] [Thread-2 (]: Began executing node test.dbt_idr_integration_tests.test_confidence_scores
[0m20:07:32.308040 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_idr_integration_tests.test_confidence_scores"
[0m20:07:32.308279 [debug] [Thread-1 (]: Began executing node test.dbt_idr_integration_tests.test_edges_created
[0m20:07:32.308544 [debug] [Thread-3 (]: Began executing node test.dbt_idr_integration_tests.test_golden_profiles
[0m20:07:32.310006 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idr_integration_tests.test_edges_created"
[0m20:07:32.311475 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_idr_integration_tests.test_golden_profiles"
[0m20:07:32.311825 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr_integration_tests.test_confidence_scores"
[0m20:07:32.312103 [debug] [Thread-2 (]: On test.dbt_idr_integration_tests.test_confidence_scores: BEGIN
[0m20:07:32.312338 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:07:32.312695 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr_integration_tests.test_golden_profiles"
[0m20:07:32.312926 [debug] [Thread-3 (]: On test.dbt_idr_integration_tests.test_golden_profiles: BEGIN
[0m20:07:32.313136 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.313347 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr_integration_tests.test_edges_created"
[0m20:07:32.313536 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:07:32.313735 [debug] [Thread-2 (]: Using duckdb connection "test.dbt_idr_integration_tests.test_confidence_scores"
[0m20:07:32.313936 [debug] [Thread-1 (]: On test.dbt_idr_integration_tests.test_edges_created: BEGIN
[0m20:07:32.314220 [debug] [Thread-2 (]: On test.dbt_idr_integration_tests.test_confidence_scores: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr_integration_tests.test_confidence_scores"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test: Verify confidence scores are calculated
-- All clusters should have confidence_score between 0 and 1

select 'FAIL: Invalid confidence score' as error
from "test_idr"."main_idr_out"."identity_clusters"
where confidence_score is null
   or confidence_score < 0
   or confidence_score > 1
  
  
      
    ) dbt_internal_test
[0m20:07:32.314435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:32.314632 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.314974 [debug] [Thread-3 (]: Using duckdb connection "test.dbt_idr_integration_tests.test_golden_profiles"
[0m20:07:32.315206 [debug] [Thread-3 (]: On test.dbt_idr_integration_tests.test_golden_profiles: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr_integration_tests.test_golden_profiles"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test: Verify golden profiles have email values
-- At least some profiles should have email_primary populated

with profiles_with_email as (
    select count(*) as cnt from "test_idr"."main_idr_out"."golden_profiles"
    where email_primary is not null
)
select 'FAIL: No golden profiles have email' as error
from profiles_with_email
where cnt = 0
  
  
      
    ) dbt_internal_test
[0m20:07:32.315431 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.315637 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.315889 [debug] [Thread-1 (]: Using duckdb connection "test.dbt_idr_integration_tests.test_edges_created"
[0m20:07:32.316158 [debug] [Thread-1 (]: On test.dbt_idr_integration_tests.test_edges_created: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "test.dbt_idr_integration_tests.test_edges_created"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Test: Verify edges were created
-- Should have edges from shared emails/phones

with edge_count as (
    select count(*) as cnt from "test_idr"."main_idr_out"."identity_edges"
)
select 'FAIL: No edges created' as error
from edge_count
where cnt = 0
  
  
      
    ) dbt_internal_test
[0m20:07:32.316428 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:07:32.317311 [debug] [Thread-2 (]: On test.dbt_idr_integration_tests.test_confidence_scores: ROLLBACK
[0m20:07:32.318100 [debug] [Thread-3 (]: On test.dbt_idr_integration_tests.test_golden_profiles: ROLLBACK
[0m20:07:32.318328 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:32.318735 [debug] [Thread-3 (]: Failed to rollback 'test.dbt_idr_integration_tests.test_golden_profiles'
[0m20:07:32.319031 [debug] [Thread-2 (]: Failed to rollback 'test.dbt_idr_integration_tests.test_confidence_scores'
[0m20:07:32.319776 [debug] [Thread-1 (]: On test.dbt_idr_integration_tests.test_edges_created: ROLLBACK
[0m20:07:32.319970 [debug] [Thread-3 (]: On test.dbt_idr_integration_tests.test_golden_profiles: Close
[0m20:07:32.320178 [debug] [Thread-2 (]: On test.dbt_idr_integration_tests.test_confidence_scores: Close
[0m20:07:32.320499 [debug] [Thread-1 (]: Failed to rollback 'test.dbt_idr_integration_tests.test_edges_created'
[0m20:07:32.320809 [info ] [Thread-3 (]: 35 of 35 PASS test_golden_profiles ............................................. [[32mPASS[0m in 0.02s]
[0m20:07:32.321062 [debug] [Thread-1 (]: On test.dbt_idr_integration_tests.test_edges_created: Close
[0m20:07:32.321344 [info ] [Thread-2 (]: 33 of 35 PASS test_confidence_scores ........................................... [[32mPASS[0m in 0.02s]
[0m20:07:32.321667 [debug] [Thread-3 (]: Finished running node test.dbt_idr_integration_tests.test_golden_profiles
[0m20:07:32.321986 [info ] [Thread-1 (]: 34 of 35 PASS test_edges_created ............................................... [[32mPASS[0m in 0.02s]
[0m20:07:32.322296 [debug] [Thread-2 (]: Finished running node test.dbt_idr_integration_tests.test_confidence_scores
[0m20:07:32.322599 [debug] [Thread-1 (]: Finished running node test.dbt_idr_integration_tests.test_edges_created
[0m20:07:32.324016 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:32.324197 [debug] [MainThread]: On master: BEGIN
[0m20:07:32.324368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:32.324701 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:32.324875 [debug] [MainThread]: On master: COMMIT
[0m20:07:32.325049 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:32.325219 [debug] [MainThread]: On master: COMMIT
[0m20:07:32.325557 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:32.325789 [debug] [MainThread]: On master: Close
[0m20:07:32.326018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:32.326175 [debug] [MainThread]: Connection 'test.dbt_idr_integration_tests.test_edges_created' was properly closed.
[0m20:07:32.326323 [debug] [MainThread]: Connection 'test.dbt_idr_integration_tests.test_confidence_scores' was properly closed.
[0m20:07:32.326474 [debug] [MainThread]: Connection 'test.dbt_idr_integration_tests.test_golden_profiles' was properly closed.
[0m20:07:32.326617 [debug] [MainThread]: Connection 'test.dbt_idr_integration_tests.test_alice_cluster' was properly closed.
[0m20:07:32.326813 [info ] [MainThread]: 
[0m20:07:32.327003 [info ] [MainThread]: Finished running 35 data tests in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m20:07:32.329473 [debug] [MainThread]: Command end result
[0m20:07:32.356477 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m20:07:32.357753 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m20:07:32.362395 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/run_results.json
[0m20:07:32.362617 [info ] [MainThread]: 
[0m20:07:32.362833 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:07:32.363029 [info ] [MainThread]: 
[0m20:07:32.363228 [info ] [MainThread]: Done. PASS=35 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=35
[0m20:07:32.364757 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0659657, "process_in_blocks": "0", "process_kernel_time": 0.193726, "process_mem_max_rss": "158941184", "process_out_blocks": "0", "process_user_time": 1.698407}
[0m20:07:32.365078 [debug] [MainThread]: Command `dbt test` succeeded at 20:07:32.365030 after 1.07 seconds
[0m20:07:32.365304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c84950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11076bc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11076bb70>]}
[0m20:07:32.365538 [debug] [MainThread]: Flushing usage events
[0m20:07:32.696229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:07:33.865605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b10590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fa7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fa7890>]}


============================== 20:07:33.868598 | 5abd49b6-0f01-4bb1-a4ca-c0cdbb024e07 ==============================
[0m20:07:33.868598 [info ] [MainThread]: Running with dbt=1.11.2
[0m20:07:33.868950 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --profiles-dir . --select stage_metrics --quiet', 'log_format': 'default', 'version_check': 'True', 'quiet': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'warn_error': 'None', 'empty': 'False', 'use_colors': 'True', 'printer_width': '80', 'log_path': '/Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/logs', 'profiles_dir': '.', 'write_json': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager'}
[0m20:07:33.993389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5abd49b6-0f01-4bb1-a4ca-c0cdbb024e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc1810>]}
[0m20:07:34.029374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5abd49b6-0f01-4bb1-a4ca-c0cdbb024e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120e47790>]}
[0m20:07:34.030636 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m20:07:34.096613 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m20:07:34.189453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:07:34.189771 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:07:34.189946 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:07:34.228977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5abd49b6-0f01-4bb1-a4ca-c0cdbb024e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226dc250>]}
[0m20:07:34.344060 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m20:07:34.345539 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m20:07:34.355806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5abd49b6-0f01-4bb1-a4ca-c0cdbb024e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1220aae40>]}
[0m20:07:34.356160 [info ] [MainThread]: Found 35 data tests, 15 seeds, 11 models, 6 sources, 591 macros
[0m20:07:34.356368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5abd49b6-0f01-4bb1-a4ca-c0cdbb024e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d27150>]}
[0m20:07:34.357810 [info ] [MainThread]: 
[0m20:07:34.358007 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:07:34.358168 [info ] [MainThread]: 
[0m20:07:34.358436 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:07:34.358926 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr'
[0m20:07:34.386778 [debug] [ThreadPool]: Using duckdb connection "list_test_idr"
[0m20:07:34.387056 [debug] [ThreadPool]: On list_test_idr: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"test_idr"'
    
  
  
[0m20:07:34.387238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:34.396537 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:07:34.397463 [debug] [ThreadPool]: On list_test_idr: Close
[0m20:07:34.397861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr, now create_test_idr_main_idr_out)
[0m20:07:34.398133 [debug] [ThreadPool]: Creating schema "database: "test_idr"
schema: "main_idr_out"
"
[0m20:07:34.402121 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m20:07:34.402341 [debug] [ThreadPool]: On create_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_out"} */

    
        select type from duckdb_databases()
        where lower(database_name)='test_idr'
        and type='sqlite'
    
  
[0m20:07:34.402518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:34.402974 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:34.403759 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m20:07:34.403927 [debug] [ThreadPool]: On create_test_idr_main_idr_out: BEGIN
[0m20:07:34.404175 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:34.404386 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m20:07:34.404582 [debug] [ThreadPool]: On create_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "create_test_idr_main_idr_out"} */

    
    
        create schema if not exists "test_idr"."main_idr_out"
    
[0m20:07:34.404923 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:34.405424 [debug] [ThreadPool]: On create_test_idr_main_idr_out: COMMIT
[0m20:07:34.405602 [debug] [ThreadPool]: Using duckdb connection "create_test_idr_main_idr_out"
[0m20:07:34.405761 [debug] [ThreadPool]: On create_test_idr_main_idr_out: COMMIT
[0m20:07:34.406012 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:34.406178 [debug] [ThreadPool]: On create_test_idr_main_idr_out: Close
[0m20:07:34.409842 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_test_idr_main_idr_out, now list_test_idr_main_idr_staging)
[0m20:07:34.413361 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m20:07:34.413570 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: BEGIN
[0m20:07:34.413878 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_work'
[0m20:07:34.414078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:34.414345 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main'
[0m20:07:34.415359 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m20:07:34.415618 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_test_idr_main_idr_meta'
[0m20:07:34.416917 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m20:07:34.417135 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:07:34.417304 [debug] [ThreadPool]: On list_test_idr_main_idr_work: BEGIN
[0m20:07:34.418394 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m20:07:34.418588 [debug] [ThreadPool]: On list_test_idr_main: BEGIN
[0m20:07:34.418774 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_staging"
[0m20:07:34.418934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:34.419112 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: BEGIN
[0m20:07:34.419269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:34.419448 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_staging"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_staging'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:34.419725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:07:34.420015 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:34.420314 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:34.420571 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_work"
[0m20:07:34.420784 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main"
[0m20:07:34.420949 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m20:07:34.421139 [debug] [ThreadPool]: On list_test_idr_main_idr_work: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_work"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_work'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:34.421385 [debug] [ThreadPool]: On list_test_idr_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:34.421605 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_meta"
[0m20:07:34.422030 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_meta"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_meta'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:34.428023 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m20:07:34.428324 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m20:07:34.429203 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: ROLLBACK
[0m20:07:34.429469 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:07:34.429674 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:07:34.430511 [debug] [ThreadPool]: On list_test_idr_main: ROLLBACK
[0m20:07:34.431290 [debug] [ThreadPool]: On list_test_idr_main_idr_work: ROLLBACK
[0m20:07:34.432019 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: ROLLBACK
[0m20:07:34.432558 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_meta'
[0m20:07:34.432863 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_work'
[0m20:07:34.433172 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_staging'
[0m20:07:34.433494 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main'
[0m20:07:34.433663 [debug] [ThreadPool]: On list_test_idr_main_idr_meta: Close
[0m20:07:34.433835 [debug] [ThreadPool]: On list_test_idr_main_idr_work: Close
[0m20:07:34.433995 [debug] [ThreadPool]: On list_test_idr_main_idr_staging: Close
[0m20:07:34.434151 [debug] [ThreadPool]: On list_test_idr_main: Close
[0m20:07:34.434459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_meta, now list_test_idr_main_idr_out)
[0m20:07:34.437269 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m20:07:34.437457 [debug] [ThreadPool]: On list_test_idr_main_idr_out: BEGIN
[0m20:07:34.437620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:07:34.437930 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:07:34.438090 [debug] [ThreadPool]: Using duckdb connection "list_test_idr_main_idr_out"
[0m20:07:34.438263 [debug] [ThreadPool]: On list_test_idr_main_idr_out: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "connection_name": "list_test_idr_main_idr_out"} */
select
      'test_idr' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main_idr_out'
    and lower(table_catalog) = 'test_idr'
  
[0m20:07:34.440305 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:07:34.441068 [debug] [ThreadPool]: On list_test_idr_main_idr_out: ROLLBACK
[0m20:07:34.441373 [debug] [ThreadPool]: Failed to rollback 'list_test_idr_main_idr_out'
[0m20:07:34.441536 [debug] [ThreadPool]: On list_test_idr_main_idr_out: Close
[0m20:07:34.442410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5abd49b6-0f01-4bb1-a4ca-c0cdbb024e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122c2a340>]}
[0m20:07:34.442685 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:34.442854 [debug] [MainThread]: On master: BEGIN
[0m20:07:34.443014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:07:34.443302 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:34.443473 [debug] [MainThread]: On master: COMMIT
[0m20:07:34.443631 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:34.443792 [debug] [MainThread]: On master: COMMIT
[0m20:07:34.444031 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:34.444198 [debug] [MainThread]: On master: Close
[0m20:07:34.445415 [debug] [Thread-1 (]: Began running node model.dbt_idr.stage_metrics
[0m20:07:34.445724 [info ] [Thread-1 (]: 1 of 1 START sql table model main_idr_out.stage_metrics ........................ [RUN]
[0m20:07:34.445940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_test_idr_main_idr_staging, now model.dbt_idr.stage_metrics)
[0m20:07:34.446143 [debug] [Thread-1 (]: Began compiling node model.dbt_idr.stage_metrics
[0m20:07:34.451513 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idr.stage_metrics"
[0m20:07:34.452003 [debug] [Thread-1 (]: Began executing node model.dbt_idr.stage_metrics
[0m20:07:34.471545 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idr.stage_metrics"
[0m20:07:34.472105 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m20:07:34.472323 [debug] [Thread-1 (]: On model.dbt_idr.stage_metrics: BEGIN
[0m20:07:34.472521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:07:34.472937 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:34.473131 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m20:07:34.473359 [debug] [Thread-1 (]: On model.dbt_idr.stage_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stage_metrics"} */

  
    
    

    create  table
      "test_idr"."main_idr_out"."stage_metrics__dbt_tmp"
  
    as (
      



with stages as (
    select 1 as stage_order, 'stg_identifiers' as stage_name, 
           (select count(*) from "test_idr"."main_idr_staging"."stg_identifiers") as rows_out
    union all
    select 2, 'int_edges', 
           (select count(*) from "test_idr"."main_idr_work"."int_edges")
    union all
    select 3, 'int_labels', 
           (select count(*) from "test_idr"."main_idr_work"."int_labels")
    union all
    select 4, 'identity_membership', 
           (select count(*) from "test_idr"."main_idr_out"."identity_membership")
    union all
    select 5, 'identity_clusters', 
           (select count(*) from "test_idr"."main_idr_out"."identity_clusters")
    union all
    select 6, 'golden_profiles', 
           (select count(*) from "test_idr"."main_idr_out"."golden_profiles")
    union all
    select 7, 'skipped_identifier_groups', 
           (select count(*) from "test_idr"."main_idr_out"."skipped_identifier_groups")
)

select
    '5abd49b6-0f01-4bb1-a4ca-c0cdbb024e07' as run_id,
    stage_name,
    stage_order,
    rows_out,
    current_timestamp as recorded_at
from stages
order by stage_order
    );
  
  
[0m20:07:34.475404 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:07:34.478927 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m20:07:34.479167 [debug] [Thread-1 (]: On model.dbt_idr.stage_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stage_metrics"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main_idr_out'
      AND table_name = 'stage_metrics'
  
[0m20:07:34.479672 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:34.480476 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m20:07:34.480700 [debug] [Thread-1 (]: On model.dbt_idr.stage_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stage_metrics"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main_idr_out'
      AND table_name = 'stage_metrics'
  
[0m20:07:34.481242 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:34.486663 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m20:07:34.486906 [debug] [Thread-1 (]: On model.dbt_idr.stage_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stage_metrics"} */
alter table "test_idr"."main_idr_out"."stage_metrics" rename to "stage_metrics__dbt_backup"
[0m20:07:34.487312 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:34.488800 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m20:07:34.489004 [debug] [Thread-1 (]: On model.dbt_idr.stage_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stage_metrics"} */
alter table "test_idr"."main_idr_out"."stage_metrics__dbt_tmp" rename to "stage_metrics"
[0m20:07:34.489322 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:34.498849 [debug] [Thread-1 (]: On model.dbt_idr.stage_metrics: COMMIT
[0m20:07:34.499086 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m20:07:34.499293 [debug] [Thread-1 (]: On model.dbt_idr.stage_metrics: COMMIT
[0m20:07:34.500094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:07:34.503575 [debug] [Thread-1 (]: Using duckdb connection "model.dbt_idr.stage_metrics"
[0m20:07:34.503847 [debug] [Thread-1 (]: On model.dbt_idr.stage_metrics: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "integration_tests", "target_name": "dev", "node_id": "model.dbt_idr.stage_metrics"} */

      drop table if exists "test_idr"."main_idr_out"."stage_metrics__dbt_backup" cascade
    
[0m20:07:34.504411 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:07:34.505826 [debug] [Thread-1 (]: On model.dbt_idr.stage_metrics: Close
[0m20:07:34.506794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5abd49b6-0f01-4bb1-a4ca-c0cdbb024e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122a0fdd0>]}
[0m20:07:34.507181 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main_idr_out.stage_metrics ................... [[32mOK[0m in 0.06s]
[0m20:07:34.507494 [debug] [Thread-1 (]: Finished running node model.dbt_idr.stage_metrics
[0m20:07:34.508208 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:34.508404 [debug] [MainThread]: On master: BEGIN
[0m20:07:34.508571 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:07:34.508900 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:34.509086 [debug] [MainThread]: On master: COMMIT
[0m20:07:34.509258 [debug] [MainThread]: Using duckdb connection "master"
[0m20:07:34.509414 [debug] [MainThread]: On master: COMMIT
[0m20:07:34.509686 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:07:34.509869 [debug] [MainThread]: On master: Close
[0m20:07:34.510086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:07:34.510246 [debug] [MainThread]: Connection 'model.dbt_idr.stage_metrics' was properly closed.
[0m20:07:34.510393 [debug] [MainThread]: Connection 'list_test_idr_main_idr_work' was properly closed.
[0m20:07:34.510536 [debug] [MainThread]: Connection 'list_test_idr_main' was properly closed.
[0m20:07:34.510680 [debug] [MainThread]: Connection 'list_test_idr_main_idr_out' was properly closed.
[0m20:07:34.510851 [info ] [MainThread]: 
[0m20:07:34.511015 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m20:07:34.511364 [debug] [MainThread]: Command end result
[0m20:07:34.534400 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/manifest.json
[0m20:07:34.535433 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/semantic_manifest.json
[0m20:07:34.538669 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/harihiom/Anil/Development/sql-identity-resolution/dbt_idr/integration_tests/target/run_results.json
[0m20:07:34.538871 [info ] [MainThread]: 
[0m20:07:34.539071 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:07:34.539240 [info ] [MainThread]: 
[0m20:07:34.539420 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:07:34.540780 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7184482, "process_in_blocks": "0", "process_kernel_time": 0.180462, "process_mem_max_rss": "155697152", "process_out_blocks": "0", "process_user_time": 1.391806}
[0m20:07:34.541047 [debug] [MainThread]: Command `dbt run` succeeded at 20:07:34.541004 after 0.72 seconds
[0m20:07:34.541260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122a07e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f00870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f00690>]}
[0m20:07:34.541465 [debug] [MainThread]: Flushing usage events
[0m20:07:34.866652 [debug] [MainThread]: An error was encountered while trying to flush usage events
